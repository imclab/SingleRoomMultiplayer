'use strict';function Ia(){return function(){}}function cc(dc){return function(){return this[dc]}}
(function(){function dc(a){if(this.options={Vf:null,images:null,ka:null,iq:null,Wr:null,parent:document.body,dy:null,xF:null,ey:null,wF:null,zF:null,vF:null,ak:null},a)for(var e in a)this.options[e]=a[e];this.lv=new b.Ns;this.loaded={Vf:{},images:{},ka:{},iq:{},Wr:{}};this.hd=document.createElement("div");this.ju();this.options.parent.appendChild(this.hd);for(e in this)"function"==typeof this[e]&&(this[e]=this[e].bind(this))}function Mb(){this.elements={};this.gu()}function Nb(a){this.options=a;"function"==
typeof this.Xe&&this.Xe()}function ec(a){a=a||{};this.cg=a.cg||100;this.type=a.type||"cube";this.position=a.position||new b.a;this.Fn=a.Fn||new b.a;this.Q="number"==typeof a.Q?a.Q:10;this.acceleration=a.acceleration||new b.a;this.dm=a.dm||new b.a;this.Rb=a.Rb||new b.a;this.Bs=a.Bs||new b.a;this.speed="number"==typeof a.speed?a.speed:0;this.al="number"==typeof a.al?a.al:0;this.size=a.size||10;this.aj=a.aj||0;this.vh=a.vh||10;this.Vg=a.Vg||null;this.Cc="number"==typeof a.Cc?a.Cc:1;this.c=this.attributes=
this.$f=null;this.sb=this.Cs=0;this.mb=null;this.Hy=[];this.xa={}}function Hb(a){this.gq=a.gq||0.016;this.mb=a.mb||3;this.Uh=a.Uh||new b.k("white");this.Th=a.Th||new b.k("blue");this.lh="undefined"!=typeof a.lh?a.lh:1;this.kh=a.kh||0;this.La=("string"==typeof a.La?bb.loaded.ka[a.La]:a.La)||null;this.Vm=a.Vm||1;this.tm=a.tm||1;this.Ha=a.Ha||b.yb;this.U=a.U||!0;this.Dc=a.Dc||0.5;this.Gc=a.Gc||!1;this.Db=a.Db||!1;this.N={TB:{type:"c",value:this.Uh},UB:{type:"c",value:this.Th},duration:{type:"f",value:parseFloat(this.mb)},
La:{type:"t",value:this.La},Vm:{type:"i",value:parseInt(this.Vm)},tm:{type:"i",value:parseInt(this.tm)},opacity:{type:"f",value:parseFloat(this.lh)},kh:{type:"f",value:parseFloat(this.kh)}};this.attributes={acceleration:{type:"v3",value:[]},Rb:{type:"v3",value:[]},Cc:{type:"f",value:[]},sb:{type:"f",value:[]},size:{type:"f",value:[]},vh:{type:"f",value:[]}};this.Gm=[];this.Ba=this.n=this.l=null;this.du();this.eu();this.fu()}function kc(a){var e=bb.loaded.ka;this.ac={Pd:{size:71492*a.scale,ha:0,gf:0},
cc:{size:3642*a.scale,ha:126540*a.scale,gf:0.3*2.231*a.scale},bc:{size:3121*a.scale,ha:201330*a.scale,gf:0.3*(4-3.551)*a.scale},SC:{size:5262*a.scale,ha:321120*a.scale,gf:2.1465*a.scale},BB:{size:4820*a.scale,ha:564810*a.scale,gf:0.3*16.69*a.scale}};this.Uw=new b.qb({color:16777215,Jc:10,Lc:16308919,map:e[a.py]});this.Fq=new b.qb({U:!0,map:e[a.Ou],color:16777215,Ha:b.yb,opacity:0.8});this.Mw=new b.qb({color:16777215,Jc:10,map:e[a.nz]});this.Nv=new b.qb({color:16777215,Jc:10,map:e[a.Ww]});this.Tw=
new b.Qc(this.ac.Pd.size,32,32);this.Rw=new b.Qc(this.ac.Pd.size+2,32,32);this.Sw=new b.Qc(this.ac.Pd.size+4,32,32);this.Lw=new b.Qc(this.ac.cc.size,32,32);this.Mv=new b.Qc(this.ac.bc.size,32,32);this.Pd=new b.J(this.Tw,this.Uw);this.tk=new b.J(this.Rw,this.Fq);this.wi=new b.J(this.Sw,this.Fq);this.cc=new b.J(this.Lw,this.Mw);this.bc=new b.J(this.Mv,this.Nv);this.Pd.position=a.position;this.tk.position=this.wi.position=this.Pd.position;this.wi.rotation.y=Math.PI/2;this.cc.position=a.position.d();
this.cc.position.z+=this.ac.cc.ha;this.bc.position=a.position.d();this.bc.position.z+=this.ac.bc.ha;this.ob=[];this.ob.push(this.Pd);this.ob.push(this.tk);this.ob.push(this.wi);this.ob.push(this.cc);this.ob.push(this.bc)}function lc(a){this.ob=[];this.n=new b.Za({map:bb.loaded.ka[a.Fz],U:!0});this.n.Ha=b.yb;this.l=new b.Cl(200,200,1,1);this.Ba=new b.J(this.l,this.n);this.Ba.position=a.position;this.Ba.rotation.y=Math.PI/2;this.Du(a);this.ob.push(this.Ba)}function Nc(a,b){var c=[];this.get=function(){return c.length?
c.pop():void 0};this.Iy=function(a){this.reset(a);c.unshift(a)};this.reset=Ia();this.Pf=function(){return c.length};this.ow=function(){return c};for(var d,f=0;100>f;++f)d=new a(b),c.push(d)}function kb(a){this.En=[];this.Fm=[];this.Le=[];this.vk={};this.Ek=bb.loaded.Vf[a.Ek].wm.d();this.Ba=new b.w;this.An=a.An;this.mu();this.hs=new b.K;this.js=new b.Bb;this.Kw=new b.Bb(1,0,0,0);this.acceleration=a.acceleration;this.Rb=a.Rb;this.nn=a.nn;this.Om=a.Om;this.af=a.af;this.mb=a.mb;this.uk=a.uk;this.ob=[];
this.ob.push(this.Ba);this.ib=this.ib.bind(this)}function mc(a){this.n=new b.Za({map:bb.loaded.ka[a.La],Kc:b.rf});this.l=new b.Qc(a.Q,a.Uy,a.Ty);this.Ba=new b.J(this.l,this.n);this.ob=[];this.ob.push(this.Ba)}function uc(a){function e(){var a=Math.random()*c.width-c.width/2;return 0<a&&a<c.Bi?a+=c.Bi:0>a&&a>-c.Bi&&(a-=c.Bi),a}var c={width:1E5,height:1E5,depth:1E5,$n:1E6,color:16777215,size:1,Bi:0,La:null};if(a)for(var d in a)c[d]=a[d];a=new b.Ce({size:c.size,map:bb.loaded.ka[c.La],Ha:b.yb,Db:!0,U:!0});
var f=new b.H;(function(){for(var a=0;a<c.$n;++a)f.c.push(new b.a(e(),e(),e()))})();this.Ba=new b.Tb(f,a);this.ob=[this.Ba];this.ok=cc("ob")}function Ob(){"function"==typeof this.Xe&&this.Xe()}function Oc(){var a=ha.controls,b=vc,c=wc;c.Eg(a.vo,function(){b.Dr(!0)});c.Eg(a.po,function(){b.Br(!0)});c.Eg(a.Bo,function(){b.Gr(!0)});c.Eg(a.Qo,function(){b.Ir(!0)});c.Eg(a.Ro,function(){b.Jr(!0)});c.Eg(a.So,function(){b.Kr(!0)});c.Fg(a.vo,function(){b.Dr(!1)});c.Fg(a.po,function(){b.Br(!1)});c.Fg(a.Bo,
function(){b.Gr(!1)});c.Fg(a.Qo,function(){b.Ir(!1)});c.Fg(a.Ro,function(){b.Jr(!1)});c.Fg(a.So,function(){b.Kr(!1)})}var b=b||{El:"58"};self.console=self.console||{info:Ia(),log:Ia(),debug:Ia(),warn:Ia(),error:Ia()};self.at=self.at||Array;self.Ys=self.Ys||Array;b.extend=function(a,b){if(Object.keys)for(var c=Object.keys(b),d=0,f=c.length;f>d;d++){var g=c[d];Object.defineProperty(a,g,Object.getOwnPropertyDescriptor(b,g))}else for(g in c={}.hasOwnProperty,b)c.call(b,g)&&(a[g]=b[g]);return a};(function(){for(var a=
0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];void 0===window.requestAnimationFrame&&(window.requestAnimationFrame=function(b){var e=Date.now(),c=Math.max(0,16-(e-a)),h=window.setTimeout(function(){b(e+c)},c);return a=e+c,h});window.cancelAnimationFrame=window.cancelAnimationFrame||function(a){window.clearTimeout(a)}})();
b.Ts=0;b.Ss=1;b.lj=2;b.sA=3;b.Zs=0;b.xA=1;b.iA=0;b.Jo=1;b.Ko=2;b.vg=0;b.rf=1;b.dd=2;b.BA=0;b.wf=1;b.wc=2;b.Fh=0;b.vf=1;b.Fe=2;b.Bl=0;b.Gh=1;b.yb=2;b.$o=3;b.jt=4;b.so=5;b.oo=100;b.Ct=101;b.ut=102;b.Nt=200;b.mt=201;b.Bt=202;b.pt=203;b.Zo=204;b.Io=205;b.Ws=206;b.nt=207;b.Xs=208;b.ot=209;b.At=210;b.rj=0;b.it=1;b.hA=2;b.cp=Ia();b.qA=Ia();b.Rs=Ia();b.yt=Ia();b.GA=Ia();b.ed=1E3;b.sf=1001;b.Al=1002;b.Be=1003;b.Ho=1004;b.Go=1005;b.ae=1006;b.et=1007;b.yl=1008;b.Ll=1009;b.Ks=1010;b.xt=1011;b.Lt=1012;b.bt=1013;
b.Ht=1014;b.sl=1015;b.It=1016;b.Jt=1017;b.Kt=1018;b.Gs=1019;b.Fl=1020;b.Bf=1021;b.gt=1022;b.ft=1023;b.Po=2001;b.st=2002;b.No=2003;b.Oo=2004;b.k=function(a){return void 0!==a&&this.set(a),this};b.k.prototype={constructor:b.k,q:1,o:1,h:1,set:function(a){return a instanceof b.k?this.copy(a):"number"==typeof a?this.sd(a):"string"==typeof a&&this.dz(a),this},sd:function(a){return a=Math.floor(a),this.q=(255&a>>16)/255,this.o=(255&a>>8)/255,this.h=(255&a)/255,this},Wa:function(a,b,c){return this.q=a,this.o=
b,this.h=c,this},dz:function(a){return/^rgb\((\d+),(\d+),(\d+)\)$/i.test(a)?(a=/^rgb\((\d+),(\d+),(\d+)\)$/i.exec(a),this.q=Math.min(255,parseInt(a[1],10))/255,this.o=Math.min(255,parseInt(a[2],10))/255,this.h=Math.min(255,parseInt(a[3],10))/255,this):/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.test(a)?(a=/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.exec(a),this.q=Math.min(100,parseInt(a[1],10))/100,this.o=Math.min(100,parseInt(a[2],10))/100,this.h=Math.min(100,parseInt(a[3],10))/100,this):/^\#([0-9a-f]{6})$/i.test(a)?
(a=/^\#([0-9a-f]{6})$/i.exec(a),this.sd(parseInt(a[1],16)),this):/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(a)?(a=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(a),this.sd(parseInt(a[1]+a[1]+a[2]+a[2]+a[3]+a[3],16)),this):/^(\w+)$/i.test(a)?(this.sd(b.Os[a]),this):void 0},copy:function(a){return this.q=a.q,this.o=a.o,this.h=a.h,this},Qg:function(a){return this.q=a.q*a.q,this.o=a.o*a.o,this.h=a.h*a.h,this},nk:function(){return 255*this.q<<16^255*this.o<<8^255*this.h<<0},pe:function(){return"rgb("+(0|255*
this.q)+","+(0|255*this.o)+","+(0|255*this.h)+")"},add:function(a){return this.q+=a.q,this.o+=a.o,this.h+=a.h,this},em:function(a,b){return this.q=a.q+b.q,this.o=a.o+b.o,this.h=a.h+b.h,this},Jb:function(a){return this.q+=a,this.o+=a,this.h+=a,this},multiply:function(a){return this.q*=a.q,this.o*=a.o,this.h*=a.h,this},p:function(a){return this.q*=a,this.o*=a,this.h*=a,this},$e:function(a,b){return this.q+=(a.q-this.q)*b,this.o+=(a.o-this.o)*b,this.h+=(a.h-this.h)*b,this},va:function(a){return a.q===
this.q&&a.o===this.o&&a.h===this.h},d:function(){return(new b.k).Wa(this.q,this.o,this.h)}};b.Os={ZA:15792383,$A:16444375,dB:65535,eB:8388564,iB:15794175,lB:16119260,nB:16770244,oB:0,pB:16772045,blue:255,rB:9055202,wB:10824234,xB:14596231,yB:6266528,EB:8388352,FB:13789470,LB:16744272,MB:6591981,NB:16775388,QB:14423100,VB:65535,WB:139,XB:35723,YB:12092939,ZB:11119017,$B:25600,aC:11119017,bC:12433259,cC:9109643,dC:5597999,eC:16747520,fC:10040012,gC:9109504,hC:15308410,iC:9419919,jC:4734347,kC:3100495,
lC:3100495,mC:52945,nC:9699539,qC:16716947,rC:49151,tC:6908265,uC:6908265,xC:2003199,JC:11674146,LC:16775920,PC:2263842,QC:16711935,RC:14474460,$C:16316671,aD:16766720,bD:14329120,cD:8421504,green:32768,dD:11403055,eD:8421504,iD:15794160,jD:16738740,lD:13458524,mD:4915330,DD:16777200,ED:15787660,HD:15132410,ID:16773365,JD:8190976,KD:16775885,LD:11393254,MD:15761536,ND:14745599,OD:16448210,PD:13882323,QD:9498256,RD:13882323,SD:16758465,TD:16752762,UD:2142890,VD:8900346,WD:7833753,XD:7833753,YD:11584734,
ZD:16777184,$D:65280,aE:3329330,cE:16445670,dE:16711935,zE:8388608,EE:6737322,FE:205,GE:12211667,HE:9662683,IE:3978097,JE:8087790,KE:64154,LE:4772300,ME:13047173,PE:1644912,TE:16121850,UE:16770273,VE:16770229,mF:16768685,nF:128,rF:16643558,sF:8421376,tF:7048739,AF:16753920,BF:16729344,CF:14315734,EF:15657130,FF:10025880,GF:11529966,HF:14381203,IF:16773077,LF:16767673,MF:13468991,SF:16761035,TF:14524637,VF:11591910,ZF:8388736,red:16711680,oG:12357519,qG:4286945,rG:9127187,sG:16416882,tG:16032864,vG:3050327,
wG:16774638,LG:10506797,NG:12632256,QG:8900331,RG:6970061,SG:7372944,TG:7372944,VG:16775930,XG:65407,ZG:4620980,tan:13808780,lH:32896,pH:14204888,sH:16737095,zH:4251856,LH:15631086,NH:16113331,OH:16777215,PH:16119285,TH:16776960,UH:10145074};b.Bb=function(a,b,c,d){this.x=a||0;this.y=b||0;this.z=c||0;this.f=void 0!==d?d:1};b.Bb.prototype={constructor:b.Bb,set:function(a,b,c,d){return this.x=a,this.y=b,this.z=c,this.f=d,this},copy:function(a){return this.x=a.x,this.y=a.y,this.z=a.z,this.f=a.f,this},
Fr:function(a,b){var c=Math.cos(a.x/2),d=Math.cos(a.y/2),f=Math.cos(a.z/2),g=Math.sin(a.x/2),h=Math.sin(a.y/2),k=Math.sin(a.z/2);return void 0===b||"XYZ"===b?(this.x=g*d*f+c*h*k,this.y=c*h*f-g*d*k,this.z=c*d*k+g*h*f,this.f=c*d*f-g*h*k):"YXZ"===b?(this.x=g*d*f+c*h*k,this.y=c*h*f-g*d*k,this.z=c*d*k-g*h*f,this.f=c*d*f+g*h*k):"ZXY"===b?(this.x=g*d*f-c*h*k,this.y=c*h*f+g*d*k,this.z=c*d*k+g*h*f,this.f=c*d*f-g*h*k):"ZYX"===b?(this.x=g*d*f-c*h*k,this.y=c*h*f+g*d*k,this.z=c*d*k-g*h*f,this.f=c*d*f+g*h*k):"YZX"===
b?(this.x=g*d*f+c*h*k,this.y=c*h*f+g*d*k,this.z=c*d*k-g*h*f,this.f=c*d*f-g*h*k):"XZY"===b&&(this.x=g*d*f-c*h*k,this.y=c*h*f-g*d*k,this.z=c*d*k+g*h*f,this.f=c*d*f+g*h*k),this},Er:function(a,b){var c=b/2,d=Math.sin(c);return this.x=a.x*d,this.y=a.y*d,this.z=a.z*d,this.f=Math.cos(c),this},Ni:function(a){var b,c=a.elements;a=c[0];var d=c[4],f=c[8],g=c[1],h=c[5],k=c[9],l=c[2],m=c[6],c=c[10],q=a+h+c;return 0<q?(b=0.5/Math.sqrt(q+1),this.f=0.25/b,this.x=(m-k)*b,this.y=(f-l)*b,this.z=(g-d)*b):a>h&&a>c?(b=
2*Math.sqrt(1+a-h-c),this.f=(m-k)/b,this.x=0.25*b,this.y=(d+g)/b,this.z=(f+l)/b):h>c?(b=2*Math.sqrt(1+h-a-c),this.f=(f-l)/b,this.x=(d+g)/b,this.y=0.25*b,this.z=(k+m)/b):(b=2*Math.sqrt(1+c-a-h),this.f=(g-d)/b,this.x=(f+l)/b,this.y=(k+m)/b,this.z=0.25*b),this},yi:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.f*this.f},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.f*this.f)},normalize:function(){var a=this.length();return 0===a?(this.x=0,this.y=
0,this.z=0,this.f=1):(a=1/a,this.x*=a,this.y*=a,this.z*=a,this.f*=a),this},multiply:function(a,b){return void 0!==b?(console.warn("DEPRECATED: Quaternion's .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.br(a,b)):this.br(this,a)},br:function(a,b){var c=a.x,d=a.y,f=a.z,g=a.f,h=b.x,k=b.y,l=b.z,m=b.f;return this.x=c*m+g*h+d*l-f*k,this.y=d*m+g*k+f*h-c*l,this.z=f*m+g*l+c*k-d*h,this.f=g*m-c*h-d*k-f*l,this},Zk:function(a,b){var c=this.x,d=this.y,f=this.z,g=this.f,
h=g*a.f+c*a.x+d*a.y+f*a.z;if(0>h?(this.f=-a.f,this.x=-a.x,this.y=-a.y,this.z=-a.z,h=-h):this.copy(a),1<=h)return this.f=g,this.x=c,this.y=d,this.z=f,this;var k=Math.acos(h),l=Math.sqrt(1-h*h);if(0.0010>Math.abs(l))return this.f=0.5*(g+this.f),this.x=0.5*(c+this.x),this.y=0.5*(d+this.y),this.z=0.5*(f+this.z),this;h=Math.sin((1-b)*k)/l;k=Math.sin(b*k)/l;return this.f=g*h+this.f*k,this.x=c*h+this.x*k,this.y=d*h+this.y*k,this.z=f*h+this.z*k,this},va:function(a){return a.x===this.x&&a.y===this.y&&a.z===
this.z&&a.f===this.f},kk:function(a){return this.x=a[0],this.y=a[1],this.z=a[2],this.f=a[3],this},fl:function(){return[this.x,this.y,this.z,this.f]},d:function(){return new b.Bb(this.x,this.y,this.z,this.f)}};b.Bb.Zk=function(a,b,c,d){return c.copy(a).Zk(b,d)};b.i=function(a,b){this.x=a||0;this.y=b||0};b.i.prototype={constructor:b.i,set:function(a,b){return this.x=a,this.y=b,this},Rn:function(a){return this.x=a,this},Pi:function(a){return this.y=a,this},copy:function(a){return this.x=a.x,this.y=a.y,
this},add:function(a,b){return void 0!==b?(console.warn("DEPRECATED: Vector2's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.fd(a,b)):(this.x+=a.x,this.y+=a.y,this)},fd:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this},Jb:function(a){return this.x+=a,this.y+=a,this},sub:function(a,b){return void 0!==b?(console.warn("DEPRECATED: Vector2's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.X(a,b)):(this.x-=a.x,this.y-=a.y,this)},X:function(a,
b){return this.x=a.x-b.x,this.y=a.y-b.y,this},p:function(a){return this.x*=a,this.y*=a,this},oe:function(a){return 0!==a?(this.x/=a,this.y/=a):this.set(0,0),this},min:function(a){return this.x>a.x&&(this.x=a.x),this.y>a.y&&(this.y=a.y),this},max:function(a){return this.x<a.x&&(this.x=a.x),this.y<a.y&&(this.y=a.y),this},Ng:function(a,b){return this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x),this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y),this},ih:function(){return this.p(-1)},za:function(a){return this.x*
a.x+this.y*a.y},yi:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.oe(this.length())},gd:function(a){return Math.sqrt(this.Ug(a))},Ug:function(a){var b=this.x-a.x;a=this.y-a.y;return b*b+a*a},Qk:function(a){var b=this.length();return 0!==b&&a!==b&&this.p(a/b),this},$e:function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this},va:function(a){return a.x===this.x&&a.y===this.y},kk:function(a){return this.x=
a[0],this.y=a[1],this},fl:function(){return[this.x,this.y]},d:function(){return new b.i(this.x,this.y)}};b.a=function(a,b,c){this.x=a||0;this.y=b||0;this.z=c||0};b.a.prototype={constructor:b.a,set:function(a,b,c){return this.x=a,this.y=b,this.z=c,this},Rn:function(a){return this.x=a,this},Pi:function(a){return this.y=a,this},copy:function(a){return this.x=a.x,this.y=a.y,this.z=a.z,this},add:function(a,b){return void 0!==b?(console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),
this.fd(a,b)):(this.x+=a.x,this.y+=a.y,this.z+=a.z,this)},Jb:function(a){return this.x+=a,this.y+=a,this.z+=a,this},fd:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this},sub:function(a,b){return void 0!==b?(console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.X(a,b)):(this.x-=a.x,this.y-=a.y,this.z-=a.z,this)},X:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this},multiply:function(a,b){return void 0!==
b?(console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.Rx(a,b)):(this.x*=a.x,this.y*=a.y,this.z*=a.z,this)},p:function(a){return this.x*=a,this.y*=a,this.z*=a,this},Rx:function(a,b){return this.x=a.x*b.x,this.y=a.y*b.y,this.z=a.z*b.z,this},Fd:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;return this.x=a[0]*b+a[3]*c+a[6]*d,this.y=a[1]*b+a[4]*c+a[7]*d,this.z=a[2]*b+a[5]*c+a[8]*d,this},Z:function(a){var b=this.x,c=this.y,
d=this.z;a=a.elements;return this.x=a[0]*b+a[4]*c+a[8]*d+a[12],this.y=a[1]*b+a[5]*c+a[9]*d+a[13],this.z=a[2]*b+a[6]*c+a[10]*d+a[14],this},Gd:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;var f=1/(a[3]*b+a[7]*c+a[11]*d+a[15]);return this.x=(a[0]*b+a[4]*c+a[8]*d+a[12])*f,this.y=(a[1]*b+a[5]*c+a[9]*d+a[13])*f,this.z=(a[2]*b+a[6]*c+a[10]*d+a[14])*f,this},Qj:function(a){var b=this.x,c=this.y,d=this.z,f=a.x,g=a.y,h=a.z;a=a.f;var k=a*b+g*d-h*c,l=a*c+h*b-f*d,m=a*d+f*c-g*b,b=-f*b-g*c-h*d;return this.x=
k*a+b*-f+l*-h-m*-g,this.y=l*a+b*-g+m*-f-k*-h,this.z=m*a+b*-h+k*-g-l*-f,this},oe:function(a){return 0!==a?(this.x/=a,this.y/=a,this.z/=a):(this.x=0,this.y=0,this.z=0),this},min:function(a){return this.x>a.x&&(this.x=a.x),this.y>a.y&&(this.y=a.y),this.z>a.z&&(this.z=a.z),this},max:function(a){return this.x<a.x&&(this.x=a.x),this.y<a.y&&(this.y=a.y),this.z<a.z&&(this.z=a.z),this},Ng:function(a,b){return this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x),this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y),this.z<
a.z?this.z=a.z:this.z>b.z&&(this.z=b.z),this},ih:function(){return this.p(-1)},za:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},yi:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},Iq:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.oe(this.length())},Qk:function(a){var b=this.length();return 0!==b&&a!==b&&this.p(a/b),this},$e:function(a,b){return this.x+=
(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this.z+=(a.z-this.z)*b,this},Id:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.$b(a,b);var c=this.x,d=this.y,f=this.z;return this.x=d*a.z-f*a.y,this.y=f*a.x-c*a.z,this.z=c*a.y-d*a.x,this},$b:function(a,b){return this.x=a.y*b.z-a.z*b.y,this.y=a.z*b.x-a.x*b.z,this.z=a.x*b.y-a.y*b.x,this},gd:function(a){return Math.sqrt(this.Ug(a))},Ug:function(a){var b=this.x-
a.x,c=this.y-a.y;a=this.z-a.z;return b*b+c*c+a*a},On:function(a,b){function c(a){return Math.min(Math.max(a,-1),1)}var d=a.elements,f=d[0],g=d[4],h=d[8],k=d[1],l=d[5],m=d[9],q=d[2],p=d[6],d=d[10];return void 0===b||"XYZ"===b?(this.y=Math.asin(c(h)),0.99999>Math.abs(h)?(this.x=Math.atan2(-m,d),this.z=Math.atan2(-g,f)):(this.x=Math.atan2(p,l),this.z=0)):"YXZ"===b?(this.x=Math.asin(-c(m)),0.99999>Math.abs(m)?(this.y=Math.atan2(h,d),this.z=Math.atan2(k,l)):(this.y=Math.atan2(-q,f),this.z=0)):"ZXY"===
b?(this.x=Math.asin(c(p)),0.99999>Math.abs(p)?(this.y=Math.atan2(-q,d),this.z=Math.atan2(-g,l)):(this.y=0,this.z=Math.atan2(k,f))):"ZYX"===b?(this.y=Math.asin(-c(q)),0.99999>Math.abs(q)?(this.x=Math.atan2(p,d),this.z=Math.atan2(k,f)):(this.x=0,this.z=Math.atan2(-g,l))):"YZX"===b?(this.z=Math.asin(c(k)),0.99999>Math.abs(k)?(this.x=Math.atan2(-m,l),this.y=Math.atan2(-q,f)):(this.x=0,this.y=Math.atan2(h,d))):"XZY"===b&&(this.z=Math.asin(-c(g)),0.99999>Math.abs(g)?(this.x=Math.atan2(p,l),this.y=Math.atan2(h,
f)):(this.x=Math.atan2(-m,d),this.y=0)),this},lb:function(a){return this.x=a.elements[12],this.y=a.elements[13],this.z=a.elements[14],this},mw:function(a){var b=this.set(a.elements[0],a.elements[1],a.elements[2]).length(),c=this.set(a.elements[4],a.elements[5],a.elements[6]).length();a=this.set(a.elements[8],a.elements[9],a.elements[10]).length();return this.x=b,this.y=c,this.z=a,this},va:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},kk:function(a){return this.x=a[0],this.y=a[1],this.z=
a[2],this},fl:function(){return[this.x,this.y,this.z]},d:function(){return new b.a(this.x,this.y,this.z)}};b.extend(b.a.prototype,{Mu:function(){var a=new b.Bb;return function(b,c){var d=a.Fr(b,c);return this.Qj(d),this}}(),bB:function(){var a=new b.Bb;return function(b,c){var d=a.Er(b,c);return this.Qj(d),this}}(),nr:function(){var a=new b.a;return function(b){a.copy(b).normalize();b=this.za(a);return this.copy(a).p(b)}}(),XF:function(){var a=new b.a;return function(b){return a.copy(this).nr(b),
this.sub(a)}}(),hG:function(){var a=new b.a;return function(b){return a.copy(this).nr(b).p(2),this.X(a,this)}}()});b.Rc=function(a,b,c,d){this.x=a||0;this.y=b||0;this.z=c||0;this.f=void 0!==d?d:1};b.Rc.prototype={constructor:b.Rc,set:function(a,b,c,d){return this.x=a,this.y=b,this.z=c,this.f=d,this},Rn:function(a){return this.x=a,this},Pi:function(a){return this.y=a,this},copy:function(a){return this.x=a.x,this.y=a.y,this.z=a.z,this.f=void 0!==a.f?a.f:1,this},add:function(a,b){return void 0!==b?(console.warn("DEPRECATED: Vector4's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),
this.fd(a,b)):(this.x+=a.x,this.y+=a.y,this.z+=a.z,this.f+=a.f,this)},Jb:function(a){return this.x+=a,this.y+=a,this.z+=a,this.f+=a,this},fd:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this.f=a.f+b.f,this},sub:function(a,b){return void 0!==b?(console.warn("DEPRECATED: Vector4's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.X(a,b)):(this.x-=a.x,this.y-=a.y,this.z-=a.z,this.f-=a.f,this)},X:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=
a.z-b.z,this.f=a.f-b.f,this},p:function(a){return this.x*=a,this.y*=a,this.z*=a,this.f*=a,this},Z:function(a){var b=this.x,c=this.y,d=this.z,f=this.f;a=a.elements;return this.x=a[0]*b+a[4]*c+a[8]*d+a[12]*f,this.y=a[1]*b+a[5]*c+a[9]*d+a[13]*f,this.z=a[2]*b+a[6]*c+a[10]*d+a[14]*f,this.f=a[3]*b+a[7]*c+a[11]*d+a[15]*f,this},oe:function(a){return 0!==a?(this.x/=a,this.y/=a,this.z/=a,this.f/=a):(this.x=0,this.y=0,this.z=0,this.f=1),this},min:function(a){return this.x>a.x&&(this.x=a.x),this.y>a.y&&(this.y=
a.y),this.z>a.z&&(this.z=a.z),this.f>a.f&&(this.f=a.f),this},max:function(a){return this.x<a.x&&(this.x=a.x),this.y<a.y&&(this.y=a.y),this.z<a.z&&(this.z=a.z),this.f<a.f&&(this.f=a.f),this},Ng:function(a,b){return this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x),this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y),this.z<a.z?this.z=a.z:this.z>b.z&&(this.z=b.z),this.f<a.f?this.f=a.f:this.f>b.f&&(this.f=b.f),this},ih:function(){return this.p(-1)},za:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.f*
a.f},yi:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.f*this.f},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.f*this.f)},Iq:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.f)},normalize:function(){return this.oe(this.length())},Qk:function(a){var b=this.length();return 0!==b&&a!==b&&this.p(a/b),this},$e:function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this.z+=(a.z-this.z)*b,this.f+=(a.f-this.f)*
b,this},va:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.f===this.f},kk:function(a){return this.x=a[0],this.y=a[1],this.z=a[2],this.f=a[3],this},fl:function(){return[this.x,this.y,this.z,this.f]},d:function(){return new b.Rc(this.x,this.y,this.z,this.f)}};b.xl=function(a,e){this.start=void 0!==a?a:new b.a;this.end=void 0!==e?e:new b.a};b.xl.prototype={constructor:b.xl,set:function(a,b){return this.start.copy(a),this.end.copy(b),this},copy:function(a){return this.start.copy(a.start),
this.end.copy(a.end),this},bb:function(a){return(a||new b.a).fd(this.start,this.end).p(0.5)},ha:function(){return this.start.gd(this.end)},Z:function(a){return this.start.Z(a),this.end.Z(a),this},va:function(a){return a.start.va(this.start)&&a.end.va(this.end)},d:function(){return(new b.xl).copy(this)}};b.ug=function(a,e){this.min=void 0!==a?a:new b.i(1/0,1/0);this.max=void 0!==e?e:new b.i(-1/0,-1/0)};b.ug.prototype={constructor:b.ug,set:function(a,b){return this.min.copy(a),this.max.copy(b),this},
jf:function(a){if(0<a.length){var b=a[0];this.min.copy(b);this.max.copy(b);for(var c=1,d=a.length;d>c;c++)b=a[c],b.x<this.min.x?this.min.x=b.x:b.x>this.max.x&&(this.max.x=b.x),b.y<this.min.y?this.min.y=b.y:b.y>this.max.y&&(this.max.y=b.y)}else this.re();return this},copy:function(a){return this.min.copy(a.min),this.max.copy(a.max),this},re:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},bb:function(a){return(a||
new b.i).fd(this.min,this.max).p(0.5)},size:function(a){return(a||new b.i).X(this.max,this.min)},Wg:function(a){return this.min.Jb(-a),this.max.Jb(a),this},Pg:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y?!1:!0},getParameter:function(a){return new b.i((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y))},qe:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y?!1:!0},Tg:function(){var a=new b.i;
return function(b){return a.copy(b).Ng(this.min,this.max).sub(b).length()}}(),Cq:function(a){return this.min.max(a.min),this.max.min(a.max),this},io:function(a){return this.min.min(a.min),this.max.max(a.max),this},translate:function(a){return this.min.add(a),this.max.add(a),this},va:function(a){return a.min.va(this.min)&&a.max.va(this.max)},d:function(){return(new b.ug).copy(this)}};b.ye=function(a,e){this.min=void 0!==a?a:new b.a(1/0,1/0,1/0);this.max=void 0!==e?e:new b.a(-1/0,-1/0,-1/0)};b.ye.prototype=
{constructor:b.ye,set:function(a,b){return this.min.copy(a),this.max.copy(b),this},jf:function(a){if(0<a.length){var b=a[0];this.min.copy(b);this.max.copy(b);for(var c=1,d=a.length;d>c;c++)b=a[c],b.x<this.min.x?this.min.x=b.x:b.x>this.max.x&&(this.max.x=b.x),b.y<this.min.y?this.min.y=b.y:b.y>this.max.y&&(this.max.y=b.y),b.z<this.min.z?this.min.z=b.z:b.z>this.max.z&&(this.max.z=b.z)}else this.re();return this},copy:function(a){return this.min.copy(a.min),this.max.copy(a.max),this},re:function(){return this.min.x=
this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},bb:function(a){return(a||new b.a).fd(this.min,this.max).p(0.5)},size:function(a){return(a||new b.a).X(this.max,this.min)},Wg:function(a){return this.min.Jb(-a),this.max.Jb(a),this},Pg:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z?!1:!0},getParameter:function(a){return new b.a((a.x-
this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))},qe:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z?!1:!0},Tg:function(){var a=new b.a;return function(b){return a.copy(b).Ng(this.min,this.max).sub(b).length()}}(),Cq:function(a){return this.min.max(a.min),this.max.min(a.max),this},io:function(a){return this.min.min(a.min),this.max.max(a.max),
this},Z:function(){var a=[new b.a,new b.a,new b.a,new b.a,new b.a,new b.a,new b.a,new b.a];return function(b){return a[0].set(this.min.x,this.min.y,this.min.z).Z(b),a[1].set(this.min.x,this.min.y,this.max.z).Z(b),a[2].set(this.min.x,this.max.y,this.min.z).Z(b),a[3].set(this.min.x,this.max.y,this.max.z).Z(b),a[4].set(this.max.x,this.min.y,this.min.z).Z(b),a[5].set(this.max.x,this.min.y,this.max.z).Z(b),a[6].set(this.max.x,this.max.y,this.min.z).Z(b),a[7].set(this.max.x,this.max.y,this.max.z).Z(b),
this.re(),this.jf(a),this}}(),translate:function(a){return this.min.add(a),this.max.add(a),this},va:function(a){return a.min.va(this.min)&&a.max.va(this.max)},d:function(){return(new b.ye).copy(this)}};b.Ad=function(a,b,c,d,f,g,h,k,l){this.elements=new Float32Array(9);this.set(void 0!==a?a:1,b||0,c||0,d||0,void 0!==f?f:1,g||0,h||0,k||0,void 0!==l?l:1)};b.Ad.prototype={constructor:b.Ad,set:function(a,b,c,d,f,g,h,k,l){var m=this.elements;return m[0]=a,m[3]=b,m[6]=c,m[1]=d,m[4]=f,m[7]=g,m[2]=h,m[5]=
k,m[8]=l,this},Vc:function(){return this.set(1,0,0,0,1,0,0,0,1),this},copy:function(a){a=a.elements;return this.set(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8]),this},tn:function(){var a=new b.a;return function(b){for(var c=0,d=b.length;d>c;c+=3)a.x=b[c],a.y=b[c+1],a.z=b[c+2],a.Fd(this),b[c]=a.x,b[c+1]=a.y,b[c+2]=a.z;return b}}(),p:function(a){var b=this.elements;return b[0]*=a,b[3]*=a,b[6]*=a,b[1]*=a,b[4]*=a,b[7]*=a,b[2]*=a,b[5]*=a,b[8]*=a,this},Ld:function(a,b){var c=a.elements,d=this.elements;
d[0]=c[10]*c[5]-c[6]*c[9];d[1]=-c[10]*c[1]+c[2]*c[9];d[2]=c[6]*c[1]-c[2]*c[5];d[3]=-c[10]*c[4]+c[6]*c[8];d[4]=c[10]*c[0]-c[2]*c[8];d[5]=-c[6]*c[0]+c[2]*c[4];d[6]=c[9]*c[4]-c[5]*c[8];d[7]=-c[9]*c[0]+c[1]*c[8];d[8]=c[5]*c[0]-c[1]*c[4];c=c[0]*d[0]+c[1]*d[3]+c[2]*d[6];if(0===c){if(b)throw Error("Matrix3.getInverse(): can't invert matrix, determinant is 0");return console.warn("Matrix3.getInverse(): can't invert matrix, determinant is 0"),this.Vc(),this}return this.p(1/c),this},ns:function(){var a,b=this.elements;
return a=b[1],b[1]=b[3],b[3]=a,a=b[2],b[2]=b[6],b[6]=a,a=b[5],b[5]=b[7],b[7]=a,this},We:function(a){return this.Ld(a).ns(),this},d:function(){var a=this.elements;return new b.Ad(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8])}};b.K=function(a,b,c,d,f,g,h,k,l,m,q,p,r,v,w,u){var s=this.elements=new Float32Array(16);s[0]=void 0!==a?a:1;s[4]=b||0;s[8]=c||0;s[12]=d||0;s[1]=f||0;s[5]=void 0!==g?g:1;s[9]=h||0;s[13]=k||0;s[2]=l||0;s[6]=m||0;s[10]=void 0!==q?q:1;s[14]=p||0;s[3]=r||0;s[7]=v||0;s[11]=w||0;s[15]=
void 0!==u?u:1};b.K.prototype={constructor:b.K,set:function(a,b,c,d,f,g,h,k,l,m,q,p,r,v,w,u){var s=this.elements;return s[0]=a,s[4]=b,s[8]=c,s[12]=d,s[1]=f,s[5]=g,s[9]=h,s[13]=k,s[2]=l,s[6]=m,s[10]=q,s[14]=p,s[3]=r,s[7]=v,s[11]=w,s[15]=u,this},Vc:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(a){a=a.elements;return this.set(a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]),this},Sv:function(){var a=new b.a;return function(b){var c=
this.elements;b=b.elements;var d=1/a.set(b[0],b[1],b[2]).length(),f=1/a.set(b[4],b[5],b[6]).length(),g=1/a.set(b[8],b[9],b[10]).length();return c[0]=b[0]*d,c[1]=b[1]*d,c[2]=b[2]*d,c[4]=b[4]*f,c[5]=b[5]*f,c[6]=b[6]*f,c[8]=b[8]*g,c[9]=b[9]*g,c[10]=b[10]*g,this}}(),vx:function(a,b){var c=this.elements,d=a.x,f=a.y,g=a.z,h=Math.cos(d),d=Math.sin(d),k=Math.cos(f),f=Math.sin(f),l=Math.cos(g),g=Math.sin(g);if(void 0===b||"XYZ"===b){var m=h*l,q=h*g,p=d*l,r=d*g;c[0]=k*l;c[4]=-k*g;c[8]=f;c[1]=q+p*f;c[5]=m-r*
f;c[9]=-d*k;c[2]=r-m*f;c[6]=p+q*f;c[10]=h*k}else"YXZ"===b?(m=k*l,q=k*g,p=f*l,r=f*g,c[0]=m+r*d,c[4]=p*d-q,c[8]=h*f,c[1]=h*g,c[5]=h*l,c[9]=-d,c[2]=q*d-p,c[6]=r+m*d,c[10]=h*k):"ZXY"===b?(m=k*l,q=k*g,p=f*l,r=f*g,c[0]=m-r*d,c[4]=-h*g,c[8]=p+q*d,c[1]=q+p*d,c[5]=h*l,c[9]=r-m*d,c[2]=-h*f,c[6]=d,c[10]=h*k):"ZYX"===b?(m=h*l,q=h*g,p=d*l,r=d*g,c[0]=k*l,c[4]=p*f-q,c[8]=m*f+r,c[1]=k*g,c[5]=r*f+m,c[9]=q*f-p,c[2]=-f,c[6]=d*k,c[10]=h*k):"YZX"===b?(m=h*k,q=h*f,p=d*k,r=d*f,c[0]=k*l,c[4]=r-m*g,c[8]=p*g+q,c[1]=g,c[5]=
h*l,c[9]=-d*l,c[2]=-f*l,c[6]=q*g+p,c[10]=m-r*g):"XZY"===b&&(m=h*k,q=h*f,p=d*k,r=d*f,c[0]=k*l,c[4]=-g,c[8]=f*l,c[1]=m*g+r,c[5]=h*l,c[9]=q*g-p,c[2]=p*g-q,c[6]=d*l,c[10]=r*g+m);return c[3]=0,c[7]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,this},wx:function(a){var b=this.elements,c=a.x,d=a.y,f=a.z,g=a.f,h=c+c,k=d+d,l=f+f;a=c*h;var m=c*k,c=c*l,q=d*k,d=d*l,f=f*l,h=g*h,k=g*k,g=g*l;return b[0]=1-(q+f),b[4]=m-g,b[8]=c+k,b[1]=m+g,b[5]=1-(a+f),b[9]=d-h,b[2]=c-k,b[6]=d+h,b[10]=1-(a+q),b[3]=0,b[7]=0,b[11]=0,b[12]=
0,b[13]=0,b[14]=0,b[15]=1,this},ub:function(){var a=new b.a,e=new b.a,c=new b.a;return function(b,f,g){var h=this.elements;return c.X(b,f).normalize(),0===c.length()&&(c.z=1),a.$b(g,c).normalize(),0===a.length()&&(c.x+=1E-4,a.$b(g,c).normalize()),e.$b(c,a),h[0]=a.x,h[4]=e.x,h[8]=c.x,h[1]=a.y,h[5]=e.y,h[9]=c.y,h[2]=a.z,h[6]=e.z,h[10]=c.z,this}}(),multiply:function(a,b){return void 0!==b?(console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),
this.Da(a,b)):this.Da(this,a)},Da:function(a,b){var c=a.elements,d=b.elements,f=this.elements,g=c[0],h=c[4],k=c[8],l=c[12],m=c[1],q=c[5],p=c[9],r=c[13],v=c[2],w=c[6],u=c[10],s=c[14],t=c[3],A=c[7],Q=c[11],c=c[15],O=d[0],P=d[4],I=d[8],F=d[12],L=d[1],K=d[5],N=d[9],B=d[13],W=d[2],M=d[6],J=d[10],R=d[14],U=d[3],Y=d[7],C=d[11],d=d[15];return f[0]=g*O+h*L+k*W+l*U,f[4]=g*P+h*K+k*M+l*Y,f[8]=g*I+h*N+k*J+l*C,f[12]=g*F+h*B+k*R+l*d,f[1]=m*O+q*L+p*W+r*U,f[5]=m*P+q*K+p*M+r*Y,f[9]=m*I+q*N+p*J+r*C,f[13]=m*F+q*B+p*
R+r*d,f[2]=v*O+w*L+u*W+s*U,f[6]=v*P+w*K+u*M+s*Y,f[10]=v*I+w*N+u*J+s*C,f[14]=v*F+w*B+u*R+s*d,f[3]=t*O+A*L+Q*W+c*U,f[7]=t*P+A*K+Q*M+c*Y,f[11]=t*I+A*N+Q*J+c*C,f[15]=t*F+A*B+Q*R+c*d,this},p:function(a){var b=this.elements;return b[0]*=a,b[4]*=a,b[8]*=a,b[12]*=a,b[1]*=a,b[5]*=a,b[9]*=a,b[13]*=a,b[2]*=a,b[6]*=a,b[10]*=a,b[14]*=a,b[3]*=a,b[7]*=a,b[11]*=a,b[15]*=a,this},tn:function(){var a=new b.a;return function(b){for(var c=0,d=b.length;d>c;c+=3)a.x=b[c],a.y=b[c+1],a.z=b[c+2],a.Gd(this),b[c]=a.x,b[c+1]=
a.y,b[c+2]=a.z;return b}}(),ns:function(){var a,b=this.elements;return a=b[1],b[1]=b[4],b[4]=a,a=b[2],b[2]=b[8],b[8]=a,a=b[6],b[6]=b[9],b[9]=a,a=b[3],b[3]=b[12],b[12]=a,a=b[7],b[7]=b[13],b[13]=a,a=b[11],b[11]=b[14],b[14]=a,this},Zv:function(a){var b=this.elements;return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],a},hq:function(a,b){var c=this.elements;return a[b]=c[0],a[b+
1]=c[1],a[b+2]=c[2],a[b+3]=c[3],a[b+4]=c[4],a[b+5]=c[5],a[b+6]=c[6],a[b+7]=c[7],a[b+8]=c[8],a[b+9]=c[9],a[b+10]=c[10],a[b+11]=c[11],a[b+12]=c[12],a[b+13]=c[13],a[b+14]=c[14],a[b+15]=c[15],a},Hr:function(a){var b=this.elements;return b[12]=a.x,b[13]=a.y,b[14]=a.z,this},Ld:function(a,b){var c=this.elements,d=a.elements,f=d[0],g=d[4],h=d[8],k=d[12],l=d[1],m=d[5],q=d[9],p=d[13],r=d[2],v=d[6],w=d[10],u=d[14],s=d[3],t=d[7],A=d[11],Q=d[15];c[0]=q*u*t-p*w*t+p*v*A-m*u*A-q*v*Q+m*w*Q;c[4]=k*w*t-h*u*t-k*v*A+
g*u*A+h*v*Q-g*w*Q;c[8]=h*p*t-k*q*t+k*m*A-g*p*A-h*m*Q+g*q*Q;c[12]=k*q*v-h*p*v-k*m*w+g*p*w+h*m*u-g*q*u;c[1]=p*w*s-q*u*s-p*r*A+l*u*A+q*r*Q-l*w*Q;c[5]=h*u*s-k*w*s+k*r*A-f*u*A-h*r*Q+f*w*Q;c[9]=k*q*s-h*p*s-k*l*A+f*p*A+h*l*Q-f*q*Q;c[13]=h*p*r-k*q*r+k*l*w-f*p*w-h*l*u+f*q*u;c[2]=m*u*s-p*v*s+p*r*t-l*u*t-m*r*Q+l*v*Q;c[6]=k*v*s-g*u*s-k*r*t+f*u*t+g*r*Q-f*v*Q;c[10]=g*p*s-k*m*s+k*l*t-f*p*t-g*l*Q+f*m*Q;c[14]=k*m*r-g*p*r-k*l*v+f*p*v+g*l*u-f*m*u;c[3]=q*v*s-m*w*s-q*r*t+l*w*t+m*r*A-l*v*A;c[7]=g*w*s-h*v*s+h*r*t-f*w*t-
g*r*A+f*v*A;c[11]=h*m*s-g*q*s-h*l*t+f*q*t+g*l*A-f*m*A;c[15]=g*q*r-h*m*r+h*l*v-f*q*v-g*l*w+f*m*w;c=d[0]*c[0]+d[1]*c[4]+d[2]*c[8]+d[3]*c[12];if(0==c){if(b)throw Error("Matrix4.getInverse(): can't invert matrix, determinant is 0");return console.warn("Matrix4.getInverse(): can't invert matrix, determinant is 0"),this.Vc(),this}return this.p(1/c),this},translate:function(){console.warn("DEPRECATED: Matrix4's .translate() has been removed.")},scale:function(a){var b=this.elements,c=a.x,d=a.y;a=a.z;return b[0]*=
c,b[4]*=d,b[8]*=a,b[1]*=c,b[5]*=d,b[9]*=a,b[2]*=c,b[6]*=d,b[10]*=a,b[3]*=c,b[7]*=d,b[11]*=a,this},sq:function(){var a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],Math.max(a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10])))},Ck:function(a,b,c){return this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1),this},Qq:function(a){var b=Math.cos(a);a=Math.sin(a);return this.set(1,0,0,0,0,b,-a,0,0,a,b,0,0,0,0,1),this},hn:function(a,b){var c=Math.cos(b),d=Math.sin(b),f=1-c,g=a.x,
h=a.y,k=a.z,l=f*g,m=f*h;return this.set(l*g+c,l*h-d*k,l*k+d*h,0,l*h+d*k,m*h+c,m*k-d*g,0,l*k-d*h,m*k+d*g,f*k*k+c,0,0,0,0,1),this},pv:function(a,b,c){return console.warn("DEPRECATED: Matrix4's .compose() has been deprecated in favor of makeFromPositionQuaternionScale. Please update your code."),this.Bk(a,b,c)},Bk:function(a,b,c){return this.wx(b),this.scale(c),this.Hr(a),this},sx:function(a,b,c,d){return this.vx(b,c),this.scale(d),this.Hr(a),this},Pq:function(a,b,c,d,f,g){var h=this.elements;return h[0]=
2*f/(b-a),h[4]=0,h[8]=(b+a)/(b-a),h[12]=0,h[1]=0,h[5]=2*f/(d-c),h[9]=(d+c)/(d-c),h[13]=0,h[2]=0,h[6]=0,h[10]=-(g+f)/(g-f),h[14]=-2*g*f/(g-f),h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this},ux:function(a,e,c,d){a=c*Math.tan(b.be.Rg(0.5*a));var f=-a;return this.Pq(f*e,a*e,f,a,c,d)},tx:function(a,b,c,d,f,g){var h=this.elements,k=b-a,l=c-d,m=g-f;return h[0]=2/k,h[4]=0,h[8]=0,h[12]=-((b+a)/k),h[1]=0,h[5]=2/l,h[9]=0,h[13]=-((c+d)/l),h[2]=0,h[6]=0,h[10]=-2/m,h[14]=-((g+f)/m),h[3]=0,h[7]=0,h[11]=0,h[15]=1,this},d:function(){var a=
this.elements;return new b.K(a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15])}};b.extend(b.K.prototype,{xm:function(){var a=new b.a,e=new b.a,c=new b.a,d=new b.K;return function(f,g,h){var k=this.elements;return a.set(k[0],k[1],k[2]),e.set(k[4],k[5],k[6]),c.set(k[8],k[9],k[10]),f=f instanceof b.a?f:new b.a,g=g instanceof b.Bb?g:new b.Bb,h=h instanceof b.a?h:new b.a,h.x=a.length(),h.y=e.length(),h.z=c.length(),f.x=k[12],f.y=k[13],f.z=k[14],d.copy(this),d.elements[0]/=
h.x,d.elements[1]/=h.x,d.elements[2]/=h.x,d.elements[4]/=h.y,d.elements[5]/=h.y,d.elements[6]/=h.y,d.elements[8]/=h.z,d.elements[9]/=h.z,d.elements[10]/=h.z,g.Ni(d),[f,g,h]}}()});b.vj=function(a,e){this.origin=void 0!==a?a:new b.a;this.direction=void 0!==e?e:new b.a};b.vj.prototype={constructor:b.vj,set:function(a,b){return this.origin.copy(a),this.direction.copy(b),this},copy:function(a){return this.origin.copy(a.origin),this.direction.copy(a.direction),this},Tg:function(){var a=new b.a;return function(b){var c=
a.X(b,this.origin).za(this.direction);return a.copy(this.direction).p(c).add(this.origin),a.gd(b)}}(),Z:function(a){return this.direction.add(this.origin).Z(a),this.origin.Z(a),this.direction.sub(this.origin),this},va:function(a){return a.origin.va(this.origin)&&a.direction.va(this.direction)},d:function(){return(new b.vj).copy(this)}};b.ee=function(a,e){this.bb=void 0!==a?a:new b.a;this.Q=void 0!==e?e:0};b.ee.prototype={constructor:b.ee,set:function(a,b){return this.bb.copy(a),this.Q=b,this},Zy:function(a,
b){for(var c=0,d=0,f=b.length;f>d;d++)c=Math.max(c,a.Ug(b[d]));return this.bb=a,this.Q=Math.sqrt(c),this},copy:function(a){return this.bb.copy(a.bb),this.Q=a.Q,this},empty:function(){return 0>=this.Q},Pg:function(a){return a.Ug(this.bb)<=this.Q*this.Q},Tg:function(a){return a.gd(this.bb)-this.Q},lk:function(a){a=a||new b.ye;return a.set(this.bb,this.bb),a.Wg(this.Q),a},Z:function(a){return this.bb.Z(a),this.Q*=a.sq(),this},translate:function(a){return this.bb.add(a),this},va:function(a){return a.bb.va(this.bb)&&
a.Q===this.Q},d:function(){return(new b.ee).copy(this)}};b.yf=function(a,e,c,d,f,g){this.ph=[void 0!==a?a:new b.de,void 0!==e?e:new b.de,void 0!==c?c:new b.de,void 0!==d?d:new b.de,void 0!==f?f:new b.de,void 0!==g?g:new b.de]};b.yf.prototype={constructor:b.yf,set:function(a,b,c,d,f,g){var h=this.ph;return h[0].copy(a),h[1].copy(b),h[2].copy(c),h[3].copy(d),h[4].copy(f),h[5].copy(g),this},copy:function(a){for(var b=this.ph,c=0;6>c;c++)b[c].copy(a.ph[c]);return this},Pk:function(a){var b=this.ph,c=
a.elements;a=c[0];var d=c[1],f=c[2],g=c[3],h=c[4],k=c[5],l=c[6],m=c[7],q=c[8],p=c[9],r=c[10],v=c[11],w=c[12],u=c[13],s=c[14],c=c[15];return b[0].sh(g-a,m-h,v-q,c-w).normalize(),b[1].sh(g+a,m+h,v+q,c+w).normalize(),b[2].sh(g+d,m+k,v+p,c+u).normalize(),b[3].sh(g-d,m-k,v-p,c-u).normalize(),b[4].sh(g-f,m-l,v-r,c-s).normalize(),b[5].sh(g+f,m+l,v+r,c+s).normalize(),this},rk:function(){var a=new b.a;return function(b){var c=b.A,d=this.ph;b=-b.l.Kb.Q*c.sq();a.lb(c);for(c=0;6>c;c++){var f=d[c].Tg(a);if(b>
f)return!1}return!0}}(),Pg:function(a){for(var b=this.ph,c=0;6>c;c++)if(0>b[c].Tg(a))return!1;return!0},d:function(){return(new b.yf).copy(this)}};b.de=function(a,e){this.s=void 0!==a?a:new b.a(1,0,0);this.Zb=void 0!==e?e:0};b.de.prototype={constructor:b.de,set:function(a,b){return this.s.copy(a),this.Zb=b,this},sh:function(a,b,c,d){return this.s.set(a,b,c),this.Zb=d,this},$y:function(a,b){return this.s.copy(a),this.Zb=-b.za(this.s),this},copy:function(a){return this.s.copy(a.s),this.Zb=a.Zb,this},
normalize:function(){var a=1/this.s.length();return this.s.p(a),this.Zb*=a,this},ih:function(){return this.Zb*=-1,this.s.ih(),this},Tg:function(a){return this.s.za(a)+this.Zb},sv:function(a){return(a||new b.a).copy(this.s).p(-this.Zb)},Z:function(){var a=new b.a,e=new b.a;return function(c,d){d=d||(new b.Ad).We(c);var f=a.copy(this.s).Fd(d),g=this.sv(e);return g.Z(c),this.$y(f,g),this}}(),translate:function(a){return this.Zb-=a.za(this.s),this},va:function(a){return a.s.va(this.s)&&a.Zb==this.Zb},
d:function(){return(new b.de).copy(this)}};b.be={Ng:function(a,b,c){return b>a?b:a>c?c:a},GB:function(a,b){return b>a?b:a},qE:function(a,b,c,d,f){return d+(a-b)*(f-d)/(c-b)},oz:function(a,b,c){return b>=a?0:a>=c?1:(a=(a-b)/(c-b),a*a*(3-2*a))},UG:function(a,b,c){return b>=a?0:a>=c?1:(a=(a-b)/(c-b),a*a*a*(a*(6*a-15)+10))},Fy:function(){return(65280*Math.random()+255*Math.random())/65535},eG:function(a,b){return a+Math.floor(Math.random()*(b-a+1))},cG:function(a,b){return a+Math.random()*(b-a)},dG:function(a){return a*
(0.5-Math.random())},MG:function(a){return 0>a?-1:0<a?1:0},Rg:function(){var a=Math.PI/180;return function(b){return b*a}}(),bG:function(){var a=180/Math.PI;return function(b){return b*a}}()};b.HA=function(a){function e(a,b,e,c,d,f,g){a=0.5*(e-a);c=0.5*(c-b);return(2*(b-e)+a+c)*g+(-3*(b-e)-2*a-c)*f+a*d+b}this.M=a;var c,d,f,g,h,k,l,m,q,p=[],r={x:0,y:0,z:0};this.nD=function(a){this.M=[];for(var b=0;b<a.length;b++)this.M[b]={x:a[b][0],y:a[b][1],z:a[b][2]}};this.Pa=function(a){return c=(this.M.length-
1)*a,d=Math.floor(c),f=c-d,p[0]=0===d?d:d-1,p[1]=d,p[2]=d>this.M.length-2?this.M.length-1:d+1,p[3]=d>this.M.length-3?this.M.length-1:d+2,k=this.M[p[0]],l=this.M[p[1]],m=this.M[p[2]],q=this.M[p[3]],g=f*f,h=f*g,r.x=e(k.x,l.x,m.x,q.x,f,g,h),r.y=e(k.y,l.y,m.y,q.y,f,g,h),r.z=e(k.z,l.z,m.z,q.z,f,g,h),r};this.VC=function(){var a,b,e=this.M.length,c=[];for(a=0;e>a;a++)b=this.M[a],c[a]=[b.x,b.y,b.z];return c};this.Pf=function(a){var e,c,d,f=e=e=0,g=new b.a,h=new b.a,k=[],l=0;k[0]=0;a||(a=100);c=this.M.length*
a;g.copy(this.M[0]);for(a=1;c>a;a++)e=a/c,d=this.Pa(e),h.copy(d),l+=h.gd(g),g.copy(d),e*=this.M.length-1,e=Math.floor(e),e!=f&&(k[e]=l,f=e);return k[k.length]=l,{Op:k,total:l}};this.lG=function(a){var e,c,d,f,g,h,k=[],l=new b.a,m=this.Pf();k.push(l.copy(this.M[0]).d());for(e=1;e<this.M.length;e++){c=m.Op[e]-m.Op[e-1];h=Math.ceil(a*c/m.total);f=(e-1)/(this.M.length-1);g=e/(this.M.length-1);for(c=1;h-1>c;c++)d=f+c*(1/h)*(g-f),d=this.Pa(d),k.push(l.copy(d).d());k.push(l.copy(this.M[e]).d())}this.M=k}};
b.Dd=function(a,e,c){this.r=void 0!==a?a:new b.a;this.h=void 0!==e?e:new b.a;this.t=void 0!==c?c:new b.a};b.Dd.s=function(){var a=new b.a;return function(e,c,d,f){f=f||new b.a;f.X(d,c);a.X(e,c);f.Id(a);e=f.yi();return 0<e?f.p(1/Math.sqrt(e)):f.set(0,0,0)}}();b.Dd.jm=function(){var a=new b.a,e=new b.a,c=new b.a;return function(d,f,g,h,k){a.X(h,f);e.X(g,f);c.X(d,f);d=a.za(a);f=a.za(e);g=a.za(c);var l=e.za(e);h=e.za(c);var m=d*l-f*f;k=k||new b.a;if(0==m)return k.set(-2,-1,-1);m=1/m;l=(l*g-f*h)*m;d=(d*
h-f*g)*m;return k.set(1-l-d,d,l)}}();b.Dd.Pg=function(){var a=new b.a;return function(e,c,d,f){e=b.Dd.jm(e,c,d,f,a);return 0<=e.x&&0<=e.y&&1>=e.x+e.y}}();b.Dd.prototype={constructor:b.Dd,set:function(a,b,c){return this.r.copy(a),this.h.copy(b),this.t.copy(c),this},copy:function(a){return this.r.copy(a.r),this.h.copy(a.h),this.t.copy(a.t),this},Hg:function(){var a=new b.a,e=new b.a;return function(){return a.X(this.t,this.h),e.X(this.r,this.h),0.5*a.Id(e).length()}}(),s:function(a){return b.Dd.s(this.r,
this.h,this.t,a)},jm:function(a,e){return b.Dd.jm(a,this.r,this.h,this.t,e)},Pg:function(a){return b.Dd.Pg(a,this.r,this.h,this.t)},va:function(a){return a.r.va(this.r)&&a.h.va(this.h)&&a.t.va(this.t)},d:function(){return(new b.Dd).copy(this)}};b.OA=function(a){return console.warn("THREE.Vertex has been DEPRECATED. Use THREE.Vector3 instead."),a};b.NA=function(a,e){return console.warn("THREE.UV has been DEPRECATED. Use THREE.Vector2 instead."),new b.i(a,e)};b.ql=function(a){this.Tu=void 0!==a?a:!0;
this.elapsedTime=this.wn=this.startTime=0;this.Mk=!1};b.ql.prototype={constructor:b.ql,start:function(){this.wn=this.startTime=void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now();this.Mk=!0},stop:function(){this.hw();this.Mk=!1},hw:function(){return this.qq(),this.elapsedTime},qq:function(){var a=0;if(this.Tu&&!this.Mk&&this.start(),this.Mk){var b=void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now(),a=0.0010*
(b-this.wn);this.wn=b;this.elapsedTime+=a}return a}};b.P=Ia();b.P.prototype={constructor:b.P,addEventListener:function(a,b){void 0===this.Ed&&(this.Ed={});var c=this.Ed;void 0===c[a]&&(c[a]=[]);-1===c[a].indexOf(b)&&c[a].push(b)},eb:function(a,b){if(void 0===this.Ed)return!1;var c=this.Ed;return void 0!==c[a]&&-1!==c[a].indexOf(b)?!0:!1},removeEventListener:function(a,b){if(void 0!==this.Ed){var c=this.Ed,d=c[a].indexOf(b);-1!==d&&c[a].splice(d,1)}},dispatchEvent:function(a){if(void 0!==this.Ed){var b=
this.Ed[a.type];if(void 0!==b){a.target=this;for(var c=0,d=b.length;d>c;c++)b[c].call(this,a)}}}};(function(a){a.Gl=function(b,c,d,f){this.Ji=new a.vj(b,c);0<this.Ji.direction.yi()&&this.Ji.direction.normalize();this.Ja=d||0;this.Ia=f||1/0};new a.K;a.Gl.prototype.precision=1E-4;a.Gl.prototype.set=function(a,b){this.Ji.set(a,b);0<this.Ji.direction.length()&&this.Ji.direction.normalize()}})(b);b.w=function(){this.id=b.kt++;this.name="";this.parent=void 0;this.children=[];this.vd=new b.a(0,1,0);this.position=
new b.a;this.rotation=new b.a;this.Ue=b.w.yv;this.scale=new b.a(1,1,1);this.Vd=null;this.wr=!0;this.ba=new b.K;this.A=new b.K;this.vb=this.Va=!0;this.fa=new b.Bb;this.jb=!1;this.visible=!0;this.qh=this.Lb=!1;this.Of=!0;this.xa={}};b.w.prototype={constructor:b.w,ke:function(){var a=new b.K;return function(b){this.ba.Da(b,this.ba);this.position.lb(this.ba);this.scale.mw(this.ba);a.Sv(this.ba);!0===this.jb?this.fa.Ni(a):this.rotation.On(a,this.Ue)}}(),gl:function(){var a=new b.a;return function(b,c){return a.copy(b),
!0===this.jb?a.Qj(this.fa):a.Mu(this.rotation,this.Ue),this.position.add(a.p(c)),this}}(),translate:function(a,b){return console.warn("DEPRECATED: Object3D's .translate() has been removed. Use .translateOnAxis( axis, distance ) instead. Note args have been changed."),this.gl(b,a)},eo:function(){var a=new b.a(1,0,0);return function(b){return this.gl(a,b)}}(),ks:function(){var a=new b.a(0,1,0);return function(b){return this.gl(a,b)}}(),ls:function(){var a=new b.a(0,0,1);return function(b){return this.gl(a,
b)}}(),ub:function(){var a=new b.K;return function(b){a.ub(b,this.position,this.vd);!0===this.jb?this.fa.Ni(a):this.rotation.On(a,this.Ue)}}(),add:function(a){if(a===this)return console.warn("THREE.Object3D.add: An object can't be added as a child of itself."),void 0;if(a instanceof b.w){void 0!==a.parent&&a.parent.remove(a);a.parent=this;this.children.push(a);for(var e=this;void 0!==e.parent;)e=e.parent;void 0!==e&&e instanceof b.Cf&&e.ep(a)}},remove:function(a){var e=this.children.indexOf(a);if(-1!==
e){a.parent=void 0;this.children.splice(e,1);for(e=this;void 0!==e.parent;)e=e.parent;void 0!==e&&e instanceof b.Cf&&e.kp(a)}},ho:function(a){a(this);for(var b=0,c=this.children.length;c>b;b++)this.children[b].ho(a)},Nc:function(){!1===this.jb?this.ba.sx(this.position,this.rotation,this.Ue,this.scale):this.ba.Bk(this.position,this.fa,this.scale);this.vb=!0},fc:function(a){!0===this.Va&&this.Nc();(!0===this.vb||!0===a)&&(void 0===this.parent?this.A.copy(this.ba):this.A.Da(this.parent.A,this.ba),this.vb=
!1,a=!0);for(var b=0,c=this.children.length;c>b;b++)this.children[b].fc(a)},d:function(a){void 0===a&&(a=new b.w);a.name=this.name;a.vd.copy(this.vd);a.position.copy(this.position);a.rotation instanceof b.a&&a.rotation.copy(this.rotation);a.Ue=this.Ue;a.scale.copy(this.scale);a.Vd=this.Vd;a.wr=this.wr;a.ba.copy(this.ba);a.A.copy(this.A);a.Va=this.Va;a.vb=this.vb;a.fa.copy(this.fa);a.jb=this.jb;a.visible=this.visible;a.Lb=this.Lb;a.qh=this.qh;a.Of=this.Of;a.xa=JSON.parse(JSON.stringify(this.xa));for(var e=
0;e<this.children.length;e++)a.add(this.children[e].d());return a}};b.w.yv="XYZ";b.kt=0;b.Dl=function(){function a(a,c){function h(a){for(var c=0,d=a.children.length;d>c;c++){var g=a.children[c];!1!==g.visible&&(g instanceof b.Ga?W.fb.push(g):g instanceof b.J||g instanceof b.Na?(!1===g.Of||!0===na.rk(g))&&(f=e(),f.object=g,null!==g.Vd?f.z=g.Vd:(M.lb(g.A),M.Gd(D),f.z=M.z),W.da.push(f)):g instanceof b.Df||g instanceof b.Ih?(f=e(),f.object=g,null!==g.Vd?f.z=g.Vd:(M.lb(g.A),M.Gd(D),f.z=M.z),W.bl.push(f)):
(f=e(),f.object=g,null!==g.Vd?f.z=g.Vd:(M.lb(g.A),M.Gd(D),f.z=M.z),W.da.push(f)),h(g))}}g=0;W.da.length=0;W.bl.length=0;W.fb.length=0;return h(a),!0===c&&W.da.sort(d),W}function e(){if(g===t){var a=new b.tt;return s.push(a),t++,g++,a}return s[g++]}function c(){if(k===Q){var a=new b.vc;return A.push(a),Q++,k++,a}return A[k++]}function d(a,b){return b.z-a.z}var f,g,h,k,l,m,q,p,r,v,w,u,s=[],t=0,A=[],Q=0,O=[],P=0,I=[],F=0,L=[],K=0,N=[],B=0,W={da:[],bl:[],fb:[],elements:[]},M=new b.a,J=new b.Rc,R=new b.ye(new b.a(-1,
-1,-1),new b.a(1,1,1)),U=new b.ye,Y=Array(3),C=Array(4),y=new b.K,D=new b.K,Z=new b.K,ma=new b.Ad,S=new b.Ad,G=new b.a,na=new b.yf,Ba=new b.Rc,wa=new b.Rc;this.YF=function(a,b){return b.gb.Ld(b.A),D.Da(b.wa,b.gb),a.Gd(D)};this.il=function(a,b){b.or.Ld(b.wa);D.Da(b.A,b.or);a.Gd(D)};this.RF=function(a,c){a.z=-1;var e=new b.a(a.x,a.y,1);return this.il(a,c),this.il(e,c),e.sub(a).normalize(),new b.Gl(a,e)};this.By=function(e,f,g,s){var n,t,Q,M,V,T,Ga,ra,ea,ha,$a,la,va,Oa,ka,Pa,Ka,ya=!1;w=r=q=m=0;W.elements.length=
0;!0===e.Rj&&e.fc();void 0===f.parent&&f.fc();y.copy(f.gb.Ld(f.A));D.Da(f.wa,y);S.We(y);na.Pk(D);W=a(e,g);e=0;for(g=W.da.length;g>e;e++)if(ra=W.da[e].object,u=ra.A,k=0,ra instanceof b.J){ea=ra.l;Q=ea.c;ha=ea.j;ea=ea.C;ma.We(u);Pa=ra.n instanceof b.gc;Ka=!0===Pa?ra.n:null;n=0;for(t=Q.length;t>n;n++)h=c(),h.nd.copy(Q[n]).Z(u),h.e.copy(h.nd).Z(D),h.e.x/=h.e.f,h.e.y/=h.e.f,h.e.z/=h.e.f,h.visible=!(-1>h.e.x||1<h.e.x||-1>h.e.y||1<h.e.y||-1>h.e.z||1<h.e.z);Q=0;for(n=ha.length;n>Q;Q++){t=ha[Q];var ia=!0===
Pa?Ka.ja[t.Ca]:ra.n;if(void 0!==ia){T=ia.Kc;if(t instanceof b.S){if(la=A[t.r],va=A[t.h],Oa=A[t.t],Y[0]=la.e,Y[1]=va.e,Y[2]=Oa.e,!0!==la.visible&&!0!==va.visible&&!0!==Oa.visible&&!R.qe(U.jf(Y)))continue;if(ya=0>(Oa.e.x-la.e.x)*(va.e.y-la.e.y)-(Oa.e.y-la.e.y)*(va.e.x-la.e.x),T!==b.dd&&ya!==(T===b.vg))continue;m===P?(M=new b.To,l=(O.push(M),P++,m++,M)):l=O[m++];l.ca.copy(la);l.ga.copy(va);l.Qb.copy(Oa)}else if(t instanceof b.qa){if(la=A[t.r],va=A[t.h],Oa=A[t.t],ka=A[t.oa],C[0]=la.e,C[1]=va.e,C[2]=Oa.e,
C[3]=ka.e,!0!==la.visible&&!0!==va.visible&&!0!==Oa.visible&&!0!==ka.visible&&!R.qe(U.jf(C)))continue;if(ya=0>(ka.e.x-la.e.x)*(va.e.y-la.e.y)-(ka.e.y-la.e.y)*(va.e.x-la.e.x)||0>(va.e.x-Oa.e.x)*(ka.e.y-Oa.e.y)-(va.e.y-Oa.e.y)*(ka.e.x-Oa.e.x),T!==b.dd&&ya!==(T===b.vg))continue;q===F?(M=new b.Uo,l=(I.push(M),F++,q++,M)):l=I[q++];l.ca.copy(la);l.ga.copy(va);l.Qb.copy(Oa);l.no.copy(ka)}l.Wf.copy(t.s);!1!==ya||T!==b.rf&&T!==b.dd||l.Wf.ih();l.Wf.Fd(ma).normalize();l.Gk.copy(l.Wf).Fd(S);l.Rh.copy(t.ya).Z(u);
Ga=t.G;M=0;for(V=Ga.length;V>M;M++){var sa=l.ue[M];sa.copy(Ga[M]);!1!==ya||T!==b.rf&&T!==b.dd||sa.ih();sa.Fd(ma).normalize();l.bd[M].copy(sa).Fd(S)}l.ml=Ga.length;T=0;for(M=ea.length;M>T;T++)if($a=ea[T][Q],void 0!==$a)for(V=0,Ga=$a.length;Ga>V;V++)l.pg[T][V]=$a[V];l.color=t.color;l.n=ia;G.copy(l.Rh).Gd(D);l.z=G.z;W.elements.push(l)}}}else if(ra instanceof b.Na)for(Z.Da(D,u),Q=ra.l.c,la=c(),la.e.copy(Q[0]).Z(Z),ha=ra.type===b.Dh?2:1,n=1,t=Q.length;t>n;n++)la=c(),la.e.copy(Q[n]).Z(Z),0<(n+1)%ha||(va=
A[k-2],Ba.copy(la.e),wa.copy(va.e),ea=Ba,Pa=wa,Ka=0,ia=1,T=ea.z+ea.f,M=Pa.z+Pa.f,V=-ea.z+ea.f,Ga=-Pa.z+Pa.f,!0===(0<=T&&0<=M&&0<=V&&0<=Ga?!0:0>T&&0>M||0>V&&0>Ga?!1:(0>T?Ka=Math.max(Ka,T/(T-M)):0>M&&(ia=Math.min(ia,T/(T-M))),0>V?Ka=Math.max(Ka,V/(V-Ga)):0>Ga&&(ia=Math.min(ia,V/(V-Ga))),Ka>ia?!1:(ea.$e(Pa,Ka),Pa.$e(ea,1-ia),!0)))&&(Ba.p(1/Ba.f),wa.p(1/wa.f),r===K?(ea=new b.Vo,ea=(L.push(ea),K++,r++,ea)):ea=L[r++],p=ea,p.ca.e.copy(Ba),p.ga.e.copy(wa),p.z=Math.max(Ba.z,wa.z),p.n=ra.n,ra.n.m===b.Fe&&(p.m[0].copy(ra.l.Oa[n]),
p.m[1].copy(ra.l.Oa[n-1])),W.elements.push(p)));e=0;for(g=W.bl.length;g>e;e++)ra=W.bl[e].object,u=ra.A,ra instanceof b.Ih&&(J.set(u.elements[12],u.elements[13],u.elements[14],1),J.Z(D),J.z/=J.f,0<J.z&&1>J.z&&(w===B?($a=new b.Wo,$a=(N.push($a),B++,w++,$a)):$a=N[w++],v=$a,v.object=ra,v.x=J.x/J.f,v.y=J.y/J.f,v.z=J.z,v.rotation=ra.rotation.z,v.scale.x=ra.scale.x*Math.abs(v.x-(J.x+f.wa.elements[0])/(J.f+f.wa.elements[12])),v.scale.y=ra.scale.y*Math.abs(v.y-(J.y+f.wa.elements[5])/(J.f+f.wa.elements[13])),
v.n=ra.n,W.elements.push(v)));return!0===s&&W.elements.sort(d),W}};b.S=function(a,e,c,d,f,g){this.r=a;this.h=e;this.t=c;this.s=d instanceof b.a?d:new b.a;this.G=d instanceof Array?d:[];this.color=f instanceof b.k?f:new b.k;this.m=f instanceof Array?f:[];this.Yd=[];this.Ca=void 0!==g?g:0;this.ya=new b.a};b.S.prototype={constructor:b.S,d:function(){var a=new b.S(this.r,this.h,this.t);a.s.copy(this.s);a.color.copy(this.color);a.ya.copy(this.ya);a.Ca=this.Ca;var e,c;e=0;for(c=this.G.length;c>e;e++)a.G[e]=
this.G[e].d();e=0;for(c=this.m.length;c>e;e++)a.m[e]=this.m[e].d();e=0;for(c=this.Yd.length;c>e;e++)a.Yd[e]=this.Yd[e].d();return a}};b.qa=function(a,e,c,d,f,g,h){this.r=a;this.h=e;this.t=c;this.oa=d;this.s=f instanceof b.a?f:new b.a;this.G=f instanceof Array?f:[];this.color=g instanceof b.k?g:new b.k;this.m=g instanceof Array?g:[];this.Yd=[];this.Ca=void 0!==h?h:0;this.ya=new b.a};b.qa.prototype={constructor:b.qa,d:function(){var a=new b.qa(this.r,this.h,this.t,this.oa);a.s.copy(this.s);a.color.copy(this.color);
a.ya.copy(this.ya);a.Ca=this.Ca;var e,c;e=0;for(c=this.G.length;c>e;e++)a.G[e]=this.G[e].d();e=0;for(c=this.m.length;c>e;e++)a.m[e]=this.m[e].d();e=0;for(c=this.Yd.length;c>e;e++)a.Yd[e]=this.Yd[e].d();return a}};b.H=function(){this.id=b.xo++;this.name="";this.c=[];this.Oa=[];this.Xf=[];this.j=[];this.jd=[[]];this.C=[[]];this.B=[];this.cf=[];this.sa=[];this.of=[];this.nf=[];this.Lq=[];this.Kb=this.Fc=null;this.eh=!1;this.ji=!0;this.Mp=this.wk=this.Mb=this.fj=this.Sd=this.kl=this.li=this.Xa=!1};b.H.prototype=
{constructor:b.H,addEventListener:b.P.prototype.addEventListener,eb:b.P.prototype.eb,removeEventListener:b.P.prototype.removeEventListener,dispatchEvent:b.P.prototype.dispatchEvent,ke:function(a){for(var e=(new b.Ad).We(a),c=0,d=this.c.length;d>c;c++)this.c[c].Z(a);c=0;for(d=this.j.length;d>c;c++){var f=this.j[c];f.s.Fd(e).normalize();for(var g=0,h=f.G.length;h>g;g++)f.G[g].Fd(e).normalize();f.ya.Z(a)}},tb:function(){var a,e,c;a=0;for(e=this.j.length;e>a;a++)c=this.j[a],c.ya.set(0,0,0),c instanceof
b.S?(c.ya.add(this.c[c.r]),c.ya.add(this.c[c.h]),c.ya.add(this.c[c.t]),c.ya.oe(3)):c instanceof b.qa&&(c.ya.add(this.c[c.r]),c.ya.add(this.c[c.h]),c.ya.add(this.c[c.t]),c.ya.add(this.c[c.oa]),c.ya.oe(4))},Yb:function(){for(var a=new b.a,e=new b.a,c=0,d=this.j.length;d>c;c++){var f=this.j[c],g=this.c[f.r],h=this.c[f.h];a.X(this.c[f.t],h);e.X(g,h);a.Id(e);a.normalize();f.s.copy(a)}},ne:function(a){var e,c,d,f;if(void 0===this.Aj){f=this.Aj=Array(this.c.length);e=0;for(c=this.c.length;c>e;e++)f[e]=new b.a;
e=0;for(c=this.j.length;c>e;e++)d=this.j[e],d instanceof b.S?d.G=[new b.a,new b.a,new b.a]:d instanceof b.qa&&(d.G=[new b.a,new b.a,new b.a,new b.a])}else for(f=this.Aj,e=0,c=this.c.length;c>e;e++)f[e].set(0,0,0);if(a){var g,h,k,l;a=new b.a;var m=new b.a,q=new b.a,p=new b.a,r=new b.a;e=0;for(c=this.j.length;c>e;e++)d=this.j[e],d instanceof b.S?(g=this.c[d.r],h=this.c[d.h],k=this.c[d.t],a.X(k,h),m.X(g,h),a.Id(m),f[d.r].add(a),f[d.h].add(a),f[d.t].add(a)):d instanceof b.qa&&(g=this.c[d.r],h=this.c[d.h],
k=this.c[d.t],l=this.c[d.oa],q.X(l,h),m.X(g,h),q.Id(m),f[d.r].add(q),f[d.h].add(q),f[d.oa].add(q),p.X(l,k),r.X(h,k),p.Id(r),f[d.h].add(p),f[d.t].add(p),f[d.oa].add(p))}else for(e=0,c=this.j.length;c>e;e++)d=this.j[e],d instanceof b.S?(f[d.r].add(d.s),f[d.h].add(d.s),f[d.t].add(d.s)):d instanceof b.qa&&(f[d.r].add(d.s),f[d.h].add(d.s),f[d.t].add(d.s),f[d.oa].add(d.s));e=0;for(c=this.c.length;c>e;e++)f[e].normalize();e=0;for(c=this.j.length;c>e;e++)d=this.j[e],d instanceof b.S?(d.G[0].copy(f[d.r]),
d.G[1].copy(f[d.h]),d.G[2].copy(f[d.t])):d instanceof b.qa&&(d.G[0].copy(f[d.r]),d.G[1].copy(f[d.h]),d.G[2].copy(f[d.t]),d.G[3].copy(f[d.oa]))},qv:function(){var a,e,c,d,f;c=0;for(d=this.j.length;d>c;c++)for(f=this.j[c],f.Nl?f.Nl.copy(f.s):f.Nl=f.s.d(),f.Kh||(f.Kh=[]),a=0,e=f.G.length;e>a;a++)f.Kh[a]?f.Kh[a].copy(f.G[a]):f.Kh[a]=f.G[a].d();var g=new b.H;g.j=this.j;a=0;for(e=this.B.length;e>a;a++){if(!this.sa[a]){this.sa[a]={};this.sa[a].bk=[];this.sa[a].G=[];var h,k,l=this.sa[a].bk,m=this.sa[a].G;
c=0;for(d=this.j.length;d>c;c++)f=this.j[c],h=new b.a,k=f instanceof b.S?{r:new b.a,h:new b.a,t:new b.a}:{r:new b.a,h:new b.a,t:new b.a,oa:new b.a},l.push(h),m.push(k)}l=this.sa[a];g.c=this.B[a].c;g.Yb();g.ne();c=0;for(d=this.j.length;d>c;c++)f=this.j[c],h=l.bk[c],k=l.G[c],h.copy(f.s),f instanceof b.S?(k.r.copy(f.G[0]),k.h.copy(f.G[1]),k.t.copy(f.G[2])):(k.r.copy(f.G[0]),k.h.copy(f.G[1]),k.t.copy(f.G[2]),k.oa.copy(f.G[3]))}c=0;for(d=this.j.length;d>c;c++)f=this.j[c],f.s=f.Nl,f.G=f.Kh},Wj:function(){function a(a,
b,e,c,d,f,g){k=a.c[b];l=a.c[e];m=a.c[c];q=h[d];p=h[f];r=h[g];v=l.x-k.x;w=m.x-k.x;u=l.y-k.y;s=m.y-k.y;t=l.z-k.z;A=m.z-k.z;Q=p.x-q.x;O=r.x-q.x;P=p.y-q.y;I=r.y-q.y;F=1/(Q*I-O*P);B.set((I*v-P*w)*F,(I*u-P*s)*F,(I*t-P*A)*F);W.set((Q*w-O*v)*F,(Q*s-O*u)*F,(Q*A-O*t)*F);K[b].add(B);K[e].add(B);K[c].add(B);N[b].add(W);N[e].add(W);N[c].add(W)}var e,c,d,f,g,h,k,l,m,q,p,r,v,w,u,s,t,A,Q,O,P,I,F,L,K=[],N=[],B=new b.a,W=new b.a,M=new b.a,J=new b.a,R=new b.a;e=0;for(c=this.c.length;c>e;e++)K[e]=new b.a,N[e]=new b.a;
e=0;for(c=this.j.length;c>e;e++)g=this.j[e],h=this.C[0][e],g instanceof b.S?a(this,g.r,g.h,g.t,0,1,2):g instanceof b.qa&&(a(this,g.r,g.h,g.oa,0,1,3),a(this,g.h,g.t,g.oa,1,2,3));var U=["a","b","c","d"];e=0;for(c=this.j.length;c>e;e++)for(g=this.j[e],d=0;d<g.G.length;d++)R.copy(g.G[d]),f=g[U[d]],L=K[f],M.copy(L),M.sub(R.p(R.za(L))).normalize(),J.$b(g.G[d],L),f=J.za(N[f]),f=0>f?-1:1,g.Yd[d]=new b.Rc(M.x,M.y,M.z,f);this.eh=!0},Pp:function(){for(var a=0,b=this.c,c=0,d=b.length;d>c;c++)0<c&&(a+=b[c].gd(b[c-
1])),this.Lq[c]=a},Zh:function(){null===this.Fc&&(this.Fc=new b.ye);this.Fc.jf(this.c)},$h:function(){null===this.Kb&&(this.Kb=new b.ee);this.Kb.Zy(this.Kb.bb,this.c)},on:function(){var a,e,c,d,f,g,h={},k=[],l=[],m=Math.pow(10,4);this.Aj=void 0;e=0;for(c=this.c.length;c>e;e++)a=this.c[e],a=[Math.round(a.x*m),Math.round(a.y*m),Math.round(a.z*m)].join("_"),void 0===h[a]?(h[a]=e,k.push(this.c[e]),l[e]=k.length-1):l[e]=l[h[a]];h=[];e=0;for(c=this.j.length;c>e;e++)if(d=this.j[e],d instanceof b.S)for(d.r=
l[d.r],d.h=l[d.h],d.t=l[d.t],a=[d.r,d.h,d.t],m=-1,f=0;3>f;f++){if(a[f]==a[(f+1)%3]){h.push(e);break}}else if(d instanceof b.qa){d.r=l[d.r];d.h=l[d.h];d.t=l[d.t];d.oa=l[d.oa];a=[d.r,d.h,d.t,d.oa];m=-1;for(f=0;4>f;f++)a[f]==a[(f+1)%4]&&(0<=m&&h.push(e),m=f);if(0<=m){a.splice(m,1);var q=new b.S(a[0],a[1],a[2],d.s,d.color,d.Ca);a=0;for(f=this.C.length;f>a;a++)(g=this.C[a][e])&&g.splice(m,1);d.G&&0<d.G.length&&(q.G=d.G,q.G.splice(m,1));d.m&&0<d.m.length&&(q.m=d.m,q.m.splice(m,1));this.j[e]=q}}for(e=h.length-
1;0<=e;e--)for(this.j.splice(e,1),a=0,f=this.C.length;f>a;a++)this.C[a].splice(e,1);e=this.c.length-k.length;return this.c=k,e},d:function(){for(var a=new b.H,e=this.c,c=0,d=e.length;d>c;c++)a.c.push(e[c].d());e=this.j;c=0;for(d=e.length;d>c;c++)a.j.push(e[c].d());e=this.C[0];c=0;for(d=e.length;d>c;c++){for(var f=e[c],g=[],h=0,k=f.length;k>h;h++)g.push(new b.i(f[h].x,f[h].y));a.C[0].push(g)}return a}};b.xo=0;b.ze=function(){this.id=b.xo++;this.attributes={};this.ji=!1;this.vn=[];this.Kb=this.Fc=null;
this.eh=!1;this.B=[]};b.ze.prototype={constructor:b.ze,addEventListener:b.P.prototype.addEventListener,eb:b.P.prototype.eb,removeEventListener:b.P.prototype.removeEventListener,dispatchEvent:b.P.prototype.dispatchEvent,ke:function(a){var e,c;if(this.attributes.position&&(e=this.attributes.position.b),this.attributes.s&&(c=this.attributes.s.b),void 0!==e&&(a.tn(e),this.Xa=!0),void 0!==c)(new b.Ad).We(a).tn(c),this.cr(),this.Sd=!0},Zh:function(){null===this.Fc&&(this.Fc=new b.ye);var a=this.attributes.position.b;
if(a){var e,c,d,f=this.Fc;3<=a.length&&(f.min.x=f.max.x=a[0],f.min.y=f.max.y=a[1],f.min.z=f.max.z=a[2]);for(var g=3,h=a.length;h>g;g+=3)e=a[g],c=a[g+1],d=a[g+2],e<f.min.x?f.min.x=e:e>f.max.x&&(f.max.x=e),c<f.min.y?f.min.y=c:c>f.max.y&&(f.max.y=c),d<f.min.z?f.min.z=d:d>f.max.z&&(f.max.z=d)}void 0!==a&&0!==a.length||(this.Fc.min.set(0,0,0),this.Fc.max.set(0,0,0))},$h:function(){null===this.Kb&&(this.Kb=new b.ee);var a=this.attributes.position.b;if(a){for(var e,c,d,f=0,g=0,h=a.length;h>g;g+=3)e=a[g],
c=a[g+1],d=a[g+2],e=e*e+c*c+d*d,e>f&&(f=e);this.Kb.Q=Math.sqrt(f)}},ne:function(){if(this.attributes.position){var a,e,c,d;a=this.attributes.position.b.length;if(void 0===this.attributes.s)this.attributes.s={vi:3,b:new Float32Array(a),ef:a};else for(a=0,e=this.attributes.s.b.length;e>a;a++)this.attributes.s.b[a]=0;var f,g,h,k,l,m,q=this.attributes.position.b,p=this.attributes.s.b,r=new b.a,v=new b.a,w=new b.a,u=new b.a,s=new b.a;if(this.attributes.index){var t=this.attributes.index.b,A=this.vn;c=
0;for(d=A.length;d>c;++c){e=A[c].start;f=A[c].count;var Q=A[c].index;a=e;for(e+=f;e>a;a+=3)f=Q+t[a],g=Q+t[a+1],h=Q+t[a+2],k=q[3*f],l=q[3*f+1],m=q[3*f+2],r.set(k,l,m),k=q[3*g],l=q[3*g+1],m=q[3*g+2],v.set(k,l,m),k=q[3*h],l=q[3*h+1],m=q[3*h+2],w.set(k,l,m),u.X(w,v),s.X(r,v),u.Id(s),p[3*f]+=u.x,p[3*f+1]+=u.y,p[3*f+2]+=u.z,p[3*g]+=u.x,p[3*g+1]+=u.y,p[3*g+2]+=u.z,p[3*h]+=u.x,p[3*h+1]+=u.y,p[3*h+2]+=u.z}}else for(a=0,e=q.length;e>a;a+=9)k=q[a],l=q[a+1],m=q[a+2],r.set(k,l,m),k=q[a+3],l=q[a+4],m=q[a+5],v.set(k,
l,m),k=q[a+6],l=q[a+7],m=q[a+8],w.set(k,l,m),u.X(w,v),s.X(r,v),u.Id(s),p[a]=u.x,p[a+1]=u.y,p[a+2]=u.z,p[a+3]=u.x,p[a+4]=u.y,p[a+5]=u.z,p[a+6]=u.x,p[a+7]=u.y,p[a+8]=u.z;this.cr();this.Sd=!0}},cr:function(){for(var a,b,c,d=this.attributes.s.b,f=0,g=d.length;g>f;f+=3)a=d[f],b=d[f+1],c=d[f+2],a=1/Math.sqrt(a*a+b*b+c*c),d[f]*=a,d[f+1]*=a,d[f+2]*=a},Wj:function(){function a(a,b,e){p=d[3*a];r=d[3*a+1];v=d[3*a+2];w=d[3*b];u=d[3*b+1];s=d[3*b+2];t=d[3*e];A=d[3*e+1];Q=d[3*e+2];O=g[2*a];P=g[2*a+1];I=g[2*b];F=
g[2*b+1];L=g[2*e];K=g[2*e+1];N=w-p;B=t-p;W=u-r;M=A-r;J=s-v;R=Q-v;U=I-O;Y=L-O;C=F-P;y=K-P;D=1/(U*y-Y*C);Ba.set((y*N-C*B)*D,(y*W-C*M)*D,(y*J-C*R)*D);wa.set((U*B-Y*N)*D,(U*M-Y*W)*D,(U*R-Y*J)*D);m[a].add(Ba);m[b].add(Ba);m[e].add(Ba);q[a].add(wa);q[b].add(wa);q[e].add(wa)}function e(a){Ca.x=f[3*a];Ca.y=f[3*a+1];Ca.z=f[3*a+2];V.copy(Ca);Aa=m[a];pa.copy(Aa);pa.sub(Ca.p(Ca.za(Aa))).normalize();fb.$b(V,Aa);n=fb.za(q[a]);da=0>n?-1:1;l[4*a]=pa.x;l[4*a+1]=pa.y;l[4*a+2]=pa.z;l[4*a+3]=da}if(void 0===this.attributes.index||
void 0===this.attributes.position||void 0===this.attributes.s||void 0===this.attributes.Pb)return console.warn("Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()"),void 0;var c=this.attributes.index.b,d=this.attributes.position.b,f=this.attributes.s.b,g=this.attributes.Pb.b,h=d.length/3;if(void 0===this.attributes.ej){var k=4*h;this.attributes.ej={vi:4,b:new Float32Array(k),ef:k}}for(var l=this.attributes.ej.b,m=[],q=[],k=0;h>k;k++)m[k]=new b.a,q[k]=new b.a;
var p,r,v,w,u,s,t,A,Q,O,P,I,F,L,K,N,B,W,M,J,R,U,Y,C,y,D,Z,ma,S,G,na,Ba=new b.a,wa=new b.a,ja=this.vn,k=0;for(ma=ja.length;ma>k;++k){Z=ja[k].start;S=ja[k].count;var eb=ja[k].index,h=Z;for(Z+=S;Z>h;h+=3)S=eb+c[h],G=eb+c[h+1],na=eb+c[h+2],a(S,G,na)}var da,Aa,n,pa=new b.a,fb=new b.a,Ca=new b.a,V=new b.a,k=0;for(ma=ja.length;ma>k;++k)for(Z=ja[k].start,S=ja[k].count,eb=ja[k].index,h=Z,Z+=S;Z>h;h+=3)S=eb+c[h],G=eb+c[h+1],na=eb+c[h+2],e(S),e(G),e(na);this.fj=this.eh=!0}};b.sc=function(){b.w.call(this);this.gb=
new b.K;this.wa=new b.K;this.or=new b.K};b.sc.prototype=Object.create(b.w.prototype);b.sc.prototype.ub=function(){var a=new b.K;return function(b){a.ub(this.position,b,this.vd);!0===this.jb?this.fa.Ni(a):this.rotation.On(a,this.Ue)}}();b.Hh=function(a,e,c,d,f,g){b.sc.call(this);this.left=a;this.right=e;this.top=c;this.bottom=d;this.Ja=void 0!==f?f:0.1;this.Ia=void 0!==g?g:2E3;this.og()};b.Hh.prototype=Object.create(b.sc.prototype);b.Hh.prototype.og=function(){this.wa.tx(this.left,this.right,this.top,
this.bottom,this.Ja,this.Ia)};b.uc=function(a,e,c,d){b.sc.call(this);this.kd=void 0!==a?a:50;this.Ig=void 0!==e?e:1;this.Ja=void 0!==c?c:0.1;this.Ia=void 0!==d?d:2E3;this.og()};b.uc.prototype=Object.create(b.sc.prototype);b.uc.prototype.og=function(){if(this.Pm){var a=this.Pm/this.jq,e=Math.tan(b.be.Rg(0.5*this.kd))*this.Ja,c=-e,d=a*c,a=Math.abs(a*e-d),c=Math.abs(e-c);this.wa.Pq(d+this.x*a/this.Pm,d+(this.x+this.width)*a/this.Pm,e-(this.y+this.height)*c/this.jq,e-this.y*c/this.jq,this.Ja,this.Ia)}else this.wa.ux(this.kd,
this.Ig,this.Ja,this.Ia)};b.Ga=function(a){b.w.call(this);this.color=new b.k(a)};b.Ga.prototype=Object.create(b.w.prototype);b.Ga.prototype.d=function(a){return void 0===a&&(a=new b.Ga),b.w.prototype.d.call(this,a),a.color.copy(this.color),a};b.qf=function(a){b.Ga.call(this,a)};b.qf.prototype=Object.create(b.Ga.prototype);b.qf.prototype.d=function(){var a=new b.qf;return b.Ga.prototype.d.call(this,a),a};b.Is=function(a,e){b.Ga.call(this,a);this.s=new b.a(0,-1,0);this.right=new b.a(1,0,0);this.ia=
void 0!==e?e:1;this.height=this.width=1;this.KB=1.5;this.bE=0.5;this.$F=0.1};b.Is.prototype=Object.create(b.Ga.prototype);b.Ib=function(a,e){b.Ga.call(this,a);this.position.set(0,1,0);this.target=new b.w;this.ia=void 0!==e?e:1;this.ff=this.Lb=!1;this.Ri=50;this.Qi=5E3;this.Tn=-500;this.Vn=this.Un=500;this.Sn=-500;this.kf=!1;this.th=0;this.lf=0.5;this.Si=this.Vi=512;this.Wn=!1;this.jz=new b.a(0,0,-1E3);this.hz=2;this.Mr=[0,0,0];this.kz=[512,512,512];this.iz=[512,512,512];this.Or=[-1,0.99,0.998];this.Nr=
[0.99,0.998,1];this.Tk=[];this.ig=this.se=this.Ti=this.gg=null};b.Ib.prototype=Object.create(b.Ga.prototype);b.Ib.prototype.d=function(){var a=new b.Ib;return b.Ga.prototype.d.call(this,a),a.target=this.target.d(),a.ia=this.ia,a.Lb=this.Lb,a.ff=this.ff,a};b.nj=function(a,e,c){b.Ga.call(this,a);this.position.set(0,100,0);this.qi=new b.k(e);this.ia=void 0!==c?c:1};b.nj.prototype=Object.create(b.Ga.prototype);b.nj.prototype.d=function(){var a=new b.Bd;return b.Ga.prototype.d.call(this,a),a.qi.copy(this.qi),
a.ia=this.ia,a};b.Bd=function(a,e,c){b.Ga.call(this,a);this.ia=void 0!==e?e:1;this.ha=void 0!==c?c:0};b.Bd.prototype=Object.create(b.Ga.prototype);b.Bd.prototype.d=function(){var a=new b.Bd;return b.Ga.prototype.d.call(this,a),a.ia=this.ia,a.ha=this.ha,a};b.Ee=function(a,e,c,d,f){b.Ga.call(this,a);this.position.set(0,1,0);this.target=new b.w;this.ia=void 0!==e?e:1;this.ha=void 0!==c?c:0;this.je=void 0!==d?d:Math.PI/3;this.Mm=void 0!==f?f:10;this.ff=this.Lb=!1;this.Ri=50;this.Qi=5E3;this.gz=50;this.kf=
!1;this.th=0;this.lf=0.5;this.Si=this.Vi=512;this.ig=this.se=this.Ti=this.gg=null};b.Ee.prototype=Object.create(b.Ga.prototype);b.Ee.prototype.d=function(){var a=new b.Ee;return b.Ga.prototype.d.call(this,a),a.target=this.target.d(),a.ia=this.ia,a.ha=this.ha,a.je=this.je,a.Mm=this.Mm,a.Lb=this.Lb,a.ff=this.ff,a};b.Af=function(a){this.YG=(this.JG=a)?b.Af.prototype.Hu():null;this.cy=Ia();this.by=Ia();this.ay=Ia()};b.Af.prototype={constructor:b.Af,crossOrigin:"anonymous",Hu:function(){var a=document.createElement("div");
return a.style.position="absolute",a.style.right="0px",a.style.top="0px",a.style.fontSize="0.8em",a.style.textAlign="left",a.style.background="rgba(0,0,0,0.25)",a.style.color="#fff",a.style.width="120px",a.style.padding="0.5em 0.5em 0.5em 0.5em",a.style.zIndex=1E3,a.innerHTML="Loading ...",a},eq:function(a){a=a.split("/");return a.pop(),(1>a.length?".":a.join("/"))+"/"},Fw:function(a,e){for(var c=[],d=0;d<a.length;++d)c[d]=b.Af.prototype.uv(a[d],e);return c},Sx:function(a){for(var e=0,c=a.length;c>
e;e++)if(a[e]instanceof b.Ra)return!0;return!1},uv:function(a,e){function c(a){a=Math.log(a)/Math.LN2;return Math.floor(a)==a}function d(a){a=Math.log(a)/Math.LN2;return Math.pow(2,Math.round(a))}function f(a,b){var e=new Image;e.onload=function(){if(c(this.width)&&c(this.height))a.R=this;else{var b=d(this.width),e=d(this.height);a.R.width=b;a.R.height=e;a.R.getContext("2d").drawImage(this,0,0,b,e)}a.ea=!0};e.crossOrigin=k.crossOrigin;e.src=b}function g(a,c,d,g,h,k,l){var m=/\.dds$/i.test(d),q=e+
"/"+d;if(m){var O=b.zd.Mq(q);a[c]=O}else O=document.createElement("canvas"),a[c]=new b.Vb(O);if(a[c].rz=d,g&&(a[c].repeat.set(g[0],g[1]),1!==g[0]&&(a[c].pc=b.ed),1!==g[1]&&(a[c].qc=b.ed)),h&&a[c].offset.set(h[0],h[1]),k)d={repeat:b.ed,Lx:b.Al},void 0!==d[k[0]]&&(a[c].pc=d[k[0]]),void 0!==d[k[1]]&&(a[c].qc=d[k[1]]);l&&(a[c].ic=l);m||f(a[c],q)}function h(a){return(255*a[0]<<16)+(255*a[1]<<8)+255*a[2]}var k=this,l="MeshLambertMaterial",m={color:15658734,opacity:1,map:null,Ta:null,wb:null,Xb:null,I:!1};
if(a.ua){var q=a.ua.toLowerCase();"phong"===q?l="MeshPhongMaterial":"basic"===q&&(l="MeshBasicMaterial")}(void 0!==a.Ha&&void 0!==b[a.Ha]&&(m.Ha=b[a.Ha]),(void 0!==a.U||1>a.opacity)&&(m.U=a.U),void 0!==a.Db&&(m.Db=a.Db),void 0!==a.Gc&&(m.Gc=a.Gc),void 0!==a.visible&&(m.visible=a.visible),void 0!==a.Nm&&(m.Kc=b.rf),void 0!==a.Se&&(m.Kc=b.dd),void 0!==a.I&&(m.I=a.I),void 0!==a.m&&("face"===a.m?m.m=b.vf:a.m&&(m.m=b.Fe)),a.nv?m.color=h(a.nv):a.Us&&(m.color=a.Us),a.ov&&(m.Lc=h(a.ov)),a.mv&&(m.ta=h(a.mv)),
a.fo&&(m.opacity=a.fo),a.sz&&(m.Jc=a.sz),a.zx&&e&&g(m,"map",a.zx,a.kE,a.jE,a.lE,a.iE),a.Ax&&e&&g(m,"lightMap",a.Ax,a.oE,a.nE,a.pE,a.mE),a.xx&&e&&g(m,"bumpMap",a.xx,a.gE,a.fE,a.hE,a.eE),a.Rq&&e&&g(m,"normalMap",a.Rq,a.tE,a.sE,a.uE,a.rE),a.Bx&&e&&g(m,"specularMap",a.Bx,a.xE,a.wE,a.yE,a.vE),a.yx&&(m.Lg=a.yx),a.Rq)?(l=b.yg.Hk,q=b.xc.d(l.N),q.cs.value=m.wb,a.Sq&&q.rs.value.set(a.Sq,a.Sq),m.map&&(q.bs.value=m.map,q.aq.value=!0),m.Qa&&(q.ds.value=m.Qa,q.bq.value=!0),m.Ta&&(q.$r.value=m.Ta,q.$p.value=!0),
q.qs.value.sd(m.color),q.us.value.sd(m.Lc),q.ps.value.sd(m.ta),q.ts.value=m.Jc,void 0!==m.opacity&&(q.ss.value=m.opacity),l=new b.Ra({L:l.L,O:l.O,N:q,fb:!0,D:!0}),m.U&&(l.U=!0)):l=new b[l](m);return void 0!==a.Vs&&(l.name=a.Vs),l}};b.tl=function(){this.crossOrigin=null};b.tl.prototype={constructor:b.tl,addEventListener:b.P.prototype.addEventListener,eb:b.P.prototype.eb,removeEventListener:b.P.prototype.removeEventListener,dispatchEvent:b.P.prototype.dispatchEvent,load:function(a,b){var c=this;void 0===
b&&(b=new Image);b.addEventListener("load",function(){c.dispatchEvent({type:"load",content:b})},!1);b.addEventListener("error",function(){c.dispatchEvent({type:"error",message:"Couldn't load URL ["+a+"]"})},!1);c.crossOrigin&&(b.crossOrigin=c.crossOrigin);b.src=a}};b.Ch=function(a){b.Af.call(this,a);this.withCredentials=!1};b.Ch.prototype=Object.create(b.Af.prototype);b.Ch.prototype.load=function(a,b,c){c=c&&"string"==typeof c?c:this.eq(a);this.fx(this,a,b,c)};b.Ch.prototype.fx=function(a,b,c,d){var f=
new XMLHttpRequest;f.onreadystatechange=function(){if(f.readyState===f.DONE)if(200===f.status||0===f.status)if(f.responseText){var g=JSON.parse(f.responseText),g=a.parse(g,d);c(g.l,g.ja)}else console.warn("THREE.JSONLoader: ["+b+"] seems to be unreachable or file there is empty");else console.error("THREE.JSONLoader: Couldn't load ["+b+"] ["+f.status+"]")};f.open("GET",b,!0);f.withCredentials=this.withCredentials;f.send(null)};b.Ch.prototype.parse=function(a,e){var c=new b.H,d=void 0!==a.scale?1/
a.scale:1;if(function(e){var d,h,k,l,m,q,p,r,v,w,u,s,t,A,Q,O,P,I,F,L,K,N,B,W=a.j;A=a.c;var M=a.Xf,J=a.Oa,R=0;for(d=0;d<a.pg.length;d++)a.pg[d].length&&R++;for(d=0;R>d;d++)c.jd[d]=[],c.C[d]=[];k=0;for(l=A.length;l>k;)d=new b.a,d.x=A[k++]*e,d.y=A[k++]*e,d.z=A[k++]*e,c.c.push(d);k=0;for(l=W.length;l>k;){if(w=W[k++],u=w&1,s=w&2,t=w&4,h=w&8,A=w&16,Q=w&32,O=w&64,P=w&128,u?(I=new b.qa,I.r=W[k++],I.h=W[k++],I.t=W[k++],I.oa=W[k++],m=4):(I=new b.S,I.r=W[k++],I.h=W[k++],I.t=W[k++],m=3),s&&(v=W[k++],I.Ca=v),
e=c.j.length,t)for(d=0;R>d;d++)K=a.pg[d],r=W[k++],B=K[2*r],r=K[2*r+1],c.jd[d][e]=new b.i(B,r);if(h)for(d=0;R>d;d++){K=a.pg[d];N=[];for(h=0;m>h;h++)r=W[k++],B=K[2*r],r=K[2*r+1],N[h]=new b.i(B,r);c.C[d][e]=N}if(A&&(p=3*W[k++],L=new b.a,L.x=M[p++],L.y=M[p++],L.z=M[p],I.s=L),Q)for(d=0;m>d;d++)p=3*W[k++],L=new b.a,L.x=M[p++],L.y=M[p++],L.z=M[p],I.G.push(L);if(O&&(q=W[k++],F=new b.k(J[q]),I.color=F),P)for(d=0;m>d;d++)q=W[k++],F=new b.k(J[q]),I.m.push(F);c.j.push(I)}}(d),function(){var e,d,h,k;if(a.of)for(e=
0,d=a.of.length;d>e;e+=2)h=a.of[e],k=a.of[e+1],c.of.push(new b.Rc(h,k,0,0));if(a.nf)for(e=0,d=a.nf.length;d>e;e+=2)h=a.nf[e],k=a.nf[e+1],c.nf.push(new b.Rc(h,k,0,0));c.ab=a.ab;c.Oj=a.Oj}(),function(e){if(void 0!==a.B){var d,h,k,l,m,q;d=0;for(h=a.B.length;h>d;d++)for(c.B[d]={},c.B[d].name=a.B[d].name,c.B[d].c=[],m=c.B[d].c,q=a.B[d].c,k=0,l=q.length;l>k;k+=3){var p=new b.a;p.x=q[k]*e;p.y=q[k+1]*e;p.z=q[k+2]*e;m.push(p)}}if(void 0!==a.cf)for(d=0,h=a.cf.length;h>d;d++)for(c.cf[d]={},c.cf[d].name=a.cf[d].name,
c.cf[d].Oa=[],l=c.cf[d].Oa,m=a.cf[d].Oa,e=0,k=m.length;k>e;e+=3)q=new b.k(16755200),q.Wa(m[e],m[e+1],m[e+2]),l.push(q)}(d),c.tb(),c.Yb(),void 0===a.ja)return{l:c};d=this.Fw(a.ja,e);return this.Sx(d)&&c.Wj(),{l:c,ja:d}};b.Eo=function(){function a(){c++;b.dispatchEvent({type:"progress",loaded:c,total:d});c===d&&b.dispatchEvent({type:"load"})}var b=this,c=0,d=0;this.add=function(b){d++;b.addEventListener("load",a,!1)}};b.Eo.prototype={constructor:b.Eo,addEventListener:b.P.prototype.addEventListener,
eb:b.P.prototype.eb,removeEventListener:b.P.prototype.removeEventListener,dispatchEvent:b.P.prototype.dispatchEvent};b.yo=Ia();b.yo.prototype={constructor:b.yo,addEventListener:b.P.prototype.addEventListener,eb:b.P.prototype.eb,removeEventListener:b.P.prototype.removeEventListener,dispatchEvent:b.P.prototype.dispatchEvent,load:function(a){var b=this,c=new XMLHttpRequest;c.addEventListener("load",function(a){a=b.parse(JSON.parse(a.target.responseText));b.dispatchEvent({type:"load",content:a})},!1);
c.addEventListener("progress",function(a){b.dispatchEvent({type:"progress",loaded:a.loaded,total:a.total})},!1);c.addEventListener("error",function(){b.dispatchEvent({type:"error",message:"Couldn't load URL ["+a+"]"})},!1);c.open("GET",a,!0);c.send(null)},parse:Ia()};b.Fo=Ia();b.Fo.prototype={constructor:b.Fo,addEventListener:b.P.prototype.addEventListener,eb:b.P.prototype.eb,removeEventListener:b.P.prototype.removeEventListener,dispatchEvent:b.P.prototype.dispatchEvent,load:function(a){var b=this,
c=new XMLHttpRequest;c.addEventListener("load",function(a){a=b.parse(JSON.parse(a.target.responseText));b.dispatchEvent({type:"load",content:a})},!1);c.addEventListener("progress",function(a){b.dispatchEvent({type:"progress",loaded:a.loaded,total:a.total})},!1);c.addEventListener("error",function(){b.dispatchEvent({type:"error",message:"Couldn't load URL ["+a+"]"})},!1);c.open("GET",a,!0);c.send(null)},parse:function(a){var e;switch(a.type){case "MeshBasicMaterial":e=new b.Za({color:a.color,opacity:a.opacity,
U:a.U,I:a.I});break;case "MeshLambertMaterial":e=new b.hc({color:a.color,ta:a.ta,Aa:a.Aa,opacity:a.opacity,U:a.U,I:a.I});break;case "MeshPhongMaterial":e=new b.qb({color:a.color,ta:a.ta,Aa:a.Aa,Lc:a.Lc,Jc:a.Jc,opacity:a.opacity,U:a.U,I:a.I});break;case "MeshNormalMaterial":e=new b.Ae({opacity:a.opacity,U:a.U,I:a.I});break;case "MeshDepthMaterial":e=new b.ce({opacity:a.opacity,U:a.U,I:a.I})}return e}};b.Jh=function(){this.cy=Ia();this.by=Ia();this.ay=Ia();this.AB=Ia();this.zB=Ia();this.Ve={};this.fh=
{};this.Cu(b.Ch)};b.Jh.prototype.constructor=b.Jh;b.Jh.prototype.load=function(a,b){var c=this,d=new XMLHttpRequest;d.onreadystatechange=function(){if(4===d.readyState)if(200===d.status||0===d.status){var f=JSON.parse(d.responseText);c.parse(f,b,a)}else console.error("THREE.SceneLoader: Couldn't load ["+a+"] ["+d.status+"]")};d.open("GET",a,!0);d.send(null)};b.Jh.prototype.Cu=function(a){this.Ve.ascii={Oq:a}};b.Jh.prototype.parse=function(a,e,c){function d(a){return function(){I-=a;p()}}function f(a,
b){return"relativeToHTML"==b?a:K+"/"+a}function g(){h(F.Ea,B.da)}function h(a,e){var c,d,g,k,l,p,q;for(q in e)if(void 0===F.da[q]){var y=e[q],n=null;if(y.type&&y.type in L.fh){if(void 0===y.ox){c={type:1,url:1,n:1,position:1,rotation:1,scale:1,visible:1,children:1,xa:1,ad:1,Rd:1,bf:1,duration:1};var u={},D;for(D in y)D in c||(u[D]=y[D]);v=F.ja[y.n];y.ox=!0;c=L.fh[y.type].Ak;c.options?c.load(f(y.url,B.jl),m(q,a,v,y)):c.load(f(y.url,B.jl),m(q,a,v,y),u)}}else if(void 0!==y.l){if(r=F.na[y.l]){var s=!1;
if(v=F.ja[y.n],s=v instanceof b.Ra,g=y.position,k=y.rotation,l=y.scale,c=y.ba,p=y.fa,y.n||(v=new b.gc(F.ck[y.l])),v instanceof b.gc&&0===v.ja.length&&(v=new b.gc(F.ck[y.l])),v instanceof b.gc)for(u=0;u<v.ja.length;u++)s=s||v.ja[u]instanceof b.Ra;s&&r.Wj();y.ad?n=new b.Ub(r,v):y.Rd?(n=new b.Eh(r,v),void 0!==y.duration&&(n.duration=y.duration),void 0!==y.time&&(n.time=y.time),void 0!==y.bf&&(n.bf=y.bf),v.sa&&r.qv()):n=new b.J(r,v);n.name=q;c?(n.Va=!1,n.ba.set(c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7],
c[8],c[9],c[10],c[11],c[12],c[13],c[14],c[15])):(n.position.set(g[0],g[1],g[2]),p?(n.fa.set(p[0],p[1],p[2],p[3]),n.jb=!0):n.rotation.set(k[0],k[1],k[2]),n.scale.set(l[0],l[1],l[2]));n.visible=y.visible;n.Lb=y.Lb;n.qh=y.qh;a.add(n);F.da[q]=n}}else"DirectionalLight"===y.type||"PointLight"===y.type||"AmbientLight"===y.type?(Q=void 0!==y.color?y.color:16777215,O=void 0!==y.ia?y.ia:1,"DirectionalLight"===y.type?(g=y.direction,A=new b.Ib(Q,O),A.position.set(g[0],g[1],g[2]),y.target&&(N.push({object:A,Iz:y.target}),
A.target=null)):"PointLight"===y.type?(g=y.position,d=y.ha,A=new b.Bd(Q,O,d),A.position.set(g[0],g[1],g[2])):"AmbientLight"===y.type&&(A=new b.qf(Q)),a.add(A),A.name=q,F.fb[q]=A,F.da[q]=A):"PerspectiveCamera"===y.type||"OrthographicCamera"===y.type?(g=y.position,k=y.rotation,p=y.fa,"PerspectiveCamera"===y.type?w=new b.uc(y.kd,y.Ig,y.Ja,y.Ia):"OrthographicCamera"===y.type&&(w=new b.Hh(y.left,y.right,y.top,y.bottom,y.Ja,y.Ia)),w.name=q,w.position.set(g[0],g[1],g[2]),void 0!==p?(w.fa.set(p[0],p[1],p[2],
p[3]),w.jb=!0):void 0!==k&&w.rotation.set(k[0],k[1],k[2]),a.add(w),F.Pe[q]=w,F.da[q]=w):(g=y.position,k=y.rotation,l=y.scale,p=y.fa,n=new b.w,n.name=q,n.position.set(g[0],g[1],g[2]),p?(n.fa.set(p[0],p[1],p[2],p[3]),n.jb=!0):n.rotation.set(k[0],k[1],k[2]),n.scale.set(l[0],l[1],l[2]),n.visible=void 0!==y.visible?y.visible:!1,a.add(n),F.da[q]=n,F.Iv[q]=n);if(n){if(void 0!==y.xa)for(var t in y.xa)n.xa[t]=y.xa[t];if(void 0!==y.dh)for(u=0;u<y.dh.length;u++)c=y.dh[u],void 0===F.dh[c]&&(F.dh[c]=[]),F.dh[c].push(q);
void 0!==y.children&&h(n,y.children)}}}function k(a,b,c,e,d){var f=d.position,h=d.rotation,k=d.fa,l=d.scale;a.position.set(f[0],f[1],f[2]);k?(a.fa.set(k[0],k[1],k[2],k[3]),a.jb=!0):a.rotation.set(h[0],h[1],h[2]);a.scale.set(l[0],l[1],l[2]);e&&a.ho(function(a){a.n=e});var m=void 0!==d.visible?d.visible:!0;a.ho(function(a){a.visible=m});c.add(a);a.name=b;F.da[b]=a;g()}function l(a){return function(b,c){b.name=a;F.na[a]=b;F.ck[a]=c;g();P-=1;p()}}function m(a,b,c,e){return function(d){k(d.content?d.content:
d.wm?d.Ea:d,a,b,c,e);P-=1;p()}}function q(a){return function(b,c){b.name=a;F.na[a]=b;F.ck[a]=c}}function p(){if(0===P&&0===I){for(var a=0;a<N.length;a++){var c=N[a],d=F.da[c.Iz];d?c.object.target=d:(c.object.target=new b.w,F.Ea.add(c.object.target));c.object.target.xa.kH=c.object}e(F)}}var r,v,w,u,s,t,A,Q,O,P,I,F,L=this,K=b.Af.prototype.eq(c),N=[],B=a;for(t in this.Ve)a=this.Ve[t].Oq,this.Ve[t].Ak=new a;for(t in this.fh)a=this.fh[t].Oq,this.fh[t].Ak=new a;if(P=0,I=0,F={Ea:new b.Cf,na:{},ck:{},ja:{},
ka:{},da:{},Pe:{},fb:{},mi:{},Iv:{},dh:{}},B.transform)t=B.transform.position,a=B.transform.rotation,c=B.transform.scale,t&&F.Ea.position.set(t[0],t[1],t[2]),a&&F.Ea.rotation.set(a[0],a[1],a[2]),c&&F.Ea.scale.set(c[0],c[1],c[2]),(t||a||c)&&(F.Ea.Nc(),F.Ea.fc());for(var W in B.mi)t=B.mi[W],"linear"===t.type?u=new b.Bh(0,t.Ja,t.Ia):"exp2"===t.type&&(u=new b.xf(0,t.$j)),t=t.color,u.color.Wa(t[0],t[1],t[2]),F.mi[W]=u;var M,J;for(M in B.na)J=B.na[M],J.type in this.Ve&&(P+=1);for(var R in B.da)u=B.da[R],
u.type&&u.type in this.fh&&(P+=1);for(M in B.na)if(J=B.na[M],"cube"===J.type)r=new b.rl(J.width,J.height,J.depth,J.pf,J.Md,J.Bm),r.name=M,F.na[M]=r;else if("plane"===J.type)r=new b.Cl(J.width,J.height,J.pf,J.Md),r.name=M,F.na[M]=r;else if("sphere"===J.type)r=new b.Qc(J.Q,J.pf,J.Md),r.name=M,F.na[M]=r;else if("cylinder"===J.type)r=new b.mj(J.vH,J.sB,J.height,J.aG,J.hD),r.name=M,F.na[M]=r;else if("torus"===J.type)r=new b.bp(J.Q,J.ng,J.xG,J.yG),r.name=M,F.na[M]=r;else if("icosahedron"===J.type)r=new b.Ao(J.Q,
J.aH),r.name=M,F.na[M]=r;else if(J.type in this.Ve){R={};for(var U in J)"type"!==U&&"url"!==U&&(R[U]=J[U]);this.Ve[J.type].Ak.load(f(J.url,B.jl),l(M),R)}else"embedded"===J.type&&(R=B.embeds[J.id],R.Ix=B.Ix,R)&&(R=this.Ve.fB.Ak.parse(R,""),q(M)(R.l,R.ja));var Y,C;for(Y in B.ka)if(C=B.ka[Y],C.url instanceof Array)for(I+=C.url.length,M=0;M<C.url.length;M++);else I+=1;for(Y in B.ka){if(C=B.ka[Y],void 0!==C.Nb&&void 0!==b[C.Nb]&&(C.Nb=new b[C.Nb]),C.url instanceof Array){s=C.url.length;J=[];for(M=0;s>
M;M++)J[M]=f(C.url[M],B.jl);s=(M=/\.dds$/i.test(J[0]))?b.zd.hx(J,C.Nb,d(s)):b.zd.mx(J,C.Nb,d(s))}else if(M=/\.dds$/i.test(C.url),J=f(C.url,B.jl),U=d(1),s=M?b.zd.Mq(J,C.Nb,U):b.zd.gn(J,C.Nb,U),void 0!==b[C.nb]&&(s.nb=b[C.nb]),void 0!==b[C.Gb]&&(s.Gb=b[C.Gb]),C.ic&&(s.ic=C.ic),C.repeat&&(s.repeat.set(C.repeat[0],C.repeat[1]),1!==C.repeat[0]&&(s.pc=b.ed),1!==C.repeat[1]&&(s.qc=b.ed)),C.offset&&s.offset.set(C.offset[0],C.offset[1]),C.ij)M={repeat:b.ed,Lx:b.Al},void 0!==M[C.ij[0]]&&(s.pc=M[C.ij[0]]),void 0!==
M[C.ij[1]]&&(s.qc=M[C.ij[1]]);F.ka[Y]=s}var y,D,Z;for(y in B.ja){D=B.ja[y];for(Z in D.F)"envMap"===Z||"map"===Z||"lightMap"===Z||"bumpMap"===Z?D.F[Z]=F.ka[D.F[Z]]:"shading"===Z?D.F[Z]="flat"===D.F[Z]?b.wf:b.wc:"side"===Z?D.F[Z]="double"==D.F[Z]?b.dd:"back"==D.F[Z]?b.rf:b.vg:"blending"===Z?D.F[Z]=D.F[Z]in b?b[D.F[Z]]:b.Gh:"combine"===Z?D.F[Z]=D.F[Z]in b?b[D.F[Z]]:b.rj:"vertexColors"===Z?"face"==D.F[Z]?D.F[Z]=b.vf:D.F[Z]&&(D.F[Z]=b.Fe):"wrapRGB"===Z&&(Y=D.F[Z],D.F[Z]=new b.a(Y[0],Y[1],Y[2]));(void 0!==
D.F.opacity&&1>D.F.opacity&&(D.F.U=!0),D.F.wb)?(Y=b.yg.Hk,C=b.xc.d(Y.N),s=D.F.color,M=D.F.Lc,J=D.F.ta,U=D.F.Jc,C.cs.value=F.ka[D.F.wb],D.F.df&&C.rs.value.set(D.F.df[0],D.F.df[1]),D.F.map&&(C.bs.value=D.F.map,C.aq.value=!0),D.F.pa&&(C.as.value=D.F.pa,C.Kv.value=!0,C.Uz.value=D.F.Yc),D.F.Ta&&(C.$r.value=D.F.Ta,C.$p.value=!0),D.F.Qa&&(C.ds.value=F.ka[D.F.Qa],C.bq.value=!0),D.F.Fv&&(C.Hz.value=F.ka[D.F.Fv],C.Jv.value=!0,C.Sz.value=D.F.vC,C.Tz.value=D.F.wC),C.qs.value.sd(s),C.us.value.sd(M),C.ps.value.sd(J),
C.ts.value=U,D.F.opacity&&(C.ss.value=D.F.opacity),v=new b.Ra({L:Y.L,O:Y.O,N:C,fb:!0,D:!0})):v=new b[D.type](D.F);v.name=y;F.ja[y]=v}for(y in B.ja)if(D=B.ja[y],D.F.ja){Z=[];for(M=0;M<D.F.ja.length;M++)Z.push(F.ja[D.F.ja[M]]);F.ja[y].ja=Z}g();F.Pe&&B.fi.Cb&&(F.SB=F.Pe[B.fi.Cb]);F.mi&&B.fi.D&&(F.Ea.D=F.mi[B.fi.D]);p()};b.ap=function(){this.crossOrigin=null};b.ap.prototype={constructor:b.ap,addEventListener:b.P.prototype.addEventListener,eb:b.P.prototype.eb,removeEventListener:b.P.prototype.removeEventListener,
dispatchEvent:b.P.prototype.dispatchEvent,load:function(a){var e=this,c=new Image;c.addEventListener("load",function(){var a=new b.Vb(c);a.ea=!0;e.dispatchEvent({type:"load",content:a})},!1);c.addEventListener("error",function(){e.dispatchEvent({type:"error",message:"Couldn't load URL ["+a+"]"})},!1);e.crossOrigin&&(c.crossOrigin=e.crossOrigin);c.src=a}};b.Y=function(){this.id=b.ht++;this.name="";this.Kc=b.vg;this.opacity=1;this.U=!1;this.Ha=b.Gh;this.Kf=b.Zo;this.Jf=b.Io;this.blendEquation=b.oo;
this.Gc=this.Db=!0;this.polygonOffset=!1;this.Dc=this.Ii=this.Hi=0;this.Jk=!1;this.ea=this.visible=!0};b.Y.prototype={constructor:b.Y,addEventListener:b.P.prototype.addEventListener,eb:b.P.prototype.eb,removeEventListener:b.P.prototype.removeEventListener,dispatchEvent:b.P.prototype.dispatchEvent,td:function(a){if(void 0!==a)for(var e in a){var c=a[e];if(void 0!==c){if(e in this){var d=this[e];d instanceof b.k?d.set(c):d instanceof b.a&&c instanceof b.a?d.copy(c):this[e]=c}}else console.warn("THREE.Material: '"+
e+"' parameter is undefined.")}},d:function(a){return void 0===a&&(a=new b.Y),a.name=this.name,a.Kc=this.Kc,a.opacity=this.opacity,a.U=this.U,a.Ha=this.Ha,a.Kf=this.Kf,a.Jf=this.Jf,a.blendEquation=this.blendEquation,a.Db=this.Db,a.Gc=this.Gc,a.polygonOffset=this.polygonOffset,a.Hi=this.Hi,a.Ii=this.Ii,a.Dc=this.Dc,a.Jk=this.Jk,a.visible=this.visible,a}};b.ht=0;b.Pc=function(a){b.Y.call(this);this.color=new b.k(16777215);this.Xc=1;this.zk=this.yk="round";this.m=!1;this.D=!0;this.td(a)};b.Pc.prototype=
Object.create(b.Y.prototype);b.Pc.prototype.d=function(){var a=new b.Pc;return b.Y.prototype.d.call(this,a),a.color.copy(this.color),a.Xc=this.Xc,a.yk=this.yk,a.zk=this.zk,a.m=this.m,a.D=this.D,a};b.zf=function(a){b.Y.call(this);this.color=new b.k(16777215);this.scale=this.Xc=1;this.Qe=3;this.ni=1;this.m=!1;this.D=!0;this.td(a)};b.zf.prototype=Object.create(b.Y.prototype);b.zf.prototype.d=function(){var a=new b.zf;return b.Y.prototype.d.call(this,a),a.color.copy(this.color),a.Xc=this.Xc,a.scale=this.scale,
a.Qe=this.Qe,a.ni=this.ni,a.m=this.m,a.D=this.D,a};b.Za=function(a){b.Y.call(this);this.color=new b.k(16777215);this.pa=this.Qa=this.Ta=this.map=null;this.Uc=b.rj;this.Yc=1;this.Zc=0.98;this.D=!0;this.ua=b.wc;this.I=!1;this.Fa=1;this.oc=this.nc="round";this.m=b.Fh;this.B=this.Ka=!1;this.td(a)};b.Za.prototype=Object.create(b.Y.prototype);b.Za.prototype.d=function(){var a=new b.Za;return b.Y.prototype.d.call(this,a),a.color.copy(this.color),a.map=this.map,a.Ta=this.Ta,a.Qa=this.Qa,a.pa=this.pa,a.Uc=
this.Uc,a.Yc=this.Yc,a.Zc=this.Zc,a.D=this.D,a.ua=this.ua,a.I=this.I,a.Fa=this.Fa,a.nc=this.nc,a.oc=this.oc,a.m=this.m,a.Ka=this.Ka,a.B=this.B,a};b.hc=function(a){b.Y.call(this);this.color=new b.k(16777215);this.ta=new b.k(16777215);this.Aa=new b.k(0);this.yd=!1;this.cd=new b.a(1,1,1);this.pa=this.Qa=this.Ta=this.map=null;this.Uc=b.rj;this.Yc=1;this.Zc=0.98;this.D=!0;this.ua=b.wc;this.I=!1;this.Fa=1;this.oc=this.nc="round";this.m=b.Fh;this.sa=this.B=this.Ka=!1;this.td(a)};b.hc.prototype=Object.create(b.Y.prototype);
b.hc.prototype.d=function(){var a=new b.hc;return b.Y.prototype.d.call(this,a),a.color.copy(this.color),a.ta.copy(this.ta),a.Aa.copy(this.Aa),a.yd=this.yd,a.cd.copy(this.cd),a.map=this.map,a.Ta=this.Ta,a.Qa=this.Qa,a.pa=this.pa,a.Uc=this.Uc,a.Yc=this.Yc,a.Zc=this.Zc,a.D=this.D,a.ua=this.ua,a.I=this.I,a.Fa=this.Fa,a.nc=this.nc,a.oc=this.oc,a.m=this.m,a.Ka=this.Ka,a.B=this.B,a.sa=this.sa,a};b.qb=function(a){b.Y.call(this);this.color=new b.k(16777215);this.ta=new b.k(16777215);this.Aa=new b.k(0);this.Lc=
new b.k(1118481);this.Jc=30;this.Ai=!1;this.nh=!0;this.yd=!1;this.cd=new b.a(1,1,1);this.Xb=this.Ta=this.map=null;this.Lg=1;this.wb=null;this.df=new b.i(1,1);this.pa=this.Qa=null;this.Uc=b.rj;this.Yc=1;this.Zc=0.98;this.D=!0;this.ua=b.wc;this.I=!1;this.Fa=1;this.oc=this.nc="round";this.m=b.Fh;this.sa=this.B=this.Ka=!1;this.td(a)};b.qb.prototype=Object.create(b.Y.prototype);b.qb.prototype.d=function(){var a=new b.qb;return b.Y.prototype.d.call(this,a),a.color.copy(this.color),a.ta.copy(this.ta),a.Aa.copy(this.Aa),
a.Lc.copy(this.Lc),a.Jc=this.Jc,a.Ai=this.Ai,a.nh=this.nh,a.yd=this.yd,a.cd.copy(this.cd),a.map=this.map,a.Ta=this.Ta,a.Xb=this.Xb,a.Lg=this.Lg,a.wb=this.wb,a.df.copy(this.df),a.Qa=this.Qa,a.pa=this.pa,a.Uc=this.Uc,a.Yc=this.Yc,a.Zc=this.Zc,a.D=this.D,a.ua=this.ua,a.I=this.I,a.Fa=this.Fa,a.nc=this.nc,a.oc=this.oc,a.m=this.m,a.Ka=this.Ka,a.B=this.B,a.sa=this.sa,a};b.ce=function(a){b.Y.call(this);this.I=!1;this.Fa=1;this.td(a)};b.ce.prototype=Object.create(b.Y.prototype);b.ce.prototype.d=function(){var a=
new b.ce;return b.Y.prototype.d.call(this,a),a.I=this.I,a.Fa=this.Fa,a};b.Ae=function(a){b.Y.call(this);this.ua=b.wf;this.I=!1;this.Fa=1;this.B=!1;this.td(a)};b.Ae.prototype=Object.create(b.Y.prototype);b.Ae.prototype.d=function(){var a=new b.Ae;return b.Y.prototype.d.call(this,a),a.ua=this.ua,a.I=this.I,a.Fa=this.Fa,a};b.gc=function(a){this.ja=a instanceof Array?a:[]};b.gc.prototype.d=function(){return new b.gc(this.ja.slice(0))};b.Ce=function(a){b.Y.call(this);this.color=new b.k(16777215);this.map=
null;this.size=1;this.ec=!0;this.m=!1;this.D=!0;this.td(a)};b.Ce.prototype=Object.create(b.Y.prototype);b.Ce.prototype.d=function(){var a=new b.Ce;return b.Y.prototype.d.call(this,a),a.color.copy(this.color),a.map=this.map,a.size=this.size,a.ec=this.ec,a.m=this.m,a.D=this.D,a};b.sj=function(a){b.Y.call(this);this.color=new b.k(16777215);this.Ob=Ia();this.td(a)};b.sj.prototype=Object.create(b.Y.prototype);b.sj.prototype.d=function(){var a=new b.sj;return b.Y.prototype.d.call(this,a),a.color.copy(this.color),
a.Ob=this.Ob,a};b.Ra=function(a){b.Y.call(this);this.O=this.L="void main() {}";this.N={};this.zm={};this.attributes=null;this.ua=b.wc;this.Xc=1;this.I=!1;this.Fa=1;this.fb=this.D=!1;this.m=b.Fh;this.sa=this.B=this.Ka=!1;this.td(a)};b.Ra.prototype=Object.create(b.Y.prototype);b.Ra.prototype.d=function(){var a=new b.Ra;return b.Y.prototype.d.call(this,a),a.L=this.L,a.O=this.O,a.N=b.xc.d(this.N),a.attributes=this.attributes,a.zm=this.zm,a.ua=this.ua,a.I=this.I,a.Fa=this.Fa,a.D=this.D,a.fb=this.fb,a.m=
this.m,a.Ka=this.Ka,a.B=this.B,a.sa=this.sa,a};b.wj=function(a){b.Y.call(this);this.color=new b.k(16777215);this.map=new b.Vb;this.wd=!0;this.Db=!this.wd;this.ec=!this.wd;this.Li=!this.ec;this.Gg=b.Cd.bb.d();this.D=!1;this.xh=new b.i(0,0);this.yh=new b.i(1,1);this.td(a);a=a||{};void 0===a.Db&&(this.Db=!this.wd);void 0===a.ec&&(this.ec=!this.wd);void 0===a.Li&&(this.Li=!this.ec)};b.wj.prototype=Object.create(b.Y.prototype);b.wj.prototype.d=function(){var a=new b.wj;return b.Y.prototype.d.call(this,
a),a.color.copy(this.color),a.map=this.map,a.wd=this.wd,a.ec=this.ec,a.Li=this.Li,a.Gg.copy(this.Gg),a.xh.copy(this.xh),a.yh.copy(this.yh),a.D=this.D,a};b.Cd={};b.Cd.uH=new b.i(1,-1);b.Cd.tH=new b.i(0,-1);b.Cd.wH=new b.i(-1,-1);b.Cd.CB=new b.i(1,0);b.Cd.bb=new b.i(0,0);b.Cd.DB=new b.i(-1,0);b.Cd.uB=new b.i(1,1);b.Cd.tB=new b.i(0,1);b.Cd.vB=new b.i(-1,1);b.Vb=function(a,e,c,d,f,g,h,k,l){this.id=b.Ft++;this.name="";this.R=a;this.dc=[];this.Nb=void 0!==e?e:new b.cp;this.pc=void 0!==c?c:b.sf;this.qc=
void 0!==d?d:b.sf;this.Gb=void 0!==f?f:b.ae;this.nb=void 0!==g?g:b.yl;this.ic=void 0!==l?l:1;this.ma=void 0!==h?h:b.Bf;this.type=void 0!==k?k:b.Ll;this.offset=new b.i(0,0);this.repeat=new b.i(1,1);this.Eb=!0;this.Gn=!1;this.Nf=!0;this.jo=4;this.ea=!1;this.Ik=null};b.Vb.prototype={constructor:b.Vb,addEventListener:b.P.prototype.addEventListener,eb:b.P.prototype.eb,removeEventListener:b.P.prototype.removeEventListener,dispatchEvent:b.P.prototype.dispatchEvent,d:function(a){return void 0===a&&(a=new b.Vb),
a.R=this.R,a.dc=this.dc.slice(0),a.Nb=this.Nb,a.pc=this.pc,a.qc=this.qc,a.Gb=this.Gb,a.nb=this.nb,a.ic=this.ic,a.ma=this.ma,a.type=this.type,a.offset.copy(this.offset),a.repeat.copy(this.repeat),a.Eb=this.Eb,a.Gn=this.Gn,a.Nf=this.Nf,a.jo=this.jo,a}};b.Ft=0;b.tf=function(a,e,c,d,f,g,h,k,l,m,q){b.Vb.call(this,null,g,h,k,l,m,d,f,q);this.R={width:e,height:c};this.dc=a;this.Eb=!1};b.tf.prototype=Object.create(b.Vb.prototype);b.tf.prototype.d=function(){var a=new b.tf;return b.Vb.prototype.d.call(this,
a),a};b.uf=function(a,e,c,d,f,g,h,k,l,m,q){b.Vb.call(this,null,g,h,k,l,m,d,f,q);this.R={data:a,width:e,height:c}};b.uf.prototype=Object.create(b.Vb.prototype);b.uf.prototype.d=function(){var a=new b.uf;return b.Vb.prototype.d.call(this,a),a};b.Ih=function(a){b.w.call(this);this.n=a};b.Ih.prototype=Object.create(b.w.prototype);b.Ih.prototype.d=function(a){return void 0===a&&(a=new b.Ih(this.n)),b.w.prototype.d.call(this,a),a};b.Tb=function(a,e){b.w.call(this);this.l=a;this.n=void 0!==e?e:new b.Ce({color:16777215*
Math.random()});this.jg=!1;this.l&&null===this.l.Kb&&this.l.$h();this.Of=!1};b.Tb.prototype=Object.create(b.w.prototype);b.Tb.prototype.d=function(a){return void 0===a&&(a=new b.Tb(this.l,this.n)),a.jg=this.jg,b.w.prototype.d.call(this,a),a};b.Na=function(a,e,c){b.w.call(this);this.l=a;this.n=void 0!==e?e:new b.Pc({color:16777215*Math.random()});this.type=void 0!==c?c:b.Do;this.l&&(this.l.Kb||this.l.$h())};b.Do=0;b.Dh=1;b.Na.prototype=Object.create(b.w.prototype);b.Na.prototype.d=function(a){return void 0===
a&&(a=new b.Na(this.l,this.n,this.type)),b.w.prototype.d.call(this,a),a};b.J=function(a,e){b.w.call(this);this.n=this.l=null;this.az(a);this.cz(e)};b.J.prototype=Object.create(b.w.prototype);b.J.prototype.az=function(a){void 0!==a&&(this.l=a,null===this.l.Kb&&this.l.$h(),this.Wz())};b.J.prototype.cz=function(a){this.n=void 0!==a?a:new b.Za({color:16777215*Math.random(),I:!0})};b.J.prototype.Wz=function(){if(0<this.l.B.length){this.pn=-1;this.ar=[];this.md=[];this.Ox={};for(var a=0,b=this.l.B.length;b>
a;a++)this.md.push(0),this.Ox[this.l.B[a].name]=a}};b.J.prototype.d=function(a){return void 0===a&&(a=new b.J(this.l,this.n)),b.w.prototype.d.call(this,a),a};b.Zd=function(a){b.w.call(this);this.ad=a;this.Wd=new b.K};b.Zd.prototype=Object.create(b.w.prototype);b.Zd.prototype.update=function(a,b){this.Va&&(b|=this.Nc());(b||this.vb)&&(a?this.Wd.Da(a,this.ba):this.Wd.copy(this.ba),this.vb=!1,b=!0);var c,d=this.children.length;for(c=0;d>c;c++)this.children[c].update(this.Wd,b)};b.Ub=function(a,e,c){b.J.call(this,
a,e);this.te=void 0!==c?c:!0;this.Cw=new b.K;this.ab=[];this.Ph=[];var d,f,g;if(this.l&&void 0!==this.l.ab){for(a=0;a<this.l.ab.length;a++)c=this.l.ab[a],d=c.kr,f=c.pG,g=c.uG,e=this.Bu(),e.name=c.name,e.position.set(d[0],d[1],d[2]),e.fa.set(f[0],f[1],f[2],f[3]),e.jb=!0,void 0!==g?e.scale.set(g[0],g[1],g[2]):e.scale.set(1,1,1);for(a=0;a<this.ab.length;a++)c=this.l.ab[a],e=this.ab[a],-1===c.parent?this.add(e):this.ab[c.parent].add(e);a=this.ab.length;this.te?(this.Jg=this.Kg=a=256<a?64:64<a?32:16<a?
16:8,this.Ph=new Float32Array(4*this.Kg*this.Jg),this.Ne=new b.uf(this.Ph,this.Kg,this.Jg,b.Bf,b.sl),this.Ne.nb=b.Be,this.Ne.Gb=b.Be,this.Ne.Eb=!1,this.Ne.Nf=!1):this.Ph=new Float32Array(16*a);this.vy()}};b.Ub.prototype=Object.create(b.J.prototype);b.Ub.prototype.Bu=function(){var a;return void 0===a&&(a=new b.Zd(this)),this.ab.push(a),a};b.Ub.prototype.fc=function(a){this.Va&&this.Nc();(this.vb||a)&&(this.parent?this.A.Da(this.parent.A,this.ba):this.A.copy(this.ba),this.vb=!1);a=0;for(var e=this.children.length;e>
a;a++){var c=this.children[a];c instanceof b.Zd?c.update(this.Cw,!1):c.fc(!0)}if(void 0==this.nm)for(this.nm=[],a=0,e=this.ab.length;e>a;a++)c=new b.K,c.Ld(this.ab[a].Wd),this.nm.push(c);a=0;for(e=this.ab.length;e>a;a++)b.Ub.fr.Da(this.ab[a].Wd,this.nm[a]),b.Ub.fr.hq(this.Ph,16*a);this.te&&(this.Ne.ea=!0)};b.Ub.prototype.vy=function(){this.fc(!0);for(var a=0;a<this.l.nf.length;a++){var b=this.l.of[a],c=1/b.Iq();1/0!==c?b.p(c):b.set(1)}};b.Ub.prototype.d=function(a){return void 0===a&&(a=new b.Ub(this.l,
this.n,this.te)),b.J.prototype.d.call(this,a),a};b.Ub.fr=new b.K;b.Eh=function(a,e){b.J.call(this,a,e);this.duration=1E3;this.bf=!1;this.Sp=this.Hq=this.time=0;this.direction=1;this.Sg=!1;this.Yy(this.l.B.length-1)};b.Eh.prototype=Object.create(b.J.prototype);b.Eh.prototype.Yy=function(a){this.Bz=0;this.Lv=a;this.length=this.Lv-this.Bz+1};b.Eh.prototype.d=function(a){return void 0===a&&(a=new b.Eh(this.l,this.n)),a.duration=this.duration,a.bf=this.bf,a.time=this.time,a.Hq=this.Hq,a.Sp=this.Sp,a.direction=
this.direction,a.Sg=this.Sg,b.J.prototype.d.call(this,a),a};b.De=function(a,e){b.w.call(this);this.l=a;this.n=e};b.De.prototype=Object.create(b.w.prototype);b.De.prototype.d=function(a){return void 0===a&&(a=new b.De(this.l,this.n)),b.w.prototype.d.call(this,a),a};b.wl=function(){b.w.call(this);this.da=[]};b.wl.prototype=Object.create(b.w.prototype);b.wl.prototype.update=function(){var a=new b.a,e=new b.a;return function(b){if(1<this.da.length){a.lb(b.A);e.lb(this.A);b=a.gd(e);this.da[0].object.visible=
!0;for(var d=1,f=this.da.length;f>d&&b>=this.da[d].ha;d++)this.da[d-1].object.visible=!1,this.da[d].object.visible=!0;for(;f>d;d++)this.da[d].object.visible=!1}}}();b.wl.prototype.d=Ia();b.Df=function(a){b.w.call(this);this.n=void 0!==a?a:new b.wj;this.vr=this.rotation;this.rotation=0};b.Df.prototype=Object.create(b.w.prototype);b.Df.prototype.Nc=function(){this.vr.set(0,0,this.rotation);this.fa.Fr(this.vr,this.Ue);this.ba.Bk(this.position,this.fa,this.scale);this.vb=!0};b.Df.prototype.d=function(a){return void 0===
a&&(a=new b.Df(this.n)),b.w.prototype.d.call(this,a),a};b.Cf=function(){b.w.call(this);this.Kk=this.D=null;this.Rj=!0;this.Va=!1;this.zj=[];this.yc=[];this.zg=[];this.Ag=[]};b.Cf.prototype=Object.create(b.w.prototype);b.Cf.prototype.ep=function(a){if(a instanceof b.Ga)-1===this.yc.indexOf(a)&&this.yc.push(a),a.target&&void 0===a.target.parent&&this.add(a.target);else if(!(a instanceof b.sc||a instanceof b.Zd)&&-1===this.zj.indexOf(a)){this.zj.push(a);this.zg.push(a);var e=this.Ag.indexOf(a);-1!==
e&&this.Ag.splice(e,1)}for(e=0;e<a.children.length;e++)this.ep(a.children[e])};b.Cf.prototype.kp=function(a){if(a instanceof b.Ga){var e=this.yc.indexOf(a);-1!==e&&this.yc.splice(e,1)}else a instanceof b.sc||(e=this.zj.indexOf(a),-1!==e&&(this.zj.splice(e,1),this.Ag.push(a),e=this.zg.indexOf(a),-1!==e&&this.zg.splice(e,1)));for(e=0;e<a.children.length;e++)this.kp(a.children[e])};b.Bh=function(a,e,c){this.name="";this.color=new b.k(a);this.Ja=void 0!==e?e:1;this.Ia=void 0!==c?c:1E3};b.Bh.prototype.d=
function(){return new b.Bh(this.color.nk(),this.Ja,this.Ia)};b.xf=function(a,e){this.name="";this.color=new b.k(a);this.$j=void 0!==e?e:2.5E-4};b.xf.prototype.d=function(){return new b.xf(this.color.nk(),this.$j)};b.mA=function(a){function e(a){ra!==a&&(V.globalAlpha=a,ra=a)}function c(a){ea!==a&&(a===b.Gh?V.globalCompositeOperation="source-over":a===b.yb?V.globalCompositeOperation="lighter":a===b.$o&&(V.globalCompositeOperation="darker"),ea=a)}function d(a){la!==a&&(V.lineWidth=a,la=a)}function f(a){va!==
a&&(V.lineCap=a,va=a)}function g(a){Oa!==a&&(V.lineJoin=a,Oa=a)}function h(a){ha!==a&&(V.strokeStyle=a,ha=a)}function k(a){$a!==a&&(V.fillStyle=a,$a=a)}function l(a,b){(ka!==a||Pa!==b)&&(V.setLineDash([a,b]),ka=a,Pa=b)}console.log("THREE.CanvasRenderer",b.El);var m=b.be.oz;a=a||{};var q,p,r,v,w,u,s,t,A,Q,O,P,I,F,L,K,N,B,W,M,J,R,U,Y,C,y,D,Z,ma,S,G,na,Ba,wa,ja,eb,da,Aa,n,pa=this,fb=new b.Dl,Ca=void 0!==a.canvas?a.canvas:document.createElement("canvas"),V=Ca.getContext("2d"),T=new b.k(0),Ga=0,ra=1,ea=
0,ha=null,$a=null,la=null,va=null,Oa=null,ka=null,Pa=0,Ka=new b.vc,ya=new b.vc,ia=new b.k,sa=new b.k,La=new b.k,$=new b.k,Ha=new b.k,ta=new b.k,Da=new b.k,E=new b.k,aa={},xa={},H=new b.ug,X=new b.ug,za=new b.ug,ab=new b.k,lb=new b.k,Sa=new b.k,hb=new b.a,xb=16;wa=document.createElement("canvas");wa.width=wa.height=2;ja=wa.getContext("2d");ja.fillStyle="rgba(0,0,0,1)";ja.fillRect(0,0,2,2);eb=ja.getImageData(0,0,2,2);da=eb.data;Aa=document.createElement("canvas");Aa.width=Aa.height=xb;n=Aa.getContext("2d");
n.translate(-xb/2,-xb/2);n.scale(xb,xb);xb--;void 0===V.setLineDash&&(V.setLineDash=void 0!==V.Qx?function(a){V.Qx=null!==a[0]?a:null}:Ia());this.hd=Ca;this.devicePixelRatio=void 0!==a.devicePixelRatio?a.devicePixelRatio:void 0!==window.devicePixelRatio?window.devicePixelRatio:1;this.pz=this.$k=this.Me=!0;this.info={v:{c:0,j:0}};this.Gz=Ia();this.Cr=Ia();this.Qn=function(a,c,e){v=a*this.devicePixelRatio;w=c*this.devicePixelRatio;u=Math.floor(v/2);s=Math.floor(w/2);Ca.width=v;Ca.height=w;1!==this.devicePixelRatio&&
!1!==e&&(Ca.style.width=a+"px",Ca.style.height=c+"px");H.set(new b.i(-u,-s),new b.i(u,s));X.set(new b.i(-u,-s),new b.i(u,s));ra=1;ea=0;Oa=va=la=$a=ha=null};this.Ok=function(a,c){T.set(a);Ga=void 0!==c?c:1;X.set(new b.i(-u,-s),new b.i(u,s))};this.Wy=function(a,b){console.warn("DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead.");this.Ok(a,b)};this.kw=function(){return 0};this.clear=function(){V.setTransform(1,0,0,-1,u,s);!1===X.empty()&&(X.Cq(H),X.Wg(2),1>Ga&&V.clearRect(0|
X.min.x,0|X.min.y,0|X.max.x-X.min.x,0|X.max.y-X.min.y),0<Ga&&(c(b.Gh),e(1),k("rgba("+Math.floor(255*T.q)+","+Math.floor(255*T.o)+","+Math.floor(255*T.h)+","+Ga+")"),V.fillRect(0|X.min.x,0|X.min.y,0|X.max.x-X.min.x,0|X.max.y-X.min.y)),X.re())};this.v=function(a,v){function w(a,c,e){for(var d=0,f=r.length;f>d;d++){var g=r[d];if(E.copy(g.color),g instanceof b.Ib){var h=hb.lb(g.A).normalize(),k=c.za(h);0>=k||(k*=g.ia,e.add(E.p(k)))}else g instanceof b.Bd&&(h=hb.lb(g.A),k=c.za(hb.X(h,a).normalize()),0>=
k||(k*=0==g.ha?1:1-Math.min(a.gd(h)/g.ha,1),0==k)||(k*=g.ia,e.add(E.p(k))))}}function T(a,d,f){e(f.opacity);c(f.Ha);var g,n,l,m,qa,E,p;if(f instanceof b.Ce){if(null===f.map){if(l=d.object.scale.x,m=d.object.scale.y,l*=d.scale.x*u,m*=d.scale.y*s,za.min.set(a.x-l,a.y-m),za.max.set(a.x+l,a.y+m),!1===H.qe(za)){za.re();return}k(f.color.pe());V.save();V.translate(a.x,a.y);V.rotate(-d.rotation);V.scale(l,m);V.fillRect(-1,-1,2,2)}else{if(qa=f.map.R,E=qa.width>>1,p=qa.height>>1,l=d.scale.x*u,m=d.scale.y*s,
g=l*E,n=m*p,za.min.set(a.x-g,a.y-n),za.max.set(a.x+g,a.y+n),!1===H.qe(za)){za.re();return}V.save();V.translate(a.x,a.y);V.rotate(-d.rotation);V.scale(l,-m);V.translate(-E,-p);V.drawImage(qa,0,0)}V.restore()}else f instanceof b.sj&&((g=d.scale.x*u,n=d.scale.y*s,za.min.set(a.x-g,a.y-n),za.max.set(a.x+g,a.y+n),!1===H.qe(za))?za.re():(h(f.color.pe()),k(f.color.pe()),V.save(),V.translate(a.x,a.y),V.rotate(-d.rotation),V.scale(g,n),f.Ob(V),V.restore()))}function xb(a,k,n,m){if(e(m.opacity),c(m.Ha),V.beginPath(),
V.moveTo(a.e.x,a.e.y),V.lineTo(k.e.x,k.e.y),m instanceof b.Pc){if(d(m.Xc),f(m.yk),g(m.zk),m.m!==b.Fe)h(m.color.pe());else{var qa=n.m[0].pe();n=n.m[1].pe();if(qa===n)h(qa);else{try{var E=V.createLinearGradient(a.e.x,a.e.y,k.e.x,k.e.y);E.addColorStop(0,qa);E.addColorStop(1,n)}catch(p){E=qa}h(E)}}V.stroke();za.Wg(2*m.Xc)}else m instanceof b.zf&&(d(m.Xc),f(m.yk),g(m.zk),h(m.color.pe()),l(m.Qe,m.ni),V.stroke(),za.Wg(2*m.Xc),l(null,null))}function ea(a,d,f,g,h,k,n,l){if(pa.info.v.c+=3,pa.info.v.j++,e(l.opacity),
c(l.Ha),P=a.e.x,I=a.e.y,F=d.e.x,L=d.e.y,K=f.e.x,N=f.e.y,qb(P,I,F,L,K,N),(l instanceof b.hc||l instanceof b.qb)&&null===l.map)ta.copy(l.color),Da.copy(l.Aa),l.m===b.vf&&ta.multiply(n.color),!1===l.I&&l.ua==b.wc&&3==n.ml?(sa.copy(ab),La.copy(ab),$.copy(ab),w(n.ca.nd,n.ue[0],sa),w(n.ga.nd,n.ue[1],La),w(n.Qb.nd,n.ue[2],$),sa.multiply(ta).add(Da),La.multiply(ta).add(Da),$.multiply(ta).add(Da),Ha.em(La,$).p(0.5),y=gc(sa,La,$,Ha),Ib(P,I,F,L,K,N,0,0,y)):(ia.copy(ab),w(n.Rh,n.Wf,ia),ia.multiply(ta).add(Da),
!0===l.I?ha(ia,l.Fa,l.nc,l.oc):ra(ia));else if(l instanceof b.Za||l instanceof b.hc||l instanceof b.qb)null!==l.map?l.map.Nb instanceof b.cp&&(D=n.pg[0],qa(P,I,F,L,K,N,D[g].x,D[g].y,D[h].x,D[h].y,D[k].x,D[k].y,l.map)):null!==l.pa?l.pa.Nb instanceof b.yt&&(hb.copy(n.bd[g]),Z=0.5*hb.x+0.5,ma=0.5*hb.y+0.5,hb.copy(n.bd[h]),S=0.5*hb.x+0.5,G=0.5*hb.y+0.5,hb.copy(n.bd[k]),na=0.5*hb.x+0.5,Ba=0.5*hb.y+0.5,qa(P,I,F,L,K,N,Z,ma,S,G,na,Ba,l.pa)):(ia.copy(l.color),l.m===b.vf&&ia.multiply(n.color),!0===l.I?ha(ia,
l.Fa,l.nc,l.oc):ra(ia));else if(l instanceof b.ce)Y=v.Ja,C=v.Ia,sa.q=sa.o=sa.h=1-m(a.e.z*a.e.f,Y,C),La.q=La.o=La.h=1-m(d.e.z*d.e.f,Y,C),$.q=$.o=$.h=1-m(f.e.z*f.e.f,Y,C),Ha.em(La,$).p(0.5),y=gc(sa,La,$,Ha),Ib(P,I,F,L,K,N,0,0,y);else if(l instanceof b.Ae){var E;l.ua==b.wf?(E=n.Gk,ia.Wa(E.x,E.y,E.z).p(0.5).Jb(0.5),!0===l.I?ha(ia,l.Fa,l.nc,l.oc):ra(ia)):l.ua==b.wc&&(E=n.bd[g],sa.Wa(E.x,E.y,E.z).p(0.5).Jb(0.5),E=n.bd[h],La.Wa(E.x,E.y,E.z).p(0.5).Jb(0.5),E=n.bd[k],$.Wa(E.x,E.y,E.z).p(0.5).Jb(0.5),Ha.em(La,
$).p(0.5),y=gc(sa,La,$,Ha),Ib(P,I,F,L,K,N,0,0,y))}}function la(a,d,f,g,h,k,n,l){if(pa.info.v.c+=4,pa.info.v.j++,e(l.opacity),c(l.Ha),void 0!==l.map&&null!==l.map||void 0!==l.pa&&null!==l.pa)ea(a,d,g,0,1,3,n,l),ea(h,f,k,1,2,3,n,l);else if(P=a.e.x,I=a.e.y,F=d.e.x,L=d.e.y,K=f.e.x,N=f.e.y,B=g.e.x,W=g.e.y,M=h.e.x,J=h.e.y,R=k.e.x,U=k.e.y,l instanceof b.hc||l instanceof b.qb)ta.copy(l.color),Da.copy(l.Aa),l.m===b.vf&&ta.multiply(n.color),!1===l.I&&l.ua==b.wc&&4==n.ml?(sa.copy(ab),La.copy(ab),$.copy(ab),
Ha.copy(ab),w(n.ca.nd,n.ue[0],sa),w(n.ga.nd,n.ue[1],La),w(n.no.nd,n.ue[3],$),w(n.Qb.nd,n.ue[2],Ha),sa.multiply(ta).add(Da),La.multiply(ta).add(Da),$.multiply(ta).add(Da),Ha.multiply(ta).add(Da),y=gc(sa,La,$,Ha),qb(P,I,F,L,B,W),Ib(P,I,F,L,B,W,0,0,y),qb(M,J,K,N,R,U),Ib(M,J,K,N,R,U,1,1,y)):(ia.copy(ab),w(n.Rh,n.Wf,ia),ia.multiply(ta).add(Da),Ca(P,I,F,L,K,N,B,W),!0===l.I?ha(ia,l.Fa,l.nc,l.oc):ra(ia));else if(l instanceof b.Za)ia.copy(l.color),l.m===b.vf&&ia.multiply(n.color),Ca(P,I,F,L,K,N,B,W),!0===
l.I?ha(ia,l.Fa,l.nc,l.oc):ra(ia);else if(l instanceof b.Ae){var qa;l.ua==b.wf?(qa=n.Gk,ia.Wa(qa.x,qa.y,qa.z).p(0.5).Jb(0.5),Ca(P,I,F,L,K,N,B,W),!0===l.I?ha(ia,l.Fa,l.nc,l.oc):ra(ia)):l.ua==b.wc&&(qa=n.bd[0],sa.Wa(qa.x,qa.y,qa.z).p(0.5).Jb(0.5),qa=n.bd[1],La.Wa(qa.x,qa.y,qa.z).p(0.5).Jb(0.5),qa=n.bd[3],$.Wa(qa.x,qa.y,qa.z).p(0.5).Jb(0.5),qa=n.bd[2],Ha.Wa(qa.x,qa.y,qa.z).p(0.5).Jb(0.5),y=gc(sa,La,$,Ha),qb(P,I,F,L,B,W),Ib(P,I,F,L,B,W,0,0,y),qb(M,J,K,N,R,U),Ib(M,J,K,N,R,U,1,1,y))}else l instanceof b.ce&&
(Y=v.Ja,C=v.Ia,sa.q=sa.o=sa.h=1-m(a.e.z*a.e.f,Y,C),La.q=La.o=La.h=1-m(d.e.z*d.e.f,Y,C),$.q=$.o=$.h=1-m(g.e.z*g.e.f,Y,C),Ha.q=Ha.o=Ha.h=1-m(f.e.z*f.e.f,Y,C),y=gc(sa,La,$,Ha),qb(P,I,F,L,B,W),Ib(P,I,F,L,B,W,0,0,y),qb(M,J,K,N,R,U),Ib(M,J,K,N,R,U,1,1,y))}function qb(a,b,c,e,d,f){V.beginPath();V.moveTo(a,b);V.lineTo(c,e);V.lineTo(d,f);V.closePath()}function Ca(a,b,c,e,d,f,g,h){V.beginPath();V.moveTo(a,b);V.lineTo(c,e);V.lineTo(d,f);V.lineTo(g,h);V.closePath()}function ha(a,b,c,e){d(b);f(c);g(e);h(a.pe());
V.stroke();za.Wg(2*b)}function ra(a){k(a.pe());V.fill()}function qa(a,c,e,d,f,g,h,l,n,m,qa,E,p){if(!(p instanceof b.uf||void 0===p.R||0==p.R.width)){if(!0===p.ea){var y=p.pc==b.ed,q=p.qc==b.ed;aa[p.id]=V.createPattern(p.R,!0===y&&!0===q?"repeat":!0===y&&!1===q?"repeat-x":!1===y&&!0===q?"repeat-y":"no-repeat");p.ea=!1}void 0===aa[p.id]?k("rgba(0,0,0,1)"):k(aa[p.id]);var r,y=p.offset.x/p.repeat.x,q=p.offset.y/p.repeat.y,u=p.R.width*p.repeat.x,D=p.R.height*p.repeat.y;(h=(h+y)*u,l=(1-l+q)*D,n=(n+y)*u,
m=(1-m+q)*D,qa=(qa+y)*u,E=(1-E+q)*D,e-=a,d-=c,f-=a,g-=c,n-=h,m-=l,qa-=h,E-=l,r=n*E-qa*m,0===r)?(void 0===xa[p.id]&&(c=document.createElement("canvas"),c.width=p.R.width,c.height=p.R.height,c=c.getContext("2d"),c.drawImage(p.R,0,0),xa[p.id]=c.getImageData(0,0,p.R.width,p.R.height).data),c=xa[p.id],h=4*(Math.floor(h)+Math.floor(l)*p.R.width),ia.Wa(c[h]/255,c[h+1]/255,c[h+2]/255),ra(ia)):(r=1/r,p=(E*e-m*f)*r,m=(E*d-m*g)*r,e=(n*f-qa*e)*r,d=(n*g-qa*d)*r,a=a-p*h-e*l,h=c-m*h-d*l,V.save(),V.transform(p,m,
e,d,a,h),V.fill(),V.restore())}}function Ib(a,b,c,e,d,f,g,h,l){var k,n,m,qa,E,p;m=l.width-1;E=l.height-1;g*=m;k=0*E;c-=a;e-=b;d-=a;f-=b;n=1*m-g;h=h*E-k;m=0*m-g;qa=1*E-k;p=1/(n*qa-m*h);E=(qa*c-h*d)*p;h=(qa*e-h*f)*p;c=(n*d-m*c)*p;e=(n*f-m*e)*p;a=a-E*g-c*k;b=b-h*g-e*k;V.save();V.transform(E,h,c,e,a,b);V.clip();V.drawImage(l,0,0);V.restore()}function gc(a,b,c,e){return da[0]=0|255*a.q,da[1]=0|255*a.o,da[2]=0|255*a.h,da[4]=0|255*b.q,da[5]=0|255*b.o,da[6]=0|255*b.h,da[8]=0|255*c.q,da[9]=0|255*c.o,da[10]=
0|255*c.h,da[12]=0|255*e.q,da[13]=0|255*e.o,da[14]=0|255*e.h,ja.putImageData(eb,0,0),n.drawImage(wa,0,0),Aa}function Qb(a,b){var c,e=b.x-a.x,d=b.y-a.y,f=e*e+d*d;0!==f&&(c=1/Math.sqrt(f),e*=c,d*=c,b.x+=e,b.y+=d,a.x-=e,a.y-=d)}if(!1==v instanceof b.sc)return console.error("THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera."),void 0;!0===this.Me&&this.clear();V.setTransform(1,0,0,-1,u,s);pa.info.v.c=0;pa.info.v.j=0;q=fb.By(a,v,this.$k,this.pz);p=q.elements;r=q.fb;(function(){ab.Wa(0,
0,0);lb.Wa(0,0,0);Sa.Wa(0,0,0);for(var a=0,c=r.length;c>a;a++){var e=r[a],d=e.color;e instanceof b.qf?ab.add(d):e instanceof b.Ib?lb.add(d):e instanceof b.Bd&&Sa.add(d)}})();for(var Qc=0,hd=p.length;hd>Qc;Qc++){var pb=p[Qc],Rb=pb.n;if(void 0!==Rb&&!1!==Rb.visible){if(za.re(),pb instanceof b.Wo)t=pb,t.x*=u,t.y*=s,T(t,pb,Rb);else if(pb instanceof b.Vo)t=pb.ca,A=pb.ga,t.e.x*=u,t.e.y*=s,A.e.x*=u,A.e.y*=s,za.jf([t.e,A.e]),!0===H.qe(za)&&xb(t,A,pb,Rb);else if(pb instanceof b.To){if(t=pb.ca,A=pb.ga,Q=pb.Qb,
-1>t.e.z||1<t.e.z)continue;if(-1>A.e.z||1<A.e.z)continue;if(-1>Q.e.z||1<Q.e.z)continue;t.e.x*=u;t.e.y*=s;A.e.x*=u;A.e.y*=s;Q.e.x*=u;Q.e.y*=s;!0===Rb.Jk&&(Qb(t.e,A.e),Qb(A.e,Q.e),Qb(Q.e,t.e));za.jf([t.e,A.e,Q.e]);!0===H.qe(za)&&ea(t,A,Q,0,1,2,pb,Rb)}else if(pb instanceof b.Uo){if(t=pb.ca,A=pb.ga,Q=pb.Qb,O=pb.no,-1>t.e.z||1<t.e.z)continue;if(-1>A.e.z||1<A.e.z)continue;if(-1>Q.e.z||1<Q.e.z)continue;if(-1>O.e.z||1<O.e.z)continue;t.e.x*=u;t.e.y*=s;A.e.x*=u;A.e.y*=s;Q.e.x*=u;Q.e.y*=s;O.e.x*=u;O.e.y*=s;
Ka.e.copy(A.e);ya.e.copy(O.e);!0===Rb.Jk&&(Qb(t.e,A.e),Qb(A.e,O.e),Qb(O.e,t.e),Qb(Q.e,Ka.e),Qb(Q.e,ya.e));za.jf([t.e,A.e,Q.e,O.e]);!0===H.qe(za)&&la(t,A,Q,O,Ka,ya,pb,Rb)}X.io(za)}}V.setTransform(1,0,0,1,0,0)}};b.g={Yg:"#ifdef USE_FOG\nuniform vec3 fogColor;\n#ifdef FOG_EXP2\nuniform float fogDensity;\n#else\nuniform float fogNear;\nuniform float fogFar;\n#endif\n#endif",Xg:"#ifdef USE_FOG\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n#ifdef FOG_EXP2\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n#else\nfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n#endif\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n#endif",
Jm:"#ifdef USE_ENVMAP\nuniform float reflectivity;\nuniform samplerCube envMap;\nuniform float flipEnvMap;\nuniform int combine;\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nuniform bool useRefract;\nuniform float refractionRatio;\n#else\nvarying vec3 vReflect;\n#endif\n#endif",Im:"#ifdef USE_ENVMAP\nvec3 reflectVec;\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\nif ( useRefract ) {\nreflectVec = refract( cameraToVertex, normal, refractionRatio );\n} else { \nreflectVec = reflect( cameraToVertex, normal );\n}\n#else\nreflectVec = vReflect;\n#endif\n#ifdef DOUBLE_SIDED\nfloat flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\nvec4 cubeColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n#else\nvec4 cubeColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n#endif\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\nif ( combine == 1 ) {\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularStrength * reflectivity );\n} else if ( combine == 2 ) {\ngl_FragColor.xyz += cubeColor.xyz * specularStrength * reflectivity;\n} else {\ngl_FragColor.xyz = mix( gl_FragColor.xyz, gl_FragColor.xyz * cubeColor.xyz, specularStrength * reflectivity );\n}\n#endif",
Km:"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nvarying vec3 vReflect;\nuniform float refractionRatio;\nuniform bool useRefract;\n#endif",nl:"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n#ifdef USE_SKINNING\nvec4 worldPosition = modelMatrix * skinned;\n#endif\n#if defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\nvec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\n#endif\n#if ! defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\nvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n#endif\n#endif",
Lm:"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nvec3 worldNormal = mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * objectNormal;\nworldNormal = normalize( worldNormal );\nvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\nif ( useRefract ) {\nvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n} else {\nvReflect = reflect( cameraToVertex, worldNormal );\n}\n#endif",Dx:"#ifdef USE_MAP\nuniform sampler2D map;\n#endif",
Cx:"#ifdef USE_MAP\ngl_FragColor = gl_FragColor * texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) );\n#endif",ln:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\nuniform vec4 offsetRepeat;\n#endif",kn:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\nuniform sampler2D map;\n#endif",mn:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",
jn:"#ifdef USE_MAP\nvec4 texelColor = texture2D( map, vUv );\n#ifdef GAMMA_INPUT\ntexelColor.xyz *= texelColor.xyz;\n#endif\ngl_FragColor = gl_FragColor * texelColor;\n#endif",dn:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\nuniform sampler2D lightMap;\n#endif",en:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\n#endif",cn:"#ifdef USE_LIGHTMAP\ngl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );\n#endif",fn:"#ifdef USE_LIGHTMAP\nvUv2 = uv2;\n#endif",fv:"#ifdef USE_BUMPMAP\nuniform sampler2D bumpMap;\nuniform float bumpScale;\nvec2 dHdxy_fwd() {\nvec2 dSTdx = dFdx( vUv );\nvec2 dSTdy = dFdy( vUv );\nfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\nfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\nfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\nreturn vec2( dBx, dBy );\n}\nvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\nvec3 vSigmaX = dFdx( surf_pos );\nvec3 vSigmaY = dFdy( surf_pos );\nvec3 vN = surf_norm;\nvec3 R1 = cross( vSigmaY, vN );\nvec3 R2 = cross( vN, vSigmaX );\nfloat fDet = dot( vSigmaX, R1 );\nvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\nreturn normalize( abs( fDet ) * surf_norm - vGrad );\n}\n#endif",
Vx:"#ifdef USE_NORMALMAP\nuniform sampler2D normalMap;\nuniform vec2 normalScale;\nvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\nvec3 q0 = dFdx( eye_pos.xyz );\nvec3 q1 = dFdy( eye_pos.xyz );\nvec2 st0 = dFdx( vUv.st );\nvec2 st1 = dFdy( vUv.st );\nvec3 S = normalize(  q0 * st1.t - q1 * st0.t );\nvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\nvec3 N = normalize( surf_norm );\nvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\nmapN.xy = normalScale * mapN.xy;\nmat3 tsn = mat3( S, T, N );\nreturn normalize( tsn * mapN );\n}\n#endif",
Zn:"#ifdef USE_SPECULARMAP\nuniform sampler2D specularMap;\n#endif",Yn:"float specularStrength;\n#ifdef USE_SPECULARMAP\nvec4 texelSpecular = texture2D( specularMap, vUv );\nspecularStrength = texelSpecular.r;\n#else\nspecularStrength = 1.0;\n#endif",$w:"uniform vec3 ambient;\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif",
ax:"vLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\nvLightBack = vec3( 0.0 );\n#endif\ntransformedNormal = normalize( transformedNormal );\n#if MAX_DIR_LIGHTS > 0\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( transformedNormal, dirVector );\nvec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\ndirectionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\ndirectionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += directionalLightColor[ i ] * directionalLightWeighting;\n#ifdef DOUBLE_SIDED\nvLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;\n#endif\n}\n#endif\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat dotProduct = dot( transformedNormal, lVector );\nvec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\npointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\npointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += pointLightColor[ i ] * pointLightWeighting * lDistance;\n#ifdef DOUBLE_SIDED\nvLightBack += pointLightColor[ i ] * pointLightWeightingBack * lDistance;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat dotProduct = dot( transformedNormal, lVector );\nvec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\nspotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\nspotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += spotLightColor[ i ] * spotLightWeighting * lDistance * spotEffect;\n#ifdef DOUBLE_SIDED\nvLightBack += spotLightColor[ i ] * spotLightWeightingBack * lDistance * spotEffect;\n#endif\n}\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( transformedNormal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nfloat hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;\nvLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n#ifdef DOUBLE_SIDED\nvLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\n#endif\n}\n#endif\nvLightFront = vLightFront * diffuse + ambient * ambientLightColor + emissive;\n#ifdef DOUBLE_SIDED\nvLightBack = vLightBack * diffuse + ambient * ambientLightColor + emissive;\n#endif",
dx:"#ifndef PHONG_PER_PIXEL\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\nvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvarying vec3 vWorldPosition;\n#endif",ex:"#ifndef PHONG_PER_PIXEL\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nvPointLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nvSpotLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvWorldPosition = worldPosition.xyz;\n#endif",
cx:"uniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n#ifdef PHONG_PER_PIXEL\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#else\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n#ifdef PHONG_PER_PIXEL\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n#else\nvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvarying vec3 vWorldPosition;\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",
bx:"vec3 normal = normalize( vNormal );\nvec3 viewPosition = normalize( vViewPosition );\n#ifdef DOUBLE_SIDED\nnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n#endif\n#ifdef USE_NORMALMAP\nnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\nnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse  = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n#ifdef PHONG_PER_PIXEL\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\n#else\nvec3 lVector = normalize( vPointLight[ i ].xyz );\nfloat lDistance = vPointLight[ i ].w;\n#endif\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dotProduct, 0.0 );\n#endif\npointDiffuse  += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;\nvec3 pointHalfVector = normalize( lVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, pointHalfVector ), 5.0 );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization;\n#else\npointSpecular += specular * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvec3 spotDiffuse  = vec3( 0.0 );\nvec3 spotSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n#ifdef PHONG_PER_PIXEL\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\n#else\nvec3 lVector = normalize( vSpotLight[ i ].xyz );\nfloat lDistance = vSpotLight[ i ].w;\n#endif\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat spotDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n#else\nfloat spotDiffuseWeight = max( dotProduct, 0.0 );\n#endif\nspotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;\nvec3 spotHalfVector = normalize( lVector + viewPosition );\nfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\nfloat spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, spotHalfVector ), 5.0 );\nspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;\n#else\nspotSpecular += specular * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * spotEffect;\n#endif\n}\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse  = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, dirVector );\n#ifdef WRAP_AROUND\nfloat dirDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dotProduct, 0.0 );\n#endif\ndirDiffuse  += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n#else\ndirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight;\n#endif\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nvec3 hemiDiffuse  = vec3( 0.0 );\nvec3 hemiSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\nhemiDiffuse += diffuse * hemiColor;\nvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\nfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\nfloat hemiSpecularWeightSky = specularStrength * max( pow( hemiDotNormalHalfSky, shininess ), 0.0 );\nvec3 lVectorGround = -lVector;\nvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\nfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\nfloat hemiSpecularWeightGround = specularStrength * max( pow( hemiDotNormalHalfGround, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat dotProductGround = dot( normal, lVectorGround );\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );\nvec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );\nhemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n#else\nhemiSpecular += specular * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;\n#endif\n}\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#if MAX_HEMI_LIGHTS > 0\ntotalDiffuse += hemiDiffuse;\ntotalSpecular += hemiSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\n#if MAX_SPOT_LIGHTS > 0\ntotalDiffuse += spotDiffuse;\ntotalSpecular += spotSpecular;\n#endif\n#ifdef METAL\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular );\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient ) + totalSpecular;\n#endif",
Wh:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",Vh:"#ifdef USE_COLOR\ngl_FragColor = gl_FragColor * vec4( vColor, opacity );\n#endif",Xh:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",Yh:"#ifdef USE_COLOR\n#ifdef GAMMA_INPUT\nvColor = color * color;\n#else\nvColor = color;\n#endif\n#endif",cj:"#ifdef USE_SKINNING\n#ifdef BONE_TEXTURE\nuniform sampler2D boneTexture;\nmat4 getBoneMatrix( const in float i ) {\nfloat j = i * 4.0;\nfloat x = mod( j, N_BONE_PIXEL_X );\nfloat y = floor( j / N_BONE_PIXEL_X );\nconst float dx = 1.0 / N_BONE_PIXEL_X;\nconst float dy = 1.0 / N_BONE_PIXEL_Y;\ny = dy * ( y + 0.5 );\nvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\nvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\nvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\nvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\nmat4 bone = mat4( v1, v2, v3, v4 );\nreturn bone;\n}\n#else\nuniform mat4 boneGlobalMatrices[ MAX_BONES ];\nmat4 getBoneMatrix( const in float i ) {\nmat4 bone = boneGlobalMatrices[ int(i) ];\nreturn bone;\n}\n#endif\n#endif",
bj:"#ifdef USE_SKINNING\nmat4 boneMatX = getBoneMatrix( skinIndex.x );\nmat4 boneMatY = getBoneMatrix( skinIndex.y );\n#endif",Xk:"#ifdef USE_SKINNING\n#ifdef USE_MORPHTARGETS\nvec4 skinVertex = vec4( morphed, 1.0 );\n#else\nvec4 skinVertex = vec4( position, 1.0 );\n#endif\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned \t  += boneMatY * skinVertex * skinWeight.y;\n#endif",Ci:"#ifdef USE_MORPHTARGETS\n#ifndef USE_MORPHNORMALS\nuniform float morphTargetInfluences[ 8 ];\n#else\nuniform float morphTargetInfluences[ 4 ];\n#endif\n#endif",
Di:"#ifdef USE_MORPHTARGETS\nvec3 morphed = vec3( 0.0 );\nmorphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\nmorphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\nmorphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\nmorphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n#ifndef USE_MORPHNORMALS\nmorphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\nmorphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\nmorphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\nmorphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n#endif\nmorphed += position;\n#endif",
ei:"vec4 mvPosition;\n#ifdef USE_SKINNING\nmvPosition = modelViewMatrix * skinned;\n#endif\n#if !defined( USE_SKINNING ) && defined( USE_MORPHTARGETS )\nmvPosition = modelViewMatrix * vec4( morphed, 1.0 );\n#endif\n#if !defined( USE_SKINNING ) && ! defined( USE_MORPHTARGETS )\nmvPosition = modelViewMatrix * vec4( position, 1.0 );\n#endif\ngl_Position = projectionMatrix * mvPosition;",rn:"#ifdef USE_MORPHNORMALS\nvec3 morphedNormal = vec3( 0.0 );\nmorphedNormal +=  ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\nmorphedNormal +=  ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\nmorphedNormal +=  ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\nmorphedNormal +=  ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\nmorphedNormal += normal;\n#endif",
Yk:"#ifdef USE_SKINNING\nmat4 skinMatrix = skinWeight.x * boneMatX;\nskinMatrix \t+= skinWeight.y * boneMatY;\n#ifdef USE_MORPHNORMALS\nvec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );\n#else\nvec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );\n#endif\n#endif",ym:"vec3 objectNormal;\n#ifdef USE_SKINNING\nobjectNormal = skinnedNormal.xyz;\n#endif\n#if !defined( USE_SKINNING ) && defined( USE_MORPHNORMALS )\nobjectNormal = morphedNormal;\n#endif\n#if !defined( USE_SKINNING ) && ! defined( USE_MORPHNORMALS )\nobjectNormal = normal;\n#endif\n#ifdef FLIP_SIDED\nobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;",
Yi:"#ifdef USE_SHADOWMAP\nuniform sampler2D shadowMap[ MAX_SHADOWS ];\nuniform vec2 shadowMapSize[ MAX_SHADOWS ];\nuniform float shadowDarkness[ MAX_SHADOWS ];\nuniform float shadowBias[ MAX_SHADOWS ];\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nfloat unpackDepth( const in vec4 rgba_depth ) {\nconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\nfloat depth = dot( rgba_depth, bit_shift );\nreturn depth;\n}\n#endif",Xi:"#ifdef USE_SHADOWMAP\n#ifdef SHADOWMAP_DEBUG\nvec3 frustumColors[3];\nfrustumColors[0] = vec3( 1.0, 0.5, 0.0 );\nfrustumColors[1] = vec3( 0.0, 1.0, 0.8 );\nfrustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n#endif\n#ifdef SHADOWMAP_CASCADE\nint inFrustumCount = 0;\n#endif\nfloat fDepth;\nvec3 shadowColor = vec3( 1.0 );\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\nbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\nbool inFrustum = all( inFrustumVec );\n#ifdef SHADOWMAP_CASCADE\ninFrustumCount += int( inFrustum );\nbvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\n#else\nbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n#endif\nbool frustumTest = all( frustumTestVec );\nif ( frustumTest ) {\nshadowCoord.z += shadowBias[ i ];\n#if defined( SHADOWMAP_TYPE_PCF )\nfloat shadow = 0.0;\nconst float shadowDelta = 1.0 / 9.0;\nfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\nfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\nfloat dx0 = -1.25 * xPixelOffset;\nfloat dy0 = -1.25 * yPixelOffset;\nfloat dx1 = 1.25 * xPixelOffset;\nfloat dy1 = 1.25 * yPixelOffset;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\nfloat shadow = 0.0;\nfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\nfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\nfloat dx0 = -1.0 * xPixelOffset;\nfloat dy0 = -1.0 * yPixelOffset;\nfloat dx1 = 1.0 * xPixelOffset;\nfloat dy1 = 1.0 * yPixelOffset;\nmat3 shadowKernel;\nmat3 depthKernel;\ndepthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\ndepthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\ndepthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\ndepthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\ndepthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\ndepthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\ndepthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\ndepthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\ndepthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\nvec3 shadowZ = vec3( shadowCoord.z );\nshadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\nshadowKernel[0] *= vec3(0.25);\nshadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\nshadowKernel[1] *= vec3(0.25);\nshadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\nshadowKernel[2] *= vec3(0.25);\nvec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\nshadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\nshadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\nvec4 shadowValues;\nshadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\nshadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\nshadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\nshadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\nshadow = dot( shadowValues, vec4( 1.0 ) );\nshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n#else\nvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\nfloat fDepth = unpackDepth( rgbaDepth );\nif ( fDepth < shadowCoord.z )\nshadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n#endif\n}\n#ifdef SHADOWMAP_DEBUG\n#ifdef SHADOWMAP_CASCADE\nif ( inFrustum && inFrustumCount == 1 ) gl_FragColor.xyz *= frustumColors[ i ];\n#else\nif ( inFrustum ) gl_FragColor.xyz *= frustumColors[ i ];\n#endif\n#endif\n}\n#ifdef GAMMA_OUTPUT\nshadowColor *= shadowColor;\n#endif\ngl_FragColor.xyz = gl_FragColor.xyz * shadowColor;\n#endif",
Zi:"#ifdef USE_SHADOWMAP\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nuniform mat4 shadowMatrix[ MAX_SHADOWS ];\n#endif",Wk:"#ifdef USE_SHADOWMAP\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n}\n#endif",Nj:"#ifdef ALPHATEST\nif ( gl_FragColor.a < ALPHATEST ) discard;\n#endif",xk:"#ifdef GAMMA_OUTPUT\ngl_FragColor.xyz = sqrt( gl_FragColor.xyz );\n#endif"};b.xc={Uf:function(a){var b,c,d,f={};for(b=0;b<a.length;b++)for(c in d=this.d(a[b]),d)f[c]=d[c];
return f},d:function(a){var e,c,d,f={};for(e in a)for(c in f[e]={},a[e])d=a[e][c],f[e][c]=d instanceof b.k||d instanceof b.i||d instanceof b.a||d instanceof b.Rc||d instanceof b.K||d instanceof b.Vb?d.d():d instanceof Array?d.slice():d;return f}};b.$a={Vj:{Re:{type:"c",value:new b.k(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},Yx:{type:"v4",value:new b.Rc(0,0,1,1)},Ta:{type:"t",value:null},Qa:{type:"t",value:null},pa:{type:"t",value:null},$v:{type:"f",value:-1},ys:{type:"i",value:0},
Yc:{type:"f",value:1},Zc:{type:"f",value:0.98},Uc:{type:"i",value:0},md:{type:"f",value:0}},ev:{Xb:{type:"t",value:null},Lg:{type:"f",value:1}},Hk:{wb:{type:"t",value:null},df:{type:"v2",value:new b.i(1,1)}},D:{gk:{type:"f",value:2.5E-4},ik:{type:"f",value:1},hk:{type:"f",value:2E3},fk:{type:"c",value:new b.k(16777215)}},fb:{Ku:{type:"fv",value:[]},Ev:{type:"fv",value:[]},Dv:{type:"fv",value:[]},xw:{type:"fv",value:[]},zw:{type:"fv",value:[]},yw:{type:"fv",value:[]},ry:{type:"fv",value:[]},ty:{type:"fv",
value:[]},sy:{type:"fv1",value:[]},uz:{type:"fv",value:[]},yz:{type:"fv",value:[]},vz:{type:"fv",value:[]},wz:{type:"fv1",value:[]},tz:{type:"fv1",value:[]},xz:{type:"fv1",value:[]}},ny:{Cy:{type:"c",value:new b.k(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},gk:{type:"f",value:2.5E-4},ik:{type:"f",value:1},hk:{type:"f",value:2E3},fk:{type:"c",value:new b.k(16777215)}},Wi:{gg:{type:"tv",value:[]},Ti:{type:"v2v",value:[]},th:{type:"fv1",
value:[]},lf:{type:"fv1",value:[]},ig:{type:"m4v",value:[]}}};b.yg={jB:{N:b.xc.Uf([b.$a.Vj,b.$a.D,b.$a.Wi]),O:[b.g.ln,b.g.en,b.g.Km,b.g.Xh,b.g.Ci,b.g.cj,b.g.Zi,"void main() {",b.g.mn,b.g.fn,b.g.Yh,b.g.bj,"#ifdef USE_ENVMAP",b.g.rn,b.g.Yk,b.g.ym,"#endif",b.g.Di,b.g.Xk,b.g.ei,b.g.nl,b.g.Lm,b.g.Wk,"}"].join("\n"),L:["uniform vec3 diffuse;\nuniform float opacity;",b.g.Wh,b.g.kn,b.g.dn,b.g.Jm,b.g.Yg,b.g.Yi,b.g.Zn,"void main() {\ngl_FragColor = vec4( diffuse, opacity );",b.g.jn,b.g.Nj,b.g.Yn,b.g.cn,b.g.Vh,
b.g.Im,b.g.Xi,b.g.xk,b.g.Xg,"}"].join("\n")},FD:{N:b.xc.Uf([b.$a.Vj,b.$a.D,b.$a.fb,b.$a.Wi,{ta:{type:"c",value:new b.k(16777215)},Aa:{type:"c",value:new b.k(0)},cd:{type:"v3",value:new b.a(1,1,1)}}]),O:["#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\nvarying vec3 vLightBack;\n#endif",b.g.ln,b.g.en,b.g.Km,b.g.$w,b.g.Xh,b.g.Ci,b.g.cj,b.g.Zi,"void main() {",b.g.mn,b.g.fn,b.g.Yh,b.g.rn,b.g.bj,b.g.Yk,b.g.ym,b.g.Di,b.g.Xk,b.g.ei,b.g.nl,b.g.Lm,b.g.ax,b.g.Wk,"}"].join("\n"),L:["uniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\nvarying vec3 vLightBack;\n#endif",
b.g.Wh,b.g.kn,b.g.dn,b.g.Jm,b.g.Yg,b.g.Yi,b.g.Zn,"void main() {\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );",b.g.jn,b.g.Nj,b.g.Yn,"#ifdef DOUBLE_SIDED\nif ( gl_FrontFacing )\ngl_FragColor.xyz *= vLightFront;\nelse\ngl_FragColor.xyz *= vLightBack;\n#else\ngl_FragColor.xyz *= vLightFront;\n#endif",b.g.cn,b.g.Vh,b.g.Im,b.g.Xi,b.g.xk,b.g.Xg,"}"].join("\n")},PF:{N:b.xc.Uf([b.$a.Vj,b.$a.ev,b.$a.Hk,b.$a.D,b.$a.fb,b.$a.Wi,{ta:{type:"c",value:new b.k(16777215)},Aa:{type:"c",value:new b.k(0)},Lc:{type:"c",
value:new b.k(1118481)},Jc:{type:"f",value:30},cd:{type:"v3",value:new b.a(1,1,1)}}]),O:["#define PHONG\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",b.g.ln,b.g.en,b.g.Km,b.g.dx,b.g.Xh,b.g.Ci,b.g.cj,b.g.Zi,"void main() {",b.g.mn,b.g.fn,b.g.Yh,b.g.rn,b.g.bj,b.g.Yk,b.g.ym,"vNormal = normalize( transformedNormal );",b.g.Di,b.g.Xk,b.g.ei,"vViewPosition = -mvPosition.xyz;",b.g.nl,b.g.Lm,b.g.ex,b.g.Wk,"}"].join("\n"),L:["uniform vec3 diffuse;\nuniform float opacity;\nuniform vec3 ambient;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;",
b.g.Wh,b.g.kn,b.g.dn,b.g.Jm,b.g.Yg,b.g.cx,b.g.Yi,b.g.fv,b.g.Vx,b.g.Zn,"void main() {\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );",b.g.jn,b.g.Nj,b.g.Yn,b.g.bx,b.g.cn,b.g.Vh,b.g.Im,b.g.Xi,b.g.xk,b.g.Xg,"}"].join("\n")},KF:{N:b.xc.Uf([b.$a.ny,b.$a.Wi]),O:["uniform float size;\nuniform float scale;",b.g.Xh,b.g.Zi,"void main() {",b.g.Yh,"vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n#ifdef USE_SIZEATTENUATION\ngl_PointSize = size * ( scale / length( mvPosition.xyz ) );\n#else\ngl_PointSize = size;\n#endif\ngl_Position = projectionMatrix * mvPosition;",
b.g.nl,b.g.Wk,"}"].join("\n"),L:["uniform vec3 psColor;\nuniform float opacity;",b.g.Wh,b.g.Dx,b.g.Yg,b.g.Yi,"void main() {\ngl_FragColor = vec4( psColor, opacity );",b.g.Cx,b.g.Nj,b.g.Vh,b.g.Xi,b.g.Xg,"}"].join("\n")},oC:{N:b.xc.Uf([b.$a.Vj,b.$a.D,{scale:{type:"f",value:1},Qe:{type:"f",value:1},Oz:{type:"f",value:2}}]),O:["uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;",b.g.Xh,"void main() {",b.g.Yh,"vLineDistance = scale * lineDistance;\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n}"].join("\n"),
L:["uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;",b.g.Wh,b.g.Yg,"void main() {\nif ( mod( vLineDistance, totalSize ) > dashSize ) {\ndiscard;\n}\ngl_FragColor = vec4( diffuse, opacity );",b.g.Vh,b.g.Xg,"}"].join("\n")},depth:{N:{qx:{type:"f",value:1},px:{type:"f",value:2E3},opacity:{type:"f",value:1}},O:"void main() {\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",L:"uniform float mNear;\nuniform float mFar;\nuniform float opacity;\nvoid main() {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat color = 1.0 - smoothstep( mNear, mFar, depth );\ngl_FragColor = vec4( vec3( color ), opacity );\n}"},
s:{N:{opacity:{type:"f",value:1}},O:["varying vec3 vNormal;",b.g.Ci,"void main() {\nvNormal = normalize( normalMatrix * normal );",b.g.Di,b.g.ei,"}"].join("\n"),L:"uniform float opacity;\nvarying vec3 vNormal;\nvoid main() {\ngl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );\n}"},Hk:{N:b.xc.Uf([b.$a.D,b.$a.fb,b.$a.Wi,{$p:{type:"i",value:0},aq:{type:"i",value:0},bq:{type:"i",value:0},Kv:{type:"i",value:0},Jv:{type:"i",value:0},Hz:{type:"t",value:null},bs:{type:"t",value:null},as:{type:"t",
value:null},cs:{type:"t",value:null},ds:{type:"t",value:null},$r:{type:"t",value:null},rs:{type:"v2",value:new b.i(1,1)},Sz:{type:"f",value:0},Tz:{type:"f",value:1},qs:{type:"c",value:new b.k(16777215)},us:{type:"c",value:new b.k(1118481)},ps:{type:"c",value:new b.k(16777215)},ts:{type:"f",value:30},ss:{type:"f",value:1},ys:{type:"i",value:0},CH:{type:"f",value:0.98},Uz:{type:"f",value:0.5},BH:{type:"v2",value:new b.i(0,0)},DH:{type:"v2",value:new b.i(1,1)},cd:{type:"v3",value:new b.a(1,1,1)}}]),
L:["uniform vec3 uAmbientColor;\nuniform vec3 uDiffuseColor;\nuniform vec3 uSpecularColor;\nuniform float uShininess;\nuniform float uOpacity;\nuniform bool enableDiffuse;\nuniform bool enableSpecular;\nuniform bool enableAO;\nuniform bool enableReflection;\nuniform sampler2D tDiffuse;\nuniform sampler2D tNormal;\nuniform sampler2D tSpecular;\nuniform sampler2D tAO;\nuniform samplerCube tCube;\nuniform vec2 uNormalScale;\nuniform bool useRefract;\nuniform float uRefractionRatio;\nuniform float uReflectivity;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vWorldPosition;\nvarying vec3 vViewPosition;",
b.g.Yi,b.g.Yg,"void main() {\ngl_FragColor = vec4( vec3( 1.0 ), uOpacity );\nvec3 specularTex = vec3( 1.0 );\nvec3 normalTex = texture2D( tNormal, vUv ).xyz * 2.0 - 1.0;\nnormalTex.xy *= uNormalScale;\nnormalTex = normalize( normalTex );\nif( enableDiffuse ) {\n#ifdef GAMMA_INPUT\nvec4 texelColor = texture2D( tDiffuse, vUv );\ntexelColor.xyz *= texelColor.xyz;\ngl_FragColor = gl_FragColor * texelColor;\n#else\ngl_FragColor = gl_FragColor * texture2D( tDiffuse, vUv );\n#endif\n}\nif( enableAO ) {\n#ifdef GAMMA_INPUT\nvec4 aoColor = texture2D( tAO, vUv );\naoColor.xyz *= aoColor.xyz;\ngl_FragColor.xyz = gl_FragColor.xyz * aoColor.xyz;\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * texture2D( tAO, vUv ).xyz;\n#endif\n}\nif( enableSpecular )\nspecularTex = texture2D( tSpecular, vUv ).xyz;\nmat3 tsb = mat3( normalize( vTangent ), normalize( vBinormal ), normalize( vNormal ) );\nvec3 finalNormal = tsb * normalTex;\n#ifdef FLIP_SIDED\nfinalNormal = -finalNormal;\n#endif\nvec3 normal = normalize( finalNormal );\nvec3 viewPosition = normalize( vViewPosition );\n#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 pointVector = lPosition.xyz + vViewPosition.xyz;\nfloat pointDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\npointDistance = 1.0 - min( ( length( pointVector ) / pointLightDistance[ i ] ), 1.0 );\npointVector = normalize( pointVector );\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dot( normal, pointVector ), 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dot( normal, pointVector ) + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );\n#endif\npointDiffuse += pointDistance * pointLightColor[ i ] * uDiffuseColor * pointDiffuseWeight;\nvec3 pointHalfVector = normalize( pointVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = specularTex.r * max( pow( pointDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( pointVector, pointHalfVector ), 5.0 );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * pointDistance * specularNormalization;\n#else\npointSpecular += pointDistance * pointLightColor[ i ] * uSpecularColor * pointSpecularWeight * pointDiffuseWeight;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvec3 spotDiffuse = vec3( 0.0 );\nvec3 spotSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 spotVector = lPosition.xyz + vViewPosition.xyz;\nfloat spotDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nspotDistance = 1.0 - min( ( length( spotVector ) / spotLightDistance[ i ] ), 1.0 );\nspotVector = normalize( spotVector );\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\n#ifdef WRAP_AROUND\nfloat spotDiffuseWeightFull = max( dot( normal, spotVector ), 0.0 );\nfloat spotDiffuseWeightHalf = max( 0.5 * dot( normal, spotVector ) + 0.5, 0.0 );\nvec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n#else\nfloat spotDiffuseWeight = max( dot( normal, spotVector ), 0.0 );\n#endif\nspotDiffuse += spotDistance * spotLightColor[ i ] * uDiffuseColor * spotDiffuseWeight * spotEffect;\nvec3 spotHalfVector = normalize( spotVector + viewPosition );\nfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\nfloat spotSpecularWeight = specularTex.r * max( pow( spotDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( spotVector, spotHalfVector ), 5.0 );\nspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * spotDistance * specularNormalization * spotEffect;\n#else\nspotSpecular += spotDistance * spotLightColor[ i ] * uSpecularColor * spotSpecularWeight * spotDiffuseWeight * spotEffect;\n#endif\n}\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\n#ifdef WRAP_AROUND\nfloat directionalLightWeightingFull = max( dot( normal, dirVector ), 0.0 );\nfloat directionalLightWeightingHalf = max( 0.5 * dot( normal, dirVector ) + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( directionalLightWeightingFull ), vec3( directionalLightWeightingHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );\n#endif\ndirDiffuse += directionalLightColor[ i ] * uDiffuseColor * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = specularTex.r * max( pow( dirDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n#else\ndirSpecular += directionalLightColor[ i ] * uSpecularColor * dirSpecularWeight * dirDiffuseWeight;\n#endif\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nvec3 hemiDiffuse  = vec3( 0.0 );\nvec3 hemiSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\nhemiDiffuse += uDiffuseColor * hemiColor;\nvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\nfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\nfloat hemiSpecularWeightSky = specularTex.r * max( pow( hemiDotNormalHalfSky, uShininess ), 0.0 );\nvec3 lVectorGround = -lVector;\nvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\nfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\nfloat hemiSpecularWeightGround = specularTex.r * max( pow( hemiDotNormalHalfGround, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat dotProductGround = dot( normal, lVectorGround );\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlickSky = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );\nvec3 schlickGround = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );\nhemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n#else\nhemiSpecular += uSpecularColor * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;\n#endif\n}\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#if MAX_HEMI_LIGHTS > 0\ntotalDiffuse += hemiDiffuse;\ntotalSpecular += hemiSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\n#if MAX_SPOT_LIGHTS > 0\ntotalDiffuse += spotDiffuse;\ntotalSpecular += spotSpecular;\n#endif\n#ifdef METAL\ngl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor + totalSpecular );\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor ) + totalSpecular;\n#endif\nif ( enableReflection ) {\nvec3 vReflect;\nvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\nif ( useRefract ) {\nvReflect = refract( cameraToVertex, normal, uRefractionRatio );\n} else {\nvReflect = reflect( cameraToVertex, normal );\n}\nvec4 cubeColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularTex.r * uReflectivity );\n}",
b.g.Xi,b.g.xk,b.g.Xg,"}"].join("\n"),O:["attribute vec4 tangent;\nuniform vec2 uOffset;\nuniform vec2 uRepeat;\nuniform bool enableDisplacement;\n#ifdef VERTEX_TEXTURES\nuniform sampler2D tDisplacement;\nuniform float uDisplacementScale;\nuniform float uDisplacementBias;\n#endif\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nvarying vec3 vWorldPosition;\nvarying vec3 vViewPosition;",b.g.cj,b.g.Zi,"void main() {",b.g.bj,b.g.Yk,"#ifdef USE_SKINNING\nvNormal = normalize( normalMatrix * skinnedNormal.xyz );\nvec4 skinnedTangent = skinMatrix * vec4( tangent.xyz, 0.0 );\nvTangent = normalize( normalMatrix * skinnedTangent.xyz );\n#else\nvNormal = normalize( normalMatrix * normal );\nvTangent = normalize( normalMatrix * tangent.xyz );\n#endif\nvBinormal = normalize( cross( vNormal, vTangent ) * tangent.w );\nvUv = uv * uRepeat + uOffset;\nvec3 displacedPosition;\n#ifdef VERTEX_TEXTURES\nif ( enableDisplacement ) {\nvec3 dv = texture2D( tDisplacement, uv ).xyz;\nfloat df = uDisplacementScale * dv.x + uDisplacementBias;\ndisplacedPosition = position + normalize( normal ) * df;\n} else {\n#ifdef USE_SKINNING\nvec4 skinVertex = vec4( position, 1.0 );\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned \t  += boneMatY * skinVertex * skinWeight.y;\ndisplacedPosition  = skinned.xyz;\n#else\ndisplacedPosition = position;\n#endif\n}\n#else\n#ifdef USE_SKINNING\nvec4 skinVertex = vec4( position, 1.0 );\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned \t  += boneMatY * skinVertex * skinWeight.y;\ndisplacedPosition  = skinned.xyz;\n#else\ndisplacedPosition = position;\n#endif\n#endif\nvec4 mvPosition = modelViewMatrix * vec4( displacedPosition, 1.0 );\nvec4 worldPosition = modelMatrix * vec4( displacedPosition, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\nvWorldPosition = worldPosition.xyz;\nvViewPosition = -mvPosition.xyz;\n#ifdef USE_SHADOWMAP\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n}\n#endif\n}"].join("\n")},
RB:{N:{as:{type:"t",value:null},eH:{type:"f",value:-1}},O:"varying vec3 vWorldPosition;\nvoid main() {\nvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\nvWorldPosition = worldPosition.xyz;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",L:"uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\nvoid main() {\ngl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n}"},Am:{N:{},O:[b.g.Ci,b.g.cj,"void main() {",
b.g.bj,b.g.Di,b.g.Xk,b.g.ei,"}"].join("\n"),L:"vec4 pack_depth( const in float depth ) {\nconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\nconst vec4 bit_mask  = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\nvec4 res = fract( depth * bit_shift );\nres -= res.xxyz * bit_mask;\nreturn res;\n}\nvoid main() {\ngl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\n}"}};b.Mt=function(a){function e(a){var b=a.Ob;if(void 0!==b){a.Ob=void 0;var c,e,d=!1;a=0;for(c=Ga.length;c>
a;a++)if(e=Ga[a],e.Ob===b){e.mo--;0===e.mo&&(d=!0);break}if(!0===d){d=[];a=0;for(c=Ga.length;c>a;a++)e=Ga[a],e.Ob!==b&&d.push(e);Ga=d;n.deleteProgram(b);T.info.memory.lr--}}}function c(a){a=a.target;a.removeEventListener("dispose",c);e(a)}function d(a){a=a.target;a.removeEventListener("dispose",d);if(a&&a.Bc)if(n.deleteTexture(a.Bc),a instanceof b.Ff)for(var c=0;6>c;c++)n.deleteFramebuffer(a.fe[c]),n.deleteRenderbuffer(a.ie[c]);else n.deleteFramebuffer(a.fe),n.deleteRenderbuffer(a.ie);T.info.memory.ka--}
function f(a){a=a.target;a.removeEventListener("dispose",f);a.R&&a.R.Nh?n.deleteTexture(a.R.Nh):a.ge&&(a.ge=!1,n.deleteTexture(a.Bc));T.info.memory.ka--}function g(a){a=a.target;a.removeEventListener("dispose",g);if(a.ge=void 0,void 0!==a.rb&&n.deleteBuffer(a.rb),void 0!==a.he&&n.deleteBuffer(a.he),void 0!==a.Hj&&n.deleteBuffer(a.Hj),void 0!==a.zc&&n.deleteBuffer(a.zc),void 0!==a.Jj&&n.deleteBuffer(a.Jj),void 0!==a.Ij&&n.deleteBuffer(a.Ij),void 0!==a.Fj&&n.deleteBuffer(a.Fj),void 0!==a.Gj&&n.deleteBuffer(a.Gj),
void 0!==a.Cj&&n.deleteBuffer(a.Cj),void 0!==a.Dj&&n.deleteBuffer(a.Dj),void 0!==a.Ej&&n.deleteBuffer(a.Ej),void 0!==a.cb)for(var b in a.cb){var c=a.cb[b];if(void 0!==c.Zf)for(var e=0,d=c.Zf;d>e;e++)n.deleteBuffer(c.Bg[e]);if(void 0!==c.Yf)for(e=0,d=c.Yf;d>e;e++)n.deleteBuffer(c.Lh[e]);h(c)}h(a);T.info.memory.na--}function h(a){if(a.Wb)for(var b in a.Wb)n.deleteBuffer(a.Wb[b].buffer)}function k(a,b){var c=a.c.length,e=b.n;if(e.attributes){void 0===a.Wb&&(a.Wb=[]);for(var d in e.attributes){var f=
e.attributes[d];if(!f.Sl||f.vv){f.Sl=!0;var g=1;"v2"===f.type?g=2:"v3"===f.type?g=3:"v4"===f.type?g=4:"c"===f.type&&(g=3);f.size=g;f.b=new Float32Array(c*g);f.buffer=n.createBuffer();f.buffer.Sj=d;f.ea=!0}a.Wb.push(f)}}}function l(a,b){var c=b.l,e=a.dk,d=a.ek,f=3*e.length+4*d.length,g=1*e.length+2*d.length,d=3*e.length+4*d.length,e=m(b,a),h=p(e),l=q(e),k=e.m?e.m:!1;a.Ie=new Float32Array(3*f);l&&(a.yj=new Float32Array(3*f));c.eh&&(a.np=new Float32Array(4*f));k&&(a.He=new Float32Array(3*f));h&&((0<
c.jd.length||0<c.C.length)&&(a.pp=new Float32Array(2*f)),(1<c.jd.length||1<c.C.length)&&(a.op=new Float32Array(2*f)));b.l.of.length&&b.l.nf.length&&(a.lp=new Float32Array(4*f),a.mp=new Float32Array(4*f));a.fp=new Uint16Array(3*g);a.hp=new Uint16Array(2*d);if(a.Zf)for(a.jp=[],c=0,h=a.Zf;h>c;c++)a.jp.push(new Float32Array(3*f));if(a.Yf)for(a.ip=[],c=0,h=a.Yf;h>c;c++)a.ip.push(new Float32Array(3*f));if(a.Ql=3*g,a.Tl=2*d,e.attributes){void 0===a.Wb&&(a.Wb=[]);for(var E in e.attributes){var g=e.attributes[E],
c={},y;for(y in g)c[y]=g[y];if(!c.Sl||c.vv)c.Sl=!0,d=1,"v2"===c.type?d=2:"v3"===c.type?d=3:"v4"===c.type?d=4:"c"===c.type&&(d=3),c.size=d,c.b=new Float32Array(f*d),c.buffer=n.createBuffer(),c.buffer.Sj=E,g.ea=!0,c.Rt=g;a.Wb.push(c)}}a.gp=!0}function m(a,c){return a.n instanceof b.gc?a.n.ja[c.Ca]:a.n}function q(a){return a instanceof b.Za&&!a.pa||a instanceof b.ce?!1:a&&void 0!==a.ua&&a.ua===b.wc?b.wc:b.wf}function p(a){return a.map||a.Ta||a.Xb||a.wb||a.Qa||a instanceof b.Ra?!0:!1}function r(a){Sa[a]||
(n.enableVertexAttribArray(a),Sa[a]=!0)}function v(){for(var a in Sa)Sa[a]&&(n.disableVertexAttribArray(a),Sa[a]=!1)}function w(a,b){return a.z!==b.z?b.z-a.z:a.id-b.id}function u(a,b){return b[0]-a[0]}function s(a,b,c){if(a.length)for(var e=0,d=a.length;d>e;e++)va=ea=null,$a=la=Ka=Pa=Ha=$=ya=-1,Ta=!0,a[e].v(b,c,ab,lb),va=ea=null,$a=la=Ka=Pa=Ha=$=ya=-1,Ta=!0}function t(a,c,e,d,f,g,h,l){var k,n,m,E,p;c?(n=a.length-1,E=-1,p=-1):(n=0,E=a.length,p=1);for(var y=n;y!==E;y+=p)if(k=a[y],k.v){if(c=k.object,
n=k.buffer,l)m=l;else{if(m=k[e],!m)continue;h&&T.rh(m.Ha,m.blendEquation,m.Kf,m.Jf);T.fg(m.Db);T.Mi(m.Gc);R(m.polygonOffset,m.Hi,m.Ii)}T.Pn(m);n instanceof b.ze?T.Kn(d,f,g,m,n,c):T.Jn(d,f,g,m,n,c)}}function A(a,b,c,e,d,f,g){for(var h,l,k,n=0,m=a.length;m>n;n++)if(h=a[n],l=h.object,l.visible){if(g)k=g;else{if(k=h[b],!k)continue;f&&T.rh(k.Ha,k.blendEquation,k.Kf,k.Jf);T.fg(k.Db);T.Mi(k.Gc);R(k.polygonOffset,k.Hi,k.Ii)}T.Ln(c,e,d,k,l)}}function Q(a,c){var e,d,f,h;if(void 0===a.ge&&(a.ge=!0,a.Tc=new b.K,
a.$l=new b.Ad,void 0!==a.l&&void 0===a.l.ge&&(a.l.ge=!0,a.l.addEventListener("dispose",g)),d=a.l,void 0!==d))if(d instanceof b.ze){h=d;var m,E,p;for(m in h.attributes)p="index"===m?n.ELEMENT_ARRAY_BUFFER:n.ARRAY_BUFFER,E=h.attributes[m],E.buffer=n.createBuffer(),n.bindBuffer(p,E.buffer),n.bufferData(p,E.b,n.STATIC_DRAW)}else if(a instanceof b.J){f=a.n;if(void 0===d.cb){m=d;var y,q,r,u,aa;E={};p=m.B.length;var D=m.sa.length,xa=f instanceof b.gc;m.cb={};f=0;for(y=m.j.length;y>f;f++)q=m.j[f],r=xa?q.Ca:
0,void 0===E[r]&&(E[r]={hash:r,Yj:0}),aa=E[r].hash+"_"+E[r].Yj,void 0===m.cb[aa]&&(m.cb[aa]={dk:[],ek:[],Ca:r,c:0,Zf:p,Yf:D}),u=q instanceof b.S?3:4,65535<m.cb[aa].c+u&&(E[r].Yj+=1,aa=E[r].hash+"_"+E[r].Yj,void 0===m.cb[aa]&&(m.cb[aa]={dk:[],ek:[],Ca:r,c:0,Zf:p,Yf:D})),q instanceof b.S?m.cb[aa].dk.push(f):m.cb[aa].ek.push(f),m.cb[aa].c+=u;m.Qm=[];for(h in m.cb)m.cb[h].id=Oa++,m.Qm.push(m.cb[h])}for(e in d.cb)if(h=d.cb[e],!h.rb){m=h;m.rb=n.createBuffer();m.he=n.createBuffer();m.Hj=n.createBuffer();
m.zc=n.createBuffer();m.Jj=n.createBuffer();m.Ij=n.createBuffer();m.Fj=n.createBuffer();m.Gj=n.createBuffer();m.Cj=n.createBuffer();m.Dj=n.createBuffer();p=E=void 0;if(m.Zf)for(m.Bg=[],E=0,p=m.Zf;p>E;E++)m.Bg.push(n.createBuffer());if(m.Yf)for(m.Lh=[],E=0,p=m.Yf;p>E;E++)m.Lh.push(n.createBuffer());T.info.memory.na++;l(h,a);d.Xa=!0;d.qn=!0;d.li=!0;d.kl=!0;d.Sd=!0;d.fj=!0;d.Mb=!0}}else a instanceof b.De?d.rb||(h=d,h.rb=n.createBuffer(),h.zc=n.createBuffer(),h.he=n.createBuffer(),T.info.memory.na++,
h=d,m=h.c.length,h.Ie=new Float32Array(3*m),h.He=new Float32Array(3*m),h.yj=new Float32Array(3*m),h.$t=m,k(h,a),d.Xa=!0,d.Mb=!0,d.Sd=!0):a instanceof b.Na?d.rb||(h=d,h.rb=n.createBuffer(),h.zc=n.createBuffer(),h.Ej=n.createBuffer(),T.info.memory.na++,h=d,m=h.c.length,h.Ie=new Float32Array(3*m),h.He=new Float32Array(3*m),h.Pt=new Float32Array(1*m),h.Tl=m,k(h,a),d.Xa=!0,d.Mb=!0,d.wk=!0):a instanceof b.Tb&&!d.rb&&(h=d,h.rb=n.createBuffer(),h.zc=n.createBuffer(),T.info.memory.na++,h=d,m=h.c.length,h.Ie=
new Float32Array(3*m),h.He=new Float32Array(3*m),h.Tt=[],h.qp=m,k(h,a),d.Xa=!0,d.Mb=!0);if(void 0===a.Pl){if(a instanceof b.J)if(d=a.l,d instanceof b.ze)O(c.Ac,d,a);else{if(d instanceof b.H)for(e in d.cb)h=d.cb[e],O(c.Ac,h,a)}else a instanceof b.De||a instanceof b.Na||a instanceof b.Tb?(d=a.l,O(c.Ac,d,a)):a instanceof b.ul||a.Wm?c.Je.push({object:a,ag:null,U:null}):a instanceof b.Df?c.Ul.push(a):a instanceof b.wg&&c.Rl.push(a);a.Pl=!0}}function O(a,b,c){a.push({buffer:b,object:c,ag:null,U:null})}
function P(a){for(var b in a.attributes)if(a.attributes[b].ea)return!0;return!1}function I(a){for(var b in a.attributes)a.attributes[b].ea=!1}function F(a,c){a instanceof b.J||a instanceof b.Tb||a instanceof b.De||a instanceof b.Na?L(c.Ac,a):a instanceof b.Df?K(c.Ul,a):a instanceof b.wg?K(c.Rl,a):(a instanceof b.ul||a.Wm)&&L(c.Je,a);delete a.Pl}function L(a,b){for(var c=a.length-1;0<=c;c--)a[c].object===b&&a.splice(c,1)}function K(a,b){for(var c=a.length-1;0<=c;c--)a[c]===b&&a.splice(c,1)}function N(a,
c,d,f,g){ka=0;f.ea&&(f.Ob&&e(f),T.Ew(f,c,d,g),f.ea=!1);f.B&&(g.Mh||(g.Mh=new Float32Array(T.zi)));var h=!1,k=f.Ob,l=k.N,m=f.N;if(k!==ea&&(n.useProgram(k),ea=k,h=!0),f.id!==$a&&($a=f.id,h=!0),(h||a!==va)&&(n.uniformMatrix4fv(l.wa,!1,a.wa.elements),a!==va&&(va=a)),f.Ka)if(rb&&g.te){if(null!==l.Ne){var E=B();n.uniform1i(l.Ne,E);T.Oi(g.Ne,E)}}else null!==l.dv&&n.uniformMatrix4fv(l.dv,!1,g.Ph);if(h){d&&f.D&&(m.fk.value=d.color,d instanceof b.Bh?(m.ik.value=d.Ja,m.hk.value=d.Ia):d instanceof b.xf&&(m.gk.value=
d.$j));if(f instanceof b.qb||f instanceof b.hc||f.fb){if(Ta){var p,q,r,aa,u=0,D=0,xa=0,s=Pb,v=s.gi.Oa,t=s.gi.od,w=s.dg.Oa,Z=s.dg.od,A=s.dg.ii,H=s.Mc.Oa,F=s.Mc.od,I=s.Mc.ii,X=s.Mc.Vp,G=s.Mc.Gp,Q=s.Mc.cq,za=s.Qf.Ur,O=s.Qf.xq,L=s.Qf.od,P=0,N=0,K=0,ab=0,J=0,V=0,na=0,lb=0,ja=r=0;d=ja=ja=0;for(h=c.length;h>d;d++)if(p=c[d],!p.ff)if(q=p.color,E=p.ia,r=p.ha,p instanceof b.qf)p.visible&&(T.jc?(u+=q.q*q.q,D+=q.o*q.o,xa+=q.h*q.h):(u+=q.q,D+=q.o,xa+=q.h));else if(p instanceof b.Ib){if(J+=1,p.visible)if(Ja.lb(p.A),
gb.lb(p.target.A),Ja.sub(gb),Ja.normalize(),0!==Ja.x||0!==Ja.y||0!==Ja.z)r=3*P,t[r]=Ja.x,t[r+1]=Ja.y,t[r+2]=Ja.z,T.jc?W(v,r,q,E*E):M(v,r,q,E),P+=1}else if(p instanceof b.Bd){if(V+=1,p.visible)ja=3*N,T.jc?W(w,ja,q,E*E):M(w,ja,q,E),gb.lb(p.A),Z[ja]=gb.x,Z[ja+1]=gb.y,Z[ja+2]=gb.z,A[N]=r,N+=1}else if(p instanceof b.Ee){if(na+=1,p.visible)ja=3*K,T.jc?W(H,ja,q,E*E):M(H,ja,q,E),gb.lb(p.A),F[ja]=gb.x,F[ja+1]=gb.y,F[ja+2]=gb.z,I[K]=r,Ja.copy(gb),gb.lb(p.target.A),Ja.sub(gb),Ja.normalize(),X[ja]=Ja.x,X[ja+
1]=Ja.y,X[ja+2]=Ja.z,G[K]=Math.cos(p.je),Q[K]=p.Mm,K+=1}else p instanceof b.nj&&(lb+=1,p.visible)&&(Ja.lb(p.A),Ja.normalize(),0!==Ja.x||0!==Ja.y||0!==Ja.z)&&(ja=3*ab,L[ja]=Ja.x,L[ja+1]=Ja.y,L[ja+2]=Ja.z,q=p.color,r=p.qi,T.jc?(aa=E*E,W(za,ja,q,aa),W(O,ja,r,aa)):(M(za,ja,q,E),M(O,ja,r,E)),ab+=1);d=3*P;for(h=Math.max(v.length,3*J);h>d;d++)v[d]=0;d=3*N;for(h=Math.max(w.length,3*V);h>d;d++)w[d]=0;d=3*K;for(h=Math.max(H.length,3*na);h>d;d++)H[d]=0;d=3*ab;for(h=Math.max(za.length,3*lb);h>d;d++)za[d]=0;d=
3*ab;for(h=Math.max(O.length,3*lb);h>d;d++)O[d]=0;s.gi.length=P;s.dg.length=N;s.Mc.length=K;s.Qf.length=ab;s.ta[0]=u;s.ta[1]=D;s.ta[2]=xa;Ta=!1}p=Pb;m.Ku.value=p.ta;m.Dv.value=p.gi.Oa;m.Ev.value=p.gi.od;m.ry.value=p.dg.Oa;m.ty.value=p.dg.od;m.sy.value=p.dg.ii;m.uz.value=p.Mc.Oa;m.yz.value=p.Mc.od;m.wz.value=p.Mc.ii;m.vz.value=p.Mc.Vp;m.tz.value=p.Mc.Gp;m.xz.value=p.Mc.cq;m.zw.value=p.Qf.Ur;m.yw.value=p.Qf.xq;m.xw.value=p.Qf.od}if(f instanceof b.Za||f instanceof b.hc||f instanceof b.qb){m.opacity.value=
f.opacity;T.jc?m.Re.value.Qg(f.color):m.Re.value=f.color;m.map.value=f.map;m.Ta.value=f.Ta;m.Qa.value=f.Qa;f.Xb&&(m.Xb.value=f.Xb,m.Lg.value=f.Lg);f.wb&&(m.wb.value=f.wb,m.df.value.copy(f.df));var U;if(f.map?U=f.map:f.Qa?U=f.Qa:f.wb?U=f.wb:f.Xb&&(U=f.Xb),void 0!==U)p=U.offset,U=U.repeat,m.Yx.value.set(p.x,p.y,U.x,U.y);m.pa.value=f.pa;m.$v.value=f.pa instanceof b.Ff?1:-1;m.Yc.value=f.Yc;m.Zc.value=f.Zc;m.Uc.value=f.Uc;m.ys.value=f.pa&&f.pa.Nb instanceof b.Rs}f instanceof b.Pc?(m.Re.value=f.color,m.opacity.value=
f.opacity):f instanceof b.zf?(m.Re.value=f.color,m.opacity.value=f.opacity,m.Qe.value=f.Qe,m.Oz.value=f.Qe+f.ni,m.scale.value=f.scale):f instanceof b.Ce?(m.Cy.value=f.color,m.opacity.value=f.opacity,m.size.value=f.size,m.scale.value=S.height/2,m.map.value=f.map):f instanceof b.qb?(m.Jc.value=f.Jc,T.jc?(m.ta.value.Qg(f.ta),m.Aa.value.Qg(f.Aa),m.Lc.value.Qg(f.Lc)):(m.ta.value=f.ta,m.Aa.value=f.Aa,m.Lc.value=f.Lc),f.yd&&m.cd.value.copy(f.cd)):f instanceof b.hc?(T.jc?(m.ta.value.Qg(f.ta),m.Aa.value.Qg(f.Aa)):
(m.ta.value=f.ta,m.Aa.value=f.Aa),f.yd&&m.cd.value.copy(f.cd)):f instanceof b.ce?(m.qx.value=a.Ja,m.px.value=a.Ia,m.opacity.value=f.opacity):f instanceof b.Ae&&(m.opacity.value=f.opacity);if(g.qh&&!f.Ke&&m.ig)for(p=U=0,aa=c.length;aa>p;p++)d=c[p],d.Lb&&(d instanceof b.Ee||d instanceof b.Ib&&!d.Wn)&&(m.gg.value[U]=d.gg,m.Ti.value[U]=d.Ti,m.ig.value[U]=d.ig,m.lf.value[U]=d.lf,m.th.value[U]=d.th,U++);c=f.vs;var R,Y,Sa,da,m=0;for(U=c.length;U>m;m++)if(aa=k.N[c[m][1]])if(R=c[m][0],Y=R.type,p=R.value,"i"===
Y)n.uniform1i(aa,p);else if("f"===Y)n.uniform1f(aa,p);else if("v2"===Y)n.uniform2f(aa,p.x,p.y);else if("v3"===Y)n.uniform3f(aa,p.x,p.y,p.z);else if("v4"===Y)n.uniform4f(aa,p.x,p.y,p.z,p.f);else if("c"===Y)n.uniform3f(aa,p.q,p.o,p.h);else if("iv1"===Y)n.uniform1iv(aa,p);else if("iv"===Y)n.uniform3iv(aa,p);else if("fv1"===Y)n.uniform1fv(aa,p);else if("fv"===Y)n.uniform3fv(aa,p);else if("v2v"===Y){void 0===R.la&&(R.la=new Float32Array(2*p.length));d=0;for(h=p.length;h>d;d++)E=2*d,R.la[E]=p[d].x,R.la[E+
1]=p[d].y;n.uniform2fv(aa,R.la)}else if("v3v"===Y){void 0===R.la&&(R.la=new Float32Array(3*p.length));d=0;for(h=p.length;h>d;d++)E=3*d,R.la[E]=p[d].x,R.la[E+1]=p[d].y,R.la[E+2]=p[d].z;n.uniform3fv(aa,R.la)}else if("v4v"===Y){void 0===R.la&&(R.la=new Float32Array(4*p.length));d=0;for(h=p.length;h>d;d++)E=4*d,R.la[E]=p[d].x,R.la[E+1]=p[d].y,R.la[E+2]=p[d].z,R.la[E+3]=p[d].f;n.uniform4fv(aa,R.la)}else if("m4"===Y)void 0===R.la&&(R.la=new Float32Array(16)),p.Zv(R.la),n.uniformMatrix4fv(aa,!1,R.la);else if("m4v"===
Y){void 0===R.la&&(R.la=new Float32Array(16*p.length));d=0;for(h=p.length;h>d;d++)p[d].hq(R.la,16*d);n.uniformMatrix4fv(aa,!1,R.la)}else if("t"===Y){if(Sa=p,da=B(),n.uniform1i(aa,da),Sa)if(Sa.R instanceof Array&&6===Sa.R.length){if(p=Sa,aa=da,6===p.R.length)if(p.ea){p.R.Nh||(p.R.Nh=n.createTexture(),T.info.memory.ka++);n.activeTexture(n.TEXTURE0+aa);n.bindTexture(n.TEXTURE_CUBE_MAP,p.R.Nh);n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,p.Nf);aa=p instanceof b.tf;d=[];for(h=0;6>h;h++)E=d,u=h,T.Su&&!aa?(D=p.R[h],
s=kb,D.width<=s&&D.height<=s||(v=Math.max(D.width,D.height),xa=Math.floor(D.width*s/v),s=Math.floor(D.height*s/v),v=document.createElement("canvas"),v.width=xa,v.height=s,D=(v.getContext("2d").drawImage(D,0,0,D.width,D.height,0,0,xa,s),v))):D=p.R[h],E[u]=D;h=d[0];E=C(h.width)&&C(h.height);u=ma(p.ma);D=ma(p.type);y(n.TEXTURE_CUBE_MAP,p,E);for(h=0;6>h;h++)if(aa)for(s=d[h].dc,v=0,t=s.length;t>v;v++)xa=s[v],n.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+h,v,u,xa.width,xa.height,0,xa.data);else n.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+
h,0,u,u,D,d[h]);p.Eb&&E&&n.generateMipmap(n.TEXTURE_CUBE_MAP);p.ea=!1;p.Ik&&p.Ik()}else n.activeTexture(n.TEXTURE0+aa),n.bindTexture(n.TEXTURE_CUBE_MAP,p.R.Nh)}else Sa instanceof b.Ff?(p=Sa,n.activeTexture(n.TEXTURE0+da),n.bindTexture(n.TEXTURE_CUBE_MAP,p.Bc)):T.Oi(Sa,da)}else if("tv"===Y){void 0===R.la&&(R.la=[]);d=0;for(h=R.value.length;h>d;d++)R.la[d]=B();n.uniform1iv(aa,R.la);d=0;for(h=R.value.length;h>d;d++)Sa=R.value[d],da=R.la[d],Sa&&T.Oi(Sa,da)}(f instanceof b.Ra||f instanceof b.qb||f.pa)&&
null!==l.gv&&(gb.lb(a.A),n.uniform3f(l.gv,gb.x,gb.y,gb.z));(f instanceof b.qb||f instanceof b.hc||f instanceof b.Ra||f.Ka)&&null!==l.Zz&&n.uniformMatrix4fv(l.Zz,!1,a.gb.elements)}n.uniformMatrix4fv(l.$q,!1,g.Tc.elements);l.Ux&&n.uniformMatrix3fv(l.Ux,!1,g.$l.elements);return null!==l.Nx&&n.uniformMatrix4fv(l.Nx,!1,g.A.elements),k}function B(){var a=ka;return a>=fc&&console.warn("WebGLRenderer: trying to use "+a+" texture units while this GPU supports only "+fc),ka+=1,a}function W(a,b,c,e){a[b]=c.q*
c.q*e;a[b+1]=c.o*c.o*e;a[b+2]=c.h*c.h*e}function M(a,b,c,e){a[b]=c.q*e;a[b+1]=c.o*e;a[b+2]=c.h*e}function J(a){a!==aa&&(n.lineWidth(a),aa=a)}function R(a,b,c){ta!==a&&(a?n.enable(n.POLYGON_OFFSET_FILL):n.disable(n.POLYGON_OFFSET_FILL),ta=a);!a||Da===b&&E===c||(n.polygonOffset(b,c),Da=b,E=c)}function U(a){a=a.split("\n");for(var b=0,c=a.length;c>b;b++)a[b]=b+1+": "+a[b];return a.join("\n")}function Y(a,b){var c;return"fragment"===a?c=n.createShader(n.FRAGMENT_SHADER):"vertex"===a&&(c=n.createShader(n.VERTEX_SHADER)),
n.shaderSource(c,b),n.compileShader(c),n.getShaderParameter(c,n.COMPILE_STATUS)?c:(console.error(n.getShaderInfoLog(c)),console.error(U(b)),null)}function C(a){return 0===(a&a-1)}function y(a,c,e){e?(n.texParameteri(a,n.TEXTURE_WRAP_S,ma(c.pc)),n.texParameteri(a,n.TEXTURE_WRAP_T,ma(c.qc)),n.texParameteri(a,n.TEXTURE_MAG_FILTER,ma(c.Gb)),n.texParameteri(a,n.TEXTURE_MIN_FILTER,ma(c.nb))):(n.texParameteri(a,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(a,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(a,
n.TEXTURE_MAG_FILTER,Z(c.Gb)),n.texParameteri(a,n.TEXTURE_MIN_FILTER,Z(c.nb)));Ca&&c.type!==b.sl&&(1<c.ic||c.Qt)&&(n.texParameterf(a,Ca.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(c.ic,qb)),c.Qt=c.ic)}function D(a,b){n.bindRenderbuffer(n.RENDERBUFFER,a);b.Jd&&!b.ud?(n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,b.width,b.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,a)):b.Jd&&b.ud?(n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,b.width,b.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,
n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,a)):n.renderbufferStorage(n.RENDERBUFFER,n.RGBA4,b.width,b.height)}function Z(a){return a===b.Be||a===b.Ho||a===b.Go?n.NEAREST:n.LINEAR}function ma(a){if(a===b.ed)return n.REPEAT;if(a===b.sf)return n.CLAMP_TO_EDGE;if(a===b.Al)return n.MIRRORED_REPEAT;if(a===b.Be)return n.NEAREST;if(a===b.Ho)return n.NEAREST_MIPMAP_NEAREST;if(a===b.Go)return n.NEAREST_MIPMAP_LINEAR;if(a===b.ae)return n.LINEAR;if(a===b.et)return n.LINEAR_MIPMAP_NEAREST;if(a===b.yl)return n.LINEAR_MIPMAP_LINEAR;
if(a===b.Ll)return n.UNSIGNED_BYTE;if(a===b.It)return n.UNSIGNED_SHORT_4_4_4_4;if(a===b.Jt)return n.UNSIGNED_SHORT_5_5_5_1;if(a===b.Kt)return n.UNSIGNED_SHORT_5_6_5;if(a===b.Ks)return n.BYTE;if(a===b.xt)return n.SHORT;if(a===b.Lt)return n.UNSIGNED_SHORT;if(a===b.bt)return n.INT;if(a===b.Ht)return n.UNSIGNED_INT;if(a===b.sl)return n.FLOAT;if(a===b.Gs)return n.ALPHA;if(a===b.Fl)return n.RGB;if(a===b.Bf)return n.RGBA;if(a===b.gt)return n.LUMINANCE;if(a===b.ft)return n.LUMINANCE_ALPHA;if(a===b.oo)return n.FUNC_ADD;
if(a===b.Ct)return n.FUNC_SUBTRACT;if(a===b.ut)return n.FUNC_REVERSE_SUBTRACT;if(a===b.Nt)return n.ZERO;if(a===b.mt)return n.ONE;if(a===b.Bt)return n.SRC_COLOR;if(a===b.pt)return n.ONE_MINUS_SRC_COLOR;if(a===b.Zo)return n.SRC_ALPHA;if(a===b.Io)return n.ONE_MINUS_SRC_ALPHA;if(a===b.Ws)return n.DST_ALPHA;if(a===b.nt)return n.ONE_MINUS_DST_ALPHA;if(a===b.Xs)return n.DST_COLOR;if(a===b.ot)return n.ONE_MINUS_DST_COLOR;if(a===b.At)return n.SRC_ALPHA_SATURATE;if(void 0!==V){if(a===b.Po)return V.COMPRESSED_RGB_S3TC_DXT1_EXT;
if(a===b.st)return V.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(a===b.No)return V.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(a===b.Oo)return V.COMPRESSED_RGBA_S3TC_DXT5_EXT}return 0}console.log("THREE.WebGLRenderer",b.El);a=a||{};var S=void 0!==a.canvas?a.canvas:document.createElement("canvas"),G=void 0!==a.precision?a.precision:"highp",na=void 0!==a.alpha?a.alpha:!0,Ba=void 0!==a.premultipliedAlpha?a.premultipliedAlpha:!0,wa=void 0!==a.antialias?a.antialias:!1,ja=void 0!==a.stencil?a.stencil:!0,eb=void 0!==a.preserveDrawingBuffer?
a.preserveDrawingBuffer:!1,da=new b.k(0),ha=0;void 0!==a.clearColor&&(console.warn("DEPRECATED: clearColor in WebGLRenderer constructor parameters is being removed. Use .setClearColor() instead."),da.sd(a.clearColor));void 0!==a.sm&&(console.warn("DEPRECATED: clearAlpha in WebGLRenderer constructor parameters is being removed. Use .setClearColor() instead."),ha=a.sm);this.hd=S;this.Mf=null;this.devicePixelRatio=void 0!==a.devicePixelRatio?a.devicePixelRatio:void 0!==window.devicePixelRatio?window.devicePixelRatio:
1;this.Uu=this.$k=this.Ru=this.Qu=this.Pu=this.Me=!0;this.hg=this.oh=this.$g=this.jc=!1;this.lz=!0;this.Ui=b.Jo;this.Pr=b.lj;this.Uk=this.Vk=!1;this.zi=8;this.Dk=4;this.Su=!0;this.sr=[];this.rr=[];this.info={memory:{lr:0,na:0,ka:0},v:{le:0,c:0,j:0,M:0}};var n,pa,fb,Ca,V,T=this,Ga=[],ra=0,ea=null,bb=null,$a=-1,la=null,va=null,Oa=0,ka=0,Pa=-1,Ka=-1,ya=-1,ia=-1,sa=-1,La=-1,$=-1,Ha=-1,ta=null,Da=null,E=null,aa=null,xa=0,H=0,X=0,za=0,ab=0,lb=0,Sa={},hb=new b.yf,xb=new b.K,Pc=new b.K,gb=new b.a,Ja=new b.a,
Ta=!0,Pb={ta:[0,0,0],gi:{length:0,Oa:[],od:[]},dg:{length:0,Oa:[],od:[],ii:[]},Mc:{length:0,Oa:[],od:[],ii:[],Vp:[],Gp:[],cq:[]},Qf:{length:0,Ur:[],xq:[],od:[]}};(function(){try{if(!(n=S.getContext("experimental-webgl",{alpha:na,premultipliedAlpha:Ba,antialias:wa,stencil:ja,preserveDrawingBuffer:eb})))throw"Error creating WebGL context.";}catch(a){console.error(a)}pa=n.getExtension("OES_texture_float");fb=n.getExtension("OES_standard_derivatives");Ca=n.getExtension("EXT_texture_filter_anisotropic")||
n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");V=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");pa||console.log("THREE.WebGLRenderer: Float textures not supported.");fb||console.log("THREE.WebGLRenderer: Standard derivatives not supported.");Ca||console.log("THREE.WebGLRenderer: Anisotropic texture filtering not supported.");V||
console.log("THREE.WebGLRenderer: S3TC compressed textures not supported.");void 0===n.getShaderPrecisionFormat&&(n.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})})();n.clearColor(0,0,0,1);n.clearDepth(1);n.clearStencil(0);n.enable(n.DEPTH_TEST);n.depthFunc(n.LEQUAL);n.frontFace(n.CCW);n.cullFace(n.BACK);n.enable(n.CULL_FACE);n.enable(n.BLEND);n.blendEquation(n.FUNC_ADD);n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA);n.clearColor(da.q,da.o,da.h,ha);this.Mf=n;var fc=
n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),kb=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),qb=Ca?n.getParameter(Ca.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,Xb=0<n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),rb=Xb&&pa;V||[];var Wb=n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT);a=n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT);Wb=0<n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision&&0<Wb.precision;a=0<n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision&&
0<a.precision;"highp"!==G||Wb||(a?(G="mediump",console.warn("WebGLRenderer: highp not supported, using mediump")):(G="lowp",console.warn("WebGLRenderer: highp and mediump not supported, using lowp")));"mediump"!==G||a||(G="lowp",console.warn("WebGLRenderer: mediump not supported, using lowp"));this.getContext=function(){return n};this.Gz=function(){return Xb};this.cH=function(){return pa};this.dH=function(){return fb};this.bH=function(){return V};this.kw=function(){return qb};this.tq=function(){return G};
this.Qn=function(a,b,c){S.width=a*this.devicePixelRatio;S.height=b*this.devicePixelRatio;1!==this.devicePixelRatio&&!1!==c&&(S.style.width=a+"px",S.style.height=b+"px");this.fz(S.width,S.height)};this.fz=function(a,b){H=xa=0;X=void 0!==a?a:S.width;za=void 0!==b?b:S.height;n.viewport(xa,H,X,za)};this.HG=function(a,b,c,e){n.scissor(a,b,c,e)};this.BC=function(a){a?n.enable(n.SCISSOR_TEST):n.disable(n.SCISSOR_TEST)};this.Ok=function(a,b){da.set(a);ha=void 0!==b?b:1;n.clearColor(da.q,da.o,da.h,ha)};this.Wy=
function(a,b){console.warn("DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead.");this.Ok(a,b)};this.oq=function(){return da};this.nq=function(){return ha};this.clear=function(a,b,c){var e=0;(void 0===a||a)&&(e|=n.COLOR_BUFFER_BIT);(void 0===b||b)&&(e|=n.DEPTH_BUFFER_BIT);(void 0===c||c)&&(e|=n.STENCIL_BUFFER_BIT);n.clear(e)};this.HB=function(a,b,c,e){this.Rk(a);this.clear(b,c,e)};this.Cp=function(a){a.si(this);this.rr.push(a)};this.Fu=function(a){a.si(this);this.sr.push(a)};
this.GH=function(a,b){ea=null;$a=la=Ha=$=ya=-1;Ta=!0;Ka=Pa=-1;this.Qr.update(a,b)};this.Ky=function(a,c,e){if(a.vw&&!a.rb&&(a.rb=n.createBuffer()),a.uw&&!a.he&&(a.he=n.createBuffer()),a.ww&&!a.rp&&(a.rp=n.createBuffer()),a.tw&&!a.zc&&(a.zc=n.createBuffer()),a.vw&&(n.bindBuffer(n.ARRAY_BUFFER,a.rb),n.bufferData(n.ARRAY_BUFFER,a.UF,n.DYNAMIC_DRAW),n.enableVertexAttribArray(c.attributes.position),n.vertexAttribPointer(c.attributes.position,3,n.FLOAT,!1,0,0)),a.uw){if(n.bindBuffer(n.ARRAY_BUFFER,a.he),
e.ua===b.wf){var d,f,g,h,l,k,m,p,E,y,q,r=3*a.count;for(q=0;r>q;q+=9)y=a.Tx,d=y[q],f=y[q+1],g=y[q+2],h=y[q+3],k=y[q+4],p=y[q+5],l=y[q+6],m=y[q+7],E=y[q+8],d=(d+h+l)/3,f=(f+k+m)/3,g=(g+p+E)/3,y[q]=d,y[q+1]=f,y[q+2]=g,y[q+3]=d,y[q+4]=f,y[q+5]=g,y[q+6]=d,y[q+7]=f,y[q+8]=g}n.bufferData(n.ARRAY_BUFFER,a.Tx,n.DYNAMIC_DRAW);n.enableVertexAttribArray(c.attributes.s);n.vertexAttribPointer(c.attributes.s,3,n.FLOAT,!1,0,0)}a.ww&&e.map&&(n.bindBuffer(n.ARRAY_BUFFER,a.rp),n.bufferData(n.ARRAY_BUFFER,a.KH,n.DYNAMIC_DRAW),
n.enableVertexAttribArray(c.attributes.Pb),n.vertexAttribPointer(c.attributes.Pb,2,n.FLOAT,!1,0,0));a.tw&&e.m!==b.Fh&&(n.bindBuffer(n.ARRAY_BUFFER,a.zc),n.bufferData(n.ARRAY_BUFFER,a.JB,n.DYNAMIC_DRAW),n.enableVertexAttribArray(c.attributes.color),n.vertexAttribPointer(c.attributes.color,3,n.FLOAT,!1,0,0));n.drawArrays(n.TRIANGLES,0,a.count);a.count=0};this.Kn=function(a,c,e,d,f,g){if(!1!==d.visible){var h,l,k,m,p;h=N(a,c,e,d,g);a=h.attributes;c=f.attributes;e=!1;h=16777215*f.id+2*h.id+(d.I?1:0);
if(h!==la&&(la=h,e=!0),e&&v(),g instanceof b.J)if(d=c.index)for(f=f.vn,1<f.length&&(e=!0),g=0,h=f.length;h>g;g++){var E=f[g].index;if(e){for(k in c)"index"!==k&&(m=a[k],l=c[k],p=l.vi,0<=m&&(n.bindBuffer(n.ARRAY_BUFFER,l.buffer),r(m),n.vertexAttribPointer(m,p,n.FLOAT,!1,0,4*E*p)));n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,d.buffer)}n.drawElements(n.TRIANGLES,f[g].count,n.UNSIGNED_SHORT,2*f[g].start);T.info.v.le++;T.info.v.c+=f[g].count;T.info.v.j+=f[g].count/3}else{if(e)for(k in c)"index"!==k&&(m=a[k],l=
c[k],p=l.vi,0<=m&&(n.bindBuffer(n.ARRAY_BUFFER,l.buffer),r(m),n.vertexAttribPointer(m,p,n.FLOAT,!1,0,0)));l=f.attributes.position;n.drawArrays(n.TRIANGLES,0,l.ef/3);T.info.v.le++;T.info.v.c+=l.ef/3;T.info.v.j+=l.ef/3/3}else if(g instanceof b.Tb){if(e){for(k in c)m=a[k],l=c[k],p=l.vi,0<=m&&(n.bindBuffer(n.ARRAY_BUFFER,l.buffer),r(m),n.vertexAttribPointer(m,p,n.FLOAT,!1,0,0));l=c.position;n.drawArrays(n.POINTS,0,l.ef/3);T.info.v.le++;T.info.v.M+=l.ef/3}}else if(g instanceof b.Na&&e){for(k in c)m=a[k],
l=c[k],p=l.vi,0<=m&&(n.bindBuffer(n.ARRAY_BUFFER,l.buffer),r(m),n.vertexAttribPointer(m,p,n.FLOAT,!1,0,0));J(d.Xc);l=c.position;n.drawArrays(n.LINE_STRIP,0,l.ef/3);T.info.v.le++;T.info.v.M+=l.ef}}};this.Jn=function(a,c,e,d,f,g){if(!1!==d.visible){var h,l,k;e=N(a,c,e,d,g);a=e.attributes;c=!1;e=16777215*f.id+2*e.id+(d.I?1:0);e!==la&&(la=e,c=!0);c&&v();if(!d.B&&0<=a.position)c&&(n.bindBuffer(n.ARRAY_BUFFER,f.rb),r(a.position),n.vertexAttribPointer(a.position,3,n.FLOAT,!1,0,0));else if(g.pn){e=d.Ob.attributes;
if(-1!==g.pn&&0<=e.position?(n.bindBuffer(n.ARRAY_BUFFER,f.Bg[g.pn]),r(e.position),n.vertexAttribPointer(e.position,3,n.FLOAT,!1,0,0)):0<=e.position&&(n.bindBuffer(n.ARRAY_BUFFER,f.rb),r(e.position),n.vertexAttribPointer(e.position,3,n.FLOAT,!1,0,0)),g.ar.length){var m=0;l=g.ar;for(k=g.md;m<d.Ei&&m<l.length;)0<=e["morphTarget"+m]&&(n.bindBuffer(n.ARRAY_BUFFER,f.Bg[l[m]]),r(e["morphTarget"+m]),n.vertexAttribPointer(e["morphTarget"+m],3,n.FLOAT,!1,0,0)),0<=e["morphNormal"+m]&&d.sa&&(n.bindBuffer(n.ARRAY_BUFFER,
f.Lh[l[m]]),r(e["morphNormal"+m]),n.vertexAttribPointer(e["morphNormal"+m],3,n.FLOAT,!1,0,0)),g.Mh[m]=k[l[m]],m++}else{var p,E=[];k=g.md;var y=k.length;for(p=0;y>p;p++)m=k[p],0<m&&E.push([m,p]);E.length>d.Ei?(E.sort(u),E.length=d.Ei):E.length>d.dr?E.sort(u):0===E.length&&E.push([0,0]);for(m=0;m<d.Ei;)E[m]?(l=E[m][1],0<=e["morphTarget"+m]&&(n.bindBuffer(n.ARRAY_BUFFER,f.Bg[l]),r(e["morphTarget"+m]),n.vertexAttribPointer(e["morphTarget"+m],3,n.FLOAT,!1,0,0)),0<=e["morphNormal"+m]&&d.sa&&(n.bindBuffer(n.ARRAY_BUFFER,
f.Lh[l]),r(e["morphNormal"+m]),n.vertexAttribPointer(e["morphNormal"+m],3,n.FLOAT,!1,0,0)),g.Mh[m]=k[l]):g.Mh[m]=0,m++}null!==d.Ob.N.md&&n.uniform1fv(d.Ob.N.md,g.Mh)}if(c){if(f.Wb)for(e=0,k=f.Wb.length;k>e;e++)l=f.Wb[e],0<=a[l.buffer.Sj]&&(n.bindBuffer(n.ARRAY_BUFFER,l.buffer),r(a[l.buffer.Sj]),n.vertexAttribPointer(a[l.buffer.Sj],l.size,n.FLOAT,!1,0,0));0<=a.color&&(n.bindBuffer(n.ARRAY_BUFFER,f.zc),r(a.color),n.vertexAttribPointer(a.color,3,n.FLOAT,!1,0,0));0<=a.s&&(n.bindBuffer(n.ARRAY_BUFFER,
f.he),r(a.s),n.vertexAttribPointer(a.s,3,n.FLOAT,!1,0,0));0<=a.ej&&(n.bindBuffer(n.ARRAY_BUFFER,f.Hj),r(a.ej),n.vertexAttribPointer(a.ej,4,n.FLOAT,!1,0,0));0<=a.Pb&&(n.bindBuffer(n.ARRAY_BUFFER,f.Jj),r(a.Pb),n.vertexAttribPointer(a.Pb,2,n.FLOAT,!1,0,0));0<=a.zs&&(n.bindBuffer(n.ARRAY_BUFFER,f.Ij),r(a.zs),n.vertexAttribPointer(a.zs,2,n.FLOAT,!1,0,0));d.Ka&&0<=a.Rr&&0<=a.Sr&&(n.bindBuffer(n.ARRAY_BUFFER,f.Fj),r(a.Rr),n.vertexAttribPointer(a.Rr,4,n.FLOAT,!1,0,0),n.bindBuffer(n.ARRAY_BUFFER,f.Gj),r(a.Sr),
n.vertexAttribPointer(a.Sr,4,n.FLOAT,!1,0,0));0<=a.Kq&&(n.bindBuffer(n.ARRAY_BUFFER,f.Ej),r(a.Kq),n.vertexAttribPointer(a.Kq,1,n.FLOAT,!1,0,0))}g instanceof b.J?(d.I?(J(d.Fa),c&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,f.Dj),n.drawElements(n.LINES,f.Tl,n.UNSIGNED_SHORT,0)):(c&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,f.Cj),n.drawElements(n.TRIANGLES,f.Ql,n.UNSIGNED_SHORT,0)),T.info.v.le++,T.info.v.c+=f.Ql,T.info.v.j+=f.Ql/3):g instanceof b.Na?(h=g.type===b.Do?n.LINE_STRIP:n.LINES,J(d.Xc),n.drawArrays(h,0,f.Tl),
T.info.v.le++):g instanceof b.Tb?(n.drawArrays(n.POINTS,0,f.qp),T.info.v.le++,T.info.v.M+=f.qp):g instanceof b.De&&(n.drawArrays(n.TRIANGLE_STRIP,0,f.$t),T.info.v.le++)}};this.v=function(a,c,e,d){if(!1==c instanceof b.sc)return console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera."),void 0;var f,g,h,l,k=a.yc,m=a.D;$a=-1;Ta=!0;!0===a.Rj&&a.fc();void 0===c.parent&&c.fc();c.gb.Ld(c.A);xb.Da(c.wa,c.gb);hb.Pk(xb);this.Uu&&this.Gw(a);s(this.sr,a,c);T.info.v.le=0;T.info.v.c=
0;T.info.v.j=0;T.info.v.M=0;this.Rk(e);(this.Me||d)&&this.clear(this.Pu,this.Qu,this.Ru);l=a.Ac;d=0;for(f=l.length;f>d;d++)if(g=l[d],h=g.object,g.id=d,g.v=!1,h.visible&&(!(h instanceof b.J||h instanceof b.Tb)||!h.Of||hb.rk(h))){var p=h;p.Tc.Da(c.gb,p.A);p.$l.We(p.Tc);var p=g,E=void 0,y=void 0,q=void 0,r=p.buffer,q=p.object.n;q instanceof b.gc?(y=r.Ca,E=q.ja[y],E.U?(p.U=E,p.ag=null):(p.ag=E,p.U=null)):(E=q,E&&(E.U?(p.U=E,p.ag=null):(p.ag=E,p.U=null)));g.v=!0;!0===this.$k&&(null!==h.Vd?g.z=h.Vd:(gb.lb(h.A),
gb.Gd(xb),g.z=gb.z))}this.$k&&l.sort(w);l=a.Je;d=0;for(f=l.length;f>d;d++)g=l[d],h=g.object,h.visible&&(h.Tc.Da(c.gb,h.A),h.$l.We(h.Tc),h=g.object.n,h.U?(g.U=h,g.ag=null):(g.ag=h,g.U=null));a.Kk?(d=a.Kk,this.rh(d.Ha,d.blendEquation,d.Kf,d.Jf),this.fg(d.Db),this.Mi(d.Gc),R(d.polygonOffset,d.Hi,d.Ii),t(a.Ac,!1,"",c,k,m,!0,d),A(a.Je,"",c,k,m,!1,d)):(d=null,this.rh(b.Bl),t(a.Ac,!0,"opaque",c,k,m,!1,d),A(a.Je,"opaque",c,k,m,!1,d),t(a.Ac,!1,"transparent",c,k,m,!0,d),A(a.Je,"transparent",c,k,m,!0,d));s(this.rr,
a,c);e&&e.Eb&&e.nb!==b.Be&&e.nb!==b.ae&&(e instanceof b.Ff?(n.bindTexture(n.TEXTURE_CUBE_MAP,e.Bc),n.generateMipmap(n.TEXTURE_CUBE_MAP),n.bindTexture(n.TEXTURE_CUBE_MAP,null)):(n.bindTexture(n.TEXTURE_2D,e.Bc),n.generateMipmap(n.TEXTURE_2D),n.bindTexture(n.TEXTURE_2D,null)));this.fg(!0);this.Mi(!0)};this.Ln=function(a,b,c,e,d){var f=N(a,b,c,e,d);la=-1;T.Pn(e);d.Wm?d.Wm(f,n,hb):d.v(function(a){T.Ky(a,f,e)})};this.Gw=function(a){for(a.Ac||(a.Ac=[],a.Je=[],a.Ul=[],a.Rl=[]);a.zg.length;)Q(a.zg[0],a),
a.zg.splice(0,1);for(;a.Ag.length;)F(a.Ag[0],a),a.Ag.splice(0,1);for(var c=0,e=a.Ac.length;e>c;c++){var d=a.Ac[c].object;void 0===d.ge&&(void 0!==d.Pl&&F(d,a),Q(d,a));var f=d,g=void 0,h=void 0,k=void 0,E=f.l;if(E instanceof b.ze){var y=n.DYNAMIC_DRAW,r=!E.ji,aa=void 0,D=void 0,xa=E.attributes;for(aa in xa)D=xa[aa],D.ea&&("index"===aa?(n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,D.buffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,D.b,y)):(n.bindBuffer(n.ARRAY_BUFFER,D.buffer),n.bufferData(n.ARRAY_BUFFER,D.b,y)),
D.ea=!1),r&&!D.ji&&delete D.b}else if(f instanceof b.J){for(var s=0,v=E.Qm.length;v>s;s++)if(g=E.Qm[s],k=m(f,g),E.Mp&&l(g,f),h=k.attributes&&P(k),E.Xa||E.qn||E.li||E.kl||E.Sd||E.Mb||E.fj||h){var t=g,w=n.DYNAMIC_DRAW,Z=!E.ji,A=k;if(t.gp){var H=void 0,X=void 0,ma=void 0,G=void 0,za=void 0,O=void 0,K=void 0,N=void 0,L=void 0,M=void 0,ab=void 0,B=void 0,C=void 0,S=void 0,J=void 0,R=void 0,T=void 0,V=void 0,ja=void 0,na=void 0,U=void 0,lb=void 0,W=void 0,Y=void 0,Sa=void 0,da=void 0,hb=void 0,Ja=void 0,
Ba=void 0,ea=void 0,ha=void 0,wa=void 0,ia=void 0,eb=void 0,la=void 0,$=void 0,ra=void 0,Ca=void 0,qb=void 0,fb=void 0,Aa=void 0,Ga=void 0,Ta=void 0,pa=void 0,sa=void 0,va=void 0,Ma=void 0,x=void 0,La=q(A),Pa=A.m?A.m:!1,$a=p(A),Oa=La===b.wc,cb=0,ka=0,Ha=0,Ka=0,Da=0,ta=0,Qa=0,ya=0,db=0,ca=0,oa=0,z=0,ib=t.Ie,Pb=t.pp,bb=t.op,rb=t.yj,Wa=t.np,jb=t.He,Xa=t.lp,Ya=t.mp,Wb=t.jp,fc=t.ip,Xb=t.Wb,kb=t.fp,wb=t.hp,sb=f.l,Hb=sb.Xa,gd=sb.li,Gb=sb.kl,Mb=sb.Sd,Vb=sb.fj,bc=sb.Mb,dc=sb.qn,Yb=sb.c,Ea=t.dk,Fa=t.ek,ob=
sb.j,Nb=sb.C[0],Ob=sb.C[1],Zb=(sb.Oa,sb.nf),Sb=sb.of,Tb=sb.B,xc=sb.sa;if(Hb){H=0;for(X=Ea.length;X>H;H++)G=ob[Ea[H]],B=Yb[G.r],C=Yb[G.h],S=Yb[G.t],ib[ka]=B.x,ib[ka+1]=B.y,ib[ka+2]=B.z,ib[ka+3]=C.x,ib[ka+4]=C.y,ib[ka+5]=C.z,ib[ka+6]=S.x,ib[ka+7]=S.y,ib[ka+8]=S.z,ka+=9;H=0;for(X=Fa.length;X>H;H++)G=ob[Fa[H]],B=Yb[G.r],C=Yb[G.h],S=Yb[G.t],J=Yb[G.oa],ib[ka]=B.x,ib[ka+1]=B.y,ib[ka+2]=B.z,ib[ka+3]=C.x,ib[ka+4]=C.y,ib[ka+5]=C.z,ib[ka+6]=S.x,ib[ka+7]=S.y,ib[ka+8]=S.z,ib[ka+9]=J.x,ib[ka+10]=J.y,ib[ka+11]=
J.z,ka+=12;n.bindBuffer(n.ARRAY_BUFFER,t.rb);n.bufferData(n.ARRAY_BUFFER,ib,w)}if(dc)for(Aa=0,Ga=Tb.length;Ga>Aa;Aa++){H=oa=0;for(X=Ea.length;X>H;H++)sa=Ea[H],G=ob[sa],B=Tb[Aa].c[G.r],C=Tb[Aa].c[G.h],S=Tb[Aa].c[G.t],Ta=Wb[Aa],Ta[oa]=B.x,Ta[oa+1]=B.y,Ta[oa+2]=B.z,Ta[oa+3]=C.x,Ta[oa+4]=C.y,Ta[oa+5]=C.z,Ta[oa+6]=S.x,Ta[oa+7]=S.y,Ta[oa+8]=S.z,A.sa&&(Oa?(va=xc[Aa].G[sa],na=va.r,U=va.h,lb=va.t):(na=xc[Aa].bk[sa],U=na,lb=na),pa=fc[Aa],pa[oa]=na.x,pa[oa+1]=na.y,pa[oa+2]=na.z,pa[oa+3]=U.x,pa[oa+4]=U.y,pa[oa+
5]=U.z,pa[oa+6]=lb.x,pa[oa+7]=lb.y,pa[oa+8]=lb.z),oa+=9;H=0;for(X=Fa.length;X>H;H++)sa=Fa[H],G=ob[sa],B=Tb[Aa].c[G.r],C=Tb[Aa].c[G.h],S=Tb[Aa].c[G.t],J=Tb[Aa].c[G.oa],Ta=Wb[Aa],Ta[oa]=B.x,Ta[oa+1]=B.y,Ta[oa+2]=B.z,Ta[oa+3]=C.x,Ta[oa+4]=C.y,Ta[oa+5]=C.z,Ta[oa+6]=S.x,Ta[oa+7]=S.y,Ta[oa+8]=S.z,Ta[oa+9]=J.x,Ta[oa+10]=J.y,Ta[oa+11]=J.z,A.sa&&(Oa?(va=xc[Aa].G[sa],na=va.r,U=va.h,lb=va.t,W=va.oa):(na=xc[Aa].bk[sa],U=na,lb=na,W=na),pa=fc[Aa],pa[oa]=na.x,pa[oa+1]=na.y,pa[oa+2]=na.z,pa[oa+3]=U.x,pa[oa+4]=U.y,
pa[oa+5]=U.z,pa[oa+6]=lb.x,pa[oa+7]=lb.y,pa[oa+8]=lb.z,pa[oa+9]=W.x,pa[oa+10]=W.y,pa[oa+11]=W.z),oa+=12;n.bindBuffer(n.ARRAY_BUFFER,t.Bg[Aa]);n.bufferData(n.ARRAY_BUFFER,Wb[Aa],w);A.sa&&(n.bindBuffer(n.ARRAY_BUFFER,t.Lh[Aa]),n.bufferData(n.ARRAY_BUFFER,fc[Aa],w))}if(Sb.length){H=0;for(X=Ea.length;X>H;H++)G=ob[Ea[H]],Ja=Sb[G.r],Ba=Sb[G.h],ea=Sb[G.t],Ya[ca]=Ja.x,Ya[ca+1]=Ja.y,Ya[ca+2]=Ja.z,Ya[ca+3]=Ja.f,Ya[ca+4]=Ba.x,Ya[ca+5]=Ba.y,Ya[ca+6]=Ba.z,Ya[ca+7]=Ba.f,Ya[ca+8]=ea.x,Ya[ca+9]=ea.y,Ya[ca+10]=ea.z,
Ya[ca+11]=ea.f,wa=Zb[G.r],ia=Zb[G.h],eb=Zb[G.t],Xa[ca]=wa.x,Xa[ca+1]=wa.y,Xa[ca+2]=wa.z,Xa[ca+3]=wa.f,Xa[ca+4]=ia.x,Xa[ca+5]=ia.y,Xa[ca+6]=ia.z,Xa[ca+7]=ia.f,Xa[ca+8]=eb.x,Xa[ca+9]=eb.y,Xa[ca+10]=eb.z,Xa[ca+11]=eb.f,ca+=12;H=0;for(X=Fa.length;X>H;H++)G=ob[Fa[H]],Ja=Sb[G.r],Ba=Sb[G.h],ea=Sb[G.t],ha=Sb[G.oa],Ya[ca]=Ja.x,Ya[ca+1]=Ja.y,Ya[ca+2]=Ja.z,Ya[ca+3]=Ja.f,Ya[ca+4]=Ba.x,Ya[ca+5]=Ba.y,Ya[ca+6]=Ba.z,Ya[ca+7]=Ba.f,Ya[ca+8]=ea.x,Ya[ca+9]=ea.y,Ya[ca+10]=ea.z,Ya[ca+11]=ea.f,Ya[ca+12]=ha.x,Ya[ca+13]=
ha.y,Ya[ca+14]=ha.z,Ya[ca+15]=ha.f,wa=Zb[G.r],ia=Zb[G.h],eb=Zb[G.t],la=Zb[G.oa],Xa[ca]=wa.x,Xa[ca+1]=wa.y,Xa[ca+2]=wa.z,Xa[ca+3]=wa.f,Xa[ca+4]=ia.x,Xa[ca+5]=ia.y,Xa[ca+6]=ia.z,Xa[ca+7]=ia.f,Xa[ca+8]=eb.x,Xa[ca+9]=eb.y,Xa[ca+10]=eb.z,Xa[ca+11]=eb.f,Xa[ca+12]=la.x,Xa[ca+13]=la.y,Xa[ca+14]=la.z,Xa[ca+15]=la.f,ca+=16;0<ca&&(n.bindBuffer(n.ARRAY_BUFFER,t.Fj),n.bufferData(n.ARRAY_BUFFER,Xa,w),n.bindBuffer(n.ARRAY_BUFFER,t.Gj),n.bufferData(n.ARRAY_BUFFER,Ya,w))}if(bc&&Pa){H=0;for(X=Ea.length;X>H;H++)G=ob[Ea[H]],
K=G.m,N=G.color,3===K.length&&Pa===b.Fe?(Y=K[0],Sa=K[1],da=K[2]):(Y=N,Sa=N,da=N),jb[db]=Y.q,jb[db+1]=Y.o,jb[db+2]=Y.h,jb[db+3]=Sa.q,jb[db+4]=Sa.o,jb[db+5]=Sa.h,jb[db+6]=da.q,jb[db+7]=da.o,jb[db+8]=da.h,db+=9;H=0;for(X=Fa.length;X>H;H++)G=ob[Fa[H]],K=G.m,N=G.color,4===K.length&&Pa===b.Fe?(Y=K[0],Sa=K[1],da=K[2],hb=K[3]):(Y=N,Sa=N,da=N,hb=N),jb[db]=Y.q,jb[db+1]=Y.o,jb[db+2]=Y.h,jb[db+3]=Sa.q,jb[db+4]=Sa.o,jb[db+5]=Sa.h,jb[db+6]=da.q,jb[db+7]=da.o,jb[db+8]=da.h,jb[db+9]=hb.q,jb[db+10]=hb.o,jb[db+11]=
hb.h,db+=12;0<db&&(n.bindBuffer(n.ARRAY_BUFFER,t.zc),n.bufferData(n.ARRAY_BUFFER,jb,w))}if(Vb&&sb.eh){H=0;for(X=Ea.length;X>H;H++)G=ob[Ea[H]],L=G.Yd,R=L[0],T=L[1],V=L[2],Wa[Qa]=R.x,Wa[Qa+1]=R.y,Wa[Qa+2]=R.z,Wa[Qa+3]=R.f,Wa[Qa+4]=T.x,Wa[Qa+5]=T.y,Wa[Qa+6]=T.z,Wa[Qa+7]=T.f,Wa[Qa+8]=V.x,Wa[Qa+9]=V.y,Wa[Qa+10]=V.z,Wa[Qa+11]=V.f,Qa+=12;H=0;for(X=Fa.length;X>H;H++)G=ob[Fa[H]],L=G.Yd,R=L[0],T=L[1],V=L[2],ja=L[3],Wa[Qa]=R.x,Wa[Qa+1]=R.y,Wa[Qa+2]=R.z,Wa[Qa+3]=R.f,Wa[Qa+4]=T.x,Wa[Qa+5]=T.y,Wa[Qa+6]=T.z,Wa[Qa+
7]=T.f,Wa[Qa+8]=V.x,Wa[Qa+9]=V.y,Wa[Qa+10]=V.z,Wa[Qa+11]=V.f,Wa[Qa+12]=ja.x,Wa[Qa+13]=ja.y,Wa[Qa+14]=ja.z,Wa[Qa+15]=ja.f,Qa+=16;n.bindBuffer(n.ARRAY_BUFFER,t.Hj);n.bufferData(n.ARRAY_BUFFER,Wa,w)}if(Mb&&La){H=0;for(X=Ea.length;X>H;H++)if(G=ob[Ea[H]],za=G.G,O=G.s,3===za.length&&Oa)for($=0;3>$;$++)Ca=za[$],rb[ta]=Ca.x,rb[ta+1]=Ca.y,rb[ta+2]=Ca.z,ta+=3;else for($=0;3>$;$++)rb[ta]=O.x,rb[ta+1]=O.y,rb[ta+2]=O.z,ta+=3;H=0;for(X=Fa.length;X>H;H++)if(G=ob[Fa[H]],za=G.G,O=G.s,4===za.length&&Oa)for($=0;4>$;$++)Ca=
za[$],rb[ta]=Ca.x,rb[ta+1]=Ca.y,rb[ta+2]=Ca.z,ta+=3;else for($=0;4>$;$++)rb[ta]=O.x,rb[ta+1]=O.y,rb[ta+2]=O.z,ta+=3;n.bindBuffer(n.ARRAY_BUFFER,t.he);n.bufferData(n.ARRAY_BUFFER,rb,w)}if(Gb&&Nb&&$a){H=0;for(X=Ea.length;X>H;H++)if(ma=Ea[H],M=Nb[ma],void 0!==M)for($=0;3>$;$++)qb=M[$],Pb[Ha]=qb.x,Pb[Ha+1]=qb.y,Ha+=2;H=0;for(X=Fa.length;X>H;H++)if(ma=Fa[H],M=Nb[ma],void 0!==M)for($=0;4>$;$++)qb=M[$],Pb[Ha]=qb.x,Pb[Ha+1]=qb.y,Ha+=2;0<Ha&&(n.bindBuffer(n.ARRAY_BUFFER,t.Jj),n.bufferData(n.ARRAY_BUFFER,Pb,
w))}if(Gb&&Ob&&$a){H=0;for(X=Ea.length;X>H;H++)if(ma=Ea[H],ab=Ob[ma],void 0!==ab)for($=0;3>$;$++)fb=ab[$],bb[Ka]=fb.x,bb[Ka+1]=fb.y,Ka+=2;H=0;for(X=Fa.length;X>H;H++)if(ma=Fa[H],ab=Ob[ma],void 0!==ab)for($=0;4>$;$++)fb=ab[$],bb[Ka]=fb.x,bb[Ka+1]=fb.y,Ka+=2;0<Ka&&(n.bindBuffer(n.ARRAY_BUFFER,t.Ij),n.bufferData(n.ARRAY_BUFFER,bb,w))}if(gd){H=0;for(X=Ea.length;X>H;H++)kb[Da]=cb,kb[Da+1]=cb+1,kb[Da+2]=cb+2,Da+=3,wb[ya]=cb,wb[ya+1]=cb+1,wb[ya+2]=cb,wb[ya+3]=cb+2,wb[ya+4]=cb+1,wb[ya+5]=cb+2,ya+=6,cb+=3;
H=0;for(X=Fa.length;X>H;H++)kb[Da]=cb,kb[Da+1]=cb+1,kb[Da+2]=cb+3,kb[Da+3]=cb+1,kb[Da+4]=cb+2,kb[Da+5]=cb+3,Da+=6,wb[ya]=cb,wb[ya+1]=cb+1,wb[ya+2]=cb,wb[ya+3]=cb+3,wb[ya+4]=cb+1,wb[ya+5]=cb+2,wb[ya+6]=cb+2,wb[ya+7]=cb+3,ya+=8,cb+=4;n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.Cj);n.bufferData(n.ELEMENT_ARRAY_BUFFER,kb,w);n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.Dj);n.bufferData(n.ELEMENT_ARRAY_BUFFER,wb,w)}if(Xb)for($=0,ra=Xb.length;ra>$;$++)if(x=Xb[$],x.Rt.ea){if(z=0,1===x.size)if(void 0===x.Sa||"vertices"===
x.Sa){H=0;for(X=Ea.length;X>H;H++)G=ob[Ea[H]],x.b[z]=x.value[G.r],x.b[z+1]=x.value[G.h],x.b[z+2]=x.value[G.t],z+=3;H=0;for(X=Fa.length;X>H;H++)G=ob[Fa[H]],x.b[z]=x.value[G.r],x.b[z+1]=x.value[G.h],x.b[z+2]=x.value[G.t],x.b[z+3]=x.value[G.oa],z+=4}else{if("faces"===x.Sa){H=0;for(X=Ea.length;X>H;H++)Ma=x.value[Ea[H]],x.b[z]=Ma,x.b[z+1]=Ma,x.b[z+2]=Ma,z+=3;H=0;for(X=Fa.length;X>H;H++)Ma=x.value[Fa[H]],x.b[z]=Ma,x.b[z+1]=Ma,x.b[z+2]=Ma,x.b[z+3]=Ma,z+=4}}else if(2===x.size)if(void 0===x.Sa||"vertices"===
x.Sa){H=0;for(X=Ea.length;X>H;H++)G=ob[Ea[H]],B=x.value[G.r],C=x.value[G.h],S=x.value[G.t],x.b[z]=B.x,x.b[z+1]=B.y,x.b[z+2]=C.x,x.b[z+3]=C.y,x.b[z+4]=S.x,x.b[z+5]=S.y,z+=6;H=0;for(X=Fa.length;X>H;H++)G=ob[Fa[H]],B=x.value[G.r],C=x.value[G.h],S=x.value[G.t],J=x.value[G.oa],x.b[z]=B.x,x.b[z+1]=B.y,x.b[z+2]=C.x,x.b[z+3]=C.y,x.b[z+4]=S.x,x.b[z+5]=S.y,x.b[z+6]=J.x,x.b[z+7]=J.y,z+=8}else{if("faces"===x.Sa){H=0;for(X=Ea.length;X>H;H++)S=C=B=Ma=x.value[Ea[H]],x.b[z]=B.x,x.b[z+1]=B.y,x.b[z+2]=C.x,x.b[z+3]=
C.y,x.b[z+4]=S.x,x.b[z+5]=S.y,z+=6;H=0;for(X=Fa.length;X>H;H++)J=S=C=B=Ma=x.value[Fa[H]],x.b[z]=B.x,x.b[z+1]=B.y,x.b[z+2]=C.x,x.b[z+3]=C.y,x.b[z+4]=S.x,x.b[z+5]=S.y,x.b[z+6]=J.x,x.b[z+7]=J.y,z+=8}}else if(3===x.size){var ba;if(ba="c"===x.type?["r","g","b"]:["x","y","z"],void 0===x.Sa||"vertices"===x.Sa){H=0;for(X=Ea.length;X>H;H++)G=ob[Ea[H]],B=x.value[G.r],C=x.value[G.h],S=x.value[G.t],x.b[z]=B[ba[0]],x.b[z+1]=B[ba[1]],x.b[z+2]=B[ba[2]],x.b[z+3]=C[ba[0]],x.b[z+4]=C[ba[1]],x.b[z+5]=C[ba[2]],x.b[z+
6]=S[ba[0]],x.b[z+7]=S[ba[1]],x.b[z+8]=S[ba[2]],z+=9;H=0;for(X=Fa.length;X>H;H++)G=ob[Fa[H]],B=x.value[G.r],C=x.value[G.h],S=x.value[G.t],J=x.value[G.oa],x.b[z]=B[ba[0]],x.b[z+1]=B[ba[1]],x.b[z+2]=B[ba[2]],x.b[z+3]=C[ba[0]],x.b[z+4]=C[ba[1]],x.b[z+5]=C[ba[2]],x.b[z+6]=S[ba[0]],x.b[z+7]=S[ba[1]],x.b[z+8]=S[ba[2]],x.b[z+9]=J[ba[0]],x.b[z+10]=J[ba[1]],x.b[z+11]=J[ba[2]],z+=12}else if("faces"===x.Sa){H=0;for(X=Ea.length;X>H;H++)S=C=B=Ma=x.value[Ea[H]],x.b[z]=B[ba[0]],x.b[z+1]=B[ba[1]],x.b[z+2]=B[ba[2]],
x.b[z+3]=C[ba[0]],x.b[z+4]=C[ba[1]],x.b[z+5]=C[ba[2]],x.b[z+6]=S[ba[0]],x.b[z+7]=S[ba[1]],x.b[z+8]=S[ba[2]],z+=9;H=0;for(X=Fa.length;X>H;H++)J=S=C=B=Ma=x.value[Fa[H]],x.b[z]=B[ba[0]],x.b[z+1]=B[ba[1]],x.b[z+2]=B[ba[2]],x.b[z+3]=C[ba[0]],x.b[z+4]=C[ba[1]],x.b[z+5]=C[ba[2]],x.b[z+6]=S[ba[0]],x.b[z+7]=S[ba[1]],x.b[z+8]=S[ba[2]],x.b[z+9]=J[ba[0]],x.b[z+10]=J[ba[1]],x.b[z+11]=J[ba[2]],z+=12}else if("faceVertices"===x.Sa){H=0;for(X=Ea.length;X>H;H++)Ma=x.value[Ea[H]],B=Ma[0],C=Ma[1],S=Ma[2],x.b[z]=B[ba[0]],
x.b[z+1]=B[ba[1]],x.b[z+2]=B[ba[2]],x.b[z+3]=C[ba[0]],x.b[z+4]=C[ba[1]],x.b[z+5]=C[ba[2]],x.b[z+6]=S[ba[0]],x.b[z+7]=S[ba[1]],x.b[z+8]=S[ba[2]],z+=9;H=0;for(X=Fa.length;X>H;H++)Ma=x.value[Fa[H]],B=Ma[0],C=Ma[1],S=Ma[2],J=Ma[3],x.b[z]=B[ba[0]],x.b[z+1]=B[ba[1]],x.b[z+2]=B[ba[2]],x.b[z+3]=C[ba[0]],x.b[z+4]=C[ba[1]],x.b[z+5]=C[ba[2]],x.b[z+6]=S[ba[0]],x.b[z+7]=S[ba[1]],x.b[z+8]=S[ba[2]],x.b[z+9]=J[ba[0]],x.b[z+10]=J[ba[1]],x.b[z+11]=J[ba[2]],z+=12}}else if(4===x.size)if(void 0===x.Sa||"vertices"===x.Sa){H=
0;for(X=Ea.length;X>H;H++)G=ob[Ea[H]],B=x.value[G.r],C=x.value[G.h],S=x.value[G.t],x.b[z]=B.x,x.b[z+1]=B.y,x.b[z+2]=B.z,x.b[z+3]=B.f,x.b[z+4]=C.x,x.b[z+5]=C.y,x.b[z+6]=C.z,x.b[z+7]=C.f,x.b[z+8]=S.x,x.b[z+9]=S.y,x.b[z+10]=S.z,x.b[z+11]=S.f,z+=12;H=0;for(X=Fa.length;X>H;H++)G=ob[Fa[H]],B=x.value[G.r],C=x.value[G.h],S=x.value[G.t],J=x.value[G.oa],x.b[z]=B.x,x.b[z+1]=B.y,x.b[z+2]=B.z,x.b[z+3]=B.f,x.b[z+4]=C.x,x.b[z+5]=C.y,x.b[z+6]=C.z,x.b[z+7]=C.f,x.b[z+8]=S.x,x.b[z+9]=S.y,x.b[z+10]=S.z,x.b[z+11]=S.f,
x.b[z+12]=J.x,x.b[z+13]=J.y,x.b[z+14]=J.z,x.b[z+15]=J.f,z+=16}else if("faces"===x.Sa){H=0;for(X=Ea.length;X>H;H++)S=C=B=Ma=x.value[Ea[H]],x.b[z]=B.x,x.b[z+1]=B.y,x.b[z+2]=B.z,x.b[z+3]=B.f,x.b[z+4]=C.x,x.b[z+5]=C.y,x.b[z+6]=C.z,x.b[z+7]=C.f,x.b[z+8]=S.x,x.b[z+9]=S.y,x.b[z+10]=S.z,x.b[z+11]=S.f,z+=12;H=0;for(X=Fa.length;X>H;H++)J=S=C=B=Ma=x.value[Fa[H]],x.b[z]=B.x,x.b[z+1]=B.y,x.b[z+2]=B.z,x.b[z+3]=B.f,x.b[z+4]=C.x,x.b[z+5]=C.y,x.b[z+6]=C.z,x.b[z+7]=C.f,x.b[z+8]=S.x,x.b[z+9]=S.y,x.b[z+10]=S.z,x.b[z+
11]=S.f,x.b[z+12]=J.x,x.b[z+13]=J.y,x.b[z+14]=J.z,x.b[z+15]=J.f,z+=16}else if("faceVertices"===x.Sa){H=0;for(X=Ea.length;X>H;H++)Ma=x.value[Ea[H]],B=Ma[0],C=Ma[1],S=Ma[2],x.b[z]=B.x,x.b[z+1]=B.y,x.b[z+2]=B.z,x.b[z+3]=B.f,x.b[z+4]=C.x,x.b[z+5]=C.y,x.b[z+6]=C.z,x.b[z+7]=C.f,x.b[z+8]=S.x,x.b[z+9]=S.y,x.b[z+10]=S.z,x.b[z+11]=S.f,z+=12;H=0;for(X=Fa.length;X>H;H++)Ma=x.value[Fa[H]],B=Ma[0],C=Ma[1],S=Ma[2],J=Ma[3],x.b[z]=B.x,x.b[z+1]=B.y,x.b[z+2]=B.z,x.b[z+3]=B.f,x.b[z+4]=C.x,x.b[z+5]=C.y,x.b[z+6]=C.z,x.b[z+
7]=C.f,x.b[z+8]=S.x,x.b[z+9]=S.y,x.b[z+10]=S.z,x.b[z+11]=S.f,x.b[z+12]=J.x,x.b[z+13]=J.y,x.b[z+14]=J.z,x.b[z+15]=J.f,z+=16}n.bindBuffer(n.ARRAY_BUFFER,x.buffer);n.bufferData(n.ARRAY_BUFFER,x.b,w)}Z&&(delete t.gp,delete t.He,delete t.yj,delete t.np,delete t.pp,delete t.op,delete t.fp,delete t.Ie,delete t.hp,delete t.lp,delete t.mp)}}E.Xa=!1;E.qn=!1;E.li=!1;E.kl=!1;E.Sd=!1;E.Mb=!1;E.fj=!1;E.Mp=!1;k.attributes&&I(k)}else if(f instanceof b.De){k=m(f,E);h=k.attributes&&P(k);if(E.Xa||E.Mb||E.Sd||h){var yb=
E,Lb=n.DYNAMIC_DRAW,nc=void 0,oc=void 0,pc=void 0,yc=void 0,Na=void 0,zc=void 0,Ac=void 0,Bc=void 0,ec=void 0,mb=void 0,hc=void 0,Ua=void 0,tb=void 0,kc=yb.c,lc=yb.Oa,mc=yb.Xf,uc=kc.length,vc=lc.length,wc=mc.length,Cc=yb.Ie,Dc=yb.He,Ec=yb.yj,Mc=yb.Mb,Nc=yb.Sd,Rc=yb.Wb;if(yb.Xa){for(nc=0;uc>nc;nc++)yc=kc[nc],Na=3*nc,Cc[Na]=yc.x,Cc[Na+1]=yc.y,Cc[Na+2]=yc.z;n.bindBuffer(n.ARRAY_BUFFER,yb.rb);n.bufferData(n.ARRAY_BUFFER,Cc,Lb)}if(Mc){for(oc=0;vc>oc;oc++)zc=lc[oc],Na=3*oc,Dc[Na]=zc.q,Dc[Na+1]=zc.o,Dc[Na+
2]=zc.h;n.bindBuffer(n.ARRAY_BUFFER,yb.zc);n.bufferData(n.ARRAY_BUFFER,Dc,Lb)}if(Nc){for(pc=0;wc>pc;pc++)Ac=mc[pc],Na=3*pc,Ec[Na]=Ac.x,Ec[Na+1]=Ac.y,Ec[Na+2]=Ac.z;n.bindBuffer(n.ARRAY_BUFFER,yb.he);n.bufferData(n.ARRAY_BUFFER,Ec,Lb)}if(Rc)for(Bc=0,ec=Rc.length;ec>Bc;Bc++)if(Ua=Rc[Bc],Ua.ea&&(void 0===Ua.Sa||"vertices"===Ua.Sa)){if(Na=0,hc=Ua.value.length,1===Ua.size)for(mb=0;hc>mb;mb++)Ua.b[mb]=Ua.value[mb];else if(2===Ua.size)for(mb=0;hc>mb;mb++)tb=Ua.value[mb],Ua.b[Na]=tb.x,Ua.b[Na+1]=tb.y,Na+=
2;else if(3===Ua.size)if("c"===Ua.type)for(mb=0;hc>mb;mb++)tb=Ua.value[mb],Ua.b[Na]=tb.q,Ua.b[Na+1]=tb.o,Ua.b[Na+2]=tb.h,Na+=3;else for(mb=0;hc>mb;mb++)tb=Ua.value[mb],Ua.b[Na]=tb.x,Ua.b[Na+1]=tb.y,Ua.b[Na+2]=tb.z,Na+=3;else if(4===Ua.size)for(mb=0;hc>mb;mb++)tb=Ua.value[mb],Ua.b[Na]=tb.x,Ua.b[Na+1]=tb.y,Ua.b[Na+2]=tb.z,Ua.b[Na+3]=tb.f,Na+=4;n.bindBuffer(n.ARRAY_BUFFER,Ua.buffer);n.bufferData(n.ARRAY_BUFFER,Ua.b,Lb)}}E.Xa=!1;E.Mb=!1;E.Sd=!1;k.attributes&&I(k)}else if(f instanceof b.Na){k=m(f,E);h=
k.attributes&&P(k);if(E.Xa||E.Mb||E.wk||h){var zb=E,Fc=n.DYNAMIC_DRAW,qc=void 0,rc=void 0,sc=void 0,Gc=void 0,Za=void 0,Hc=void 0,Ic=void 0,Zc=void 0,nb=void 0,ic=void 0,ub=void 0,Va=void 0,$c=zb.c,ad=zb.Oa,bd=zb.Lq,Oc=$c.length,Wc=ad.length,Xc=bd.length,Jc=zb.Ie,Kc=zb.He,cd=zb.Pt,Yc=zb.Mb,id=zb.wk,Sc=zb.Wb;if(zb.Xa){for(qc=0;Oc>qc;qc++)Gc=$c[qc],Za=3*qc,Jc[Za]=Gc.x,Jc[Za+1]=Gc.y,Jc[Za+2]=Gc.z;n.bindBuffer(n.ARRAY_BUFFER,zb.rb);n.bufferData(n.ARRAY_BUFFER,Jc,Fc)}if(Yc){for(rc=0;Wc>rc;rc++)Hc=ad[rc],
Za=3*rc,Kc[Za]=Hc.q,Kc[Za+1]=Hc.o,Kc[Za+2]=Hc.h;n.bindBuffer(n.ARRAY_BUFFER,zb.zc);n.bufferData(n.ARRAY_BUFFER,Kc,Fc)}if(id){for(sc=0;Xc>sc;sc++)cd[sc]=bd[sc];n.bindBuffer(n.ARRAY_BUFFER,zb.Ej);n.bufferData(n.ARRAY_BUFFER,cd,Fc)}if(Sc)for(Ic=0,Zc=Sc.length;Zc>Ic;Ic++)if(Va=Sc[Ic],Va.ea&&(void 0===Va.Sa||"vertices"===Va.Sa)){if(Za=0,ic=Va.value.length,1===Va.size)for(nb=0;ic>nb;nb++)Va.b[nb]=Va.value[nb];else if(2===Va.size)for(nb=0;ic>nb;nb++)ub=Va.value[nb],Va.b[Za]=ub.x,Va.b[Za+1]=ub.y,Za+=2;else if(3===
Va.size)if("c"===Va.type)for(nb=0;ic>nb;nb++)ub=Va.value[nb],Va.b[Za]=ub.q,Va.b[Za+1]=ub.o,Va.b[Za+2]=ub.h,Za+=3;else for(nb=0;ic>nb;nb++)ub=Va.value[nb],Va.b[Za]=ub.x,Va.b[Za+1]=ub.y,Va.b[Za+2]=ub.z,Za+=3;else if(4===Va.size)for(nb=0;ic>nb;nb++)ub=Va.value[nb],Va.b[Za]=ub.x,Va.b[Za+1]=ub.y,Va.b[Za+2]=ub.z,Va.b[Za+3]=ub.f,Za+=4;n.bindBuffer(n.ARRAY_BUFFER,Va.buffer);n.bufferData(n.ARRAY_BUFFER,Va.b,Fc)}}E.Xa=!1;E.Mb=!1;E.wk=!1;k.attributes&&I(k)}else if(f instanceof b.Tb){k=m(f,E);h=k.attributes&&
P(k);if(E.Xa||E.Mb||f.jg||h){var Cb=E,Tc=n.DYNAMIC_DRAW,tc=f,vb=void 0,Db=void 0,Eb=void 0,ga=void 0,Fb=void 0,Ub=void 0,Ab=void 0,jc=void 0,ua=void 0,Bb=void 0,Ra=void 0,fa=void 0,Lc=Cb.c,Uc=Lc.length,Vc=Cb.Oa,dd=Vc.length,$b=Cb.Ie,ac=Cb.He,Jb=Cb.Tt,ed=Cb.Xa,fd=(Cb.li,Cb.Mb),Kb=Cb.Wb;if(tc.jg){Pc.copy(xb);Pc.multiply(tc.A);for(vb=0;Uc>vb;vb++)Eb=Lc[vb],gb.copy(Eb),gb.Gd(Pc),Jb[vb]=[gb.z,vb];Jb.sort(u);for(vb=0;Uc>vb;vb++)Eb=Lc[Jb[vb][1]],ga=3*vb,$b[ga]=Eb.x,$b[ga+1]=Eb.y,$b[ga+2]=Eb.z;for(Db=0;dd>
Db;Db++)ga=3*Db,Ub=Vc[Jb[Db][1]],ac[ga]=Ub.q,ac[ga+1]=Ub.o,ac[ga+2]=Ub.h;if(Kb)for(Ab=0,jc=Kb.length;jc>Ab;Ab++)if(fa=Kb[Ab],void 0===fa.Sa||"vertices"===fa.Sa)if(ga=0,Bb=fa.value.length,1===fa.size)for(ua=0;Bb>ua;ua++)Fb=Jb[ua][1],fa.b[ua]=fa.value[Fb];else if(2===fa.size)for(ua=0;Bb>ua;ua++)Fb=Jb[ua][1],Ra=fa.value[Fb],fa.b[ga]=Ra.x,fa.b[ga+1]=Ra.y,ga+=2;else if(3===fa.size)if("c"===fa.type)for(ua=0;Bb>ua;ua++)Fb=Jb[ua][1],Ra=fa.value[Fb],fa.b[ga]=Ra.q,fa.b[ga+1]=Ra.o,fa.b[ga+2]=Ra.h,ga+=3;else for(ua=
0;Bb>ua;ua++)Fb=Jb[ua][1],Ra=fa.value[Fb],fa.b[ga]=Ra.x,fa.b[ga+1]=Ra.y,fa.b[ga+2]=Ra.z,ga+=3;else if(4===fa.size)for(ua=0;Bb>ua;ua++)Fb=Jb[ua][1],Ra=fa.value[Fb],fa.b[ga]=Ra.x,fa.b[ga+1]=Ra.y,fa.b[ga+2]=Ra.z,fa.b[ga+3]=Ra.f,ga+=4}else{if(ed)for(vb=0;Uc>vb;vb++)Eb=Lc[vb],ga=3*vb,$b[ga]=Eb.x,$b[ga+1]=Eb.y,$b[ga+2]=Eb.z;if(fd)for(Db=0;dd>Db;Db++)Ub=Vc[Db],ga=3*Db,ac[ga]=Ub.q,ac[ga+1]=Ub.o,ac[ga+2]=Ub.h;if(Kb)for(Ab=0,jc=Kb.length;jc>Ab;Ab++)if(fa=Kb[Ab],fa.ea&&(void 0===fa.Sa||"vertices"===fa.Sa))if(Bb=
fa.value.length,ga=0,1===fa.size)for(ua=0;Bb>ua;ua++)fa.b[ua]=fa.value[ua];else if(2===fa.size)for(ua=0;Bb>ua;ua++)Ra=fa.value[ua],fa.b[ga]=Ra.x,fa.b[ga+1]=Ra.y,ga+=2;else if(3===fa.size)if("c"===fa.type)for(ua=0;Bb>ua;ua++)Ra=fa.value[ua],fa.b[ga]=Ra.q,fa.b[ga+1]=Ra.o,fa.b[ga+2]=Ra.h,ga+=3;else for(ua=0;Bb>ua;ua++)Ra=fa.value[ua],fa.b[ga]=Ra.x,fa.b[ga+1]=Ra.y,fa.b[ga+2]=Ra.z,ga+=3;else if(4===fa.size)for(ua=0;Bb>ua;ua++)Ra=fa.value[ua],fa.b[ga]=Ra.x,fa.b[ga+1]=Ra.y,fa.b[ga+2]=Ra.z,fa.b[ga+3]=Ra.f,
ga+=4}if((ed||tc.jg)&&(n.bindBuffer(n.ARRAY_BUFFER,Cb.rb),n.bufferData(n.ARRAY_BUFFER,$b,Tc)),(fd||tc.jg)&&(n.bindBuffer(n.ARRAY_BUFFER,Cb.zc),n.bufferData(n.ARRAY_BUFFER,ac,Tc)),Kb)for(Ab=0,jc=Kb.length;jc>Ab;Ab++)fa=Kb[Ab],(fa.ea||tc.jg)&&(n.bindBuffer(n.ARRAY_BUFFER,fa.buffer),n.bufferData(n.ARRAY_BUFFER,fa.b,Tc))}E.Xa=!1;E.Mb=!1;k.attributes&&I(k)}}};this.Ew=function(a,e,d,f){var g,h,k,l;a.addEventListener("dispose",c);var m,E,p,y,q;a instanceof b.ce?q="depth":a instanceof b.Ae?q="normal":a instanceof
b.Za?q="basic":a instanceof b.hc?q="lambert":a instanceof b.qb?q="phong":a instanceof b.Pc?q="basic":a instanceof b.zf?q="dashed":a instanceof b.Ce&&(q="particle_basic");if(q){var r=b.yg[q];a.N=b.xc.d(r.N);a.O=r.O;a.L=r.L}var aa,H,u;g=k=H=u=r=0;for(h=e.length;h>g;g++)aa=e[g],aa.ff||(aa instanceof b.Ib&&k++,aa instanceof b.Bd&&H++,aa instanceof b.Ee&&u++,aa instanceof b.nj&&r++);g=k;h=H;k=u;l=r;r=aa=0;for(u=e.length;u>r;r++)H=e[r],H.Lb&&(H instanceof b.Ee&&aa++,H instanceof b.Ib&&!H.Wn&&aa++);y=aa;
rb&&f&&f.te?p=1024:(e=Math.floor((n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS)-20)/4),p=(void 0!==f&&f instanceof b.Ub&&(e=Math.min(f.ab.length,e),e<f.ab.length&&console.warn("WebGLRenderer: too many bones - "+f.ab.length+", this GPU supports just "+e+" (try OpenGL instead of ANGLE)")),e));a:{u=a.L;H=a.O;r=a.N;e=a.attributes;aa=a.zm;d={map:!!a.map,pa:!!a.pa,Ta:!!a.Ta,Xb:!!a.Xb,wb:!!a.wb,Qa:!!a.Qa,m:a.m,D:d,xs:a.D,aw:d instanceof b.xf,ec:a.ec,Ka:a.Ka,Ex:p,te:rb&&f&&f.te,Kg:f&&f.Kg,Jg:f&&f.Jg,B:a.B,
sa:a.sa,zi:this.zi,Dk:this.Dk,Tq:g,Wq:h,Yq:k,Uq:l,Xq:y,hg:this.hg&&f.qh,Ui:this.Ui,Vk:this.Vk,Uk:this.Uk,Dc:a.Dc,Ai:a.Ai,nh:a.nh,yd:a.yd,Se:a.Kc===b.dd,Nm:a.Kc===b.rf};var D,xa,s;f=[];q?f.push(q):(f.push(u),f.push(H));for(xa in aa)f.push(xa),f.push(aa[xa]);for(D in d)f.push(D),f.push(d[D]);q=f.join();D=0;for(xa=Ga.length;xa>D;D++)if(f=Ga[D],f.code===q){E=(f.mo++,f.Ob);break a}D="SHADOWMAP_TYPE_BASIC";d.Ui===b.Jo?D="SHADOWMAP_TYPE_PCF":d.Ui===b.Ko&&(D="SHADOWMAP_TYPE_PCF_SOFT");f=[];for(var v in aa)xa=
aa[v],!1!==xa&&(s="#define "+v+" "+xa,f.push(s));xa=f.join("\n");s=n.createProgram();v=["precision "+G+" float;",d.Xb||d.wb?"#extension GL_OES_standard_derivatives : enable":"",xa,"#define MAX_DIR_LIGHTS "+d.Tq,"#define MAX_POINT_LIGHTS "+d.Wq,"#define MAX_SPOT_LIGHTS "+d.Yq,"#define MAX_HEMI_LIGHTS "+d.Uq,"#define MAX_SHADOWS "+d.Xq,d.Dc?"#define ALPHATEST "+d.Dc:"",T.jc?"#define GAMMA_INPUT":"",T.$g?"#define GAMMA_OUTPUT":"",T.oh?"#define PHYSICALLY_BASED_SHADING":"",d.xs&&d.D?"#define USE_FOG":
"",d.xs&&d.aw?"#define FOG_EXP2":"",d.map?"#define USE_MAP":"",d.pa?"#define USE_ENVMAP":"",d.Ta?"#define USE_LIGHTMAP":"",d.Xb?"#define USE_BUMPMAP":"",d.wb?"#define USE_NORMALMAP":"",d.Qa?"#define USE_SPECULARMAP":"",d.m?"#define USE_COLOR":"",d.Ai?"#define METAL":"",d.nh?"#define PHONG_PER_PIXEL":"",d.yd?"#define WRAP_AROUND":"",d.Se?"#define DOUBLE_SIDED":"",d.Nm?"#define FLIP_SIDED":"",d.hg?"#define USE_SHADOWMAP":"",d.hg?"#define "+D:"",d.Vk?"#define SHADOWMAP_DEBUG":"",d.Uk?"#define SHADOWMAP_CASCADE":
"","uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\n"].join("\n");D=Y("vertex",["precision "+G+" float;",xa,Xb?"#define VERTEX_TEXTURES":"",T.jc?"#define GAMMA_INPUT":"",T.$g?"#define GAMMA_OUTPUT":"",T.oh?"#define PHYSICALLY_BASED_SHADING":"","#define MAX_DIR_LIGHTS "+d.Tq,"#define MAX_POINT_LIGHTS "+d.Wq,"#define MAX_SPOT_LIGHTS "+d.Yq,"#define MAX_HEMI_LIGHTS "+d.Uq,"#define MAX_SHADOWS "+d.Xq,"#define MAX_BONES "+d.Ex,d.map?"#define USE_MAP":"",d.pa?"#define USE_ENVMAP":"",d.Ta?"#define USE_LIGHTMAP":
"",d.Xb?"#define USE_BUMPMAP":"",d.wb?"#define USE_NORMALMAP":"",d.Qa?"#define USE_SPECULARMAP":"",d.m?"#define USE_COLOR":"",d.Ka?"#define USE_SKINNING":"",d.te?"#define BONE_TEXTURE":"",d.Kg?"#define N_BONE_PIXEL_X "+d.Kg.toFixed(1):"",d.Jg?"#define N_BONE_PIXEL_Y "+d.Jg.toFixed(1):"",d.B?"#define USE_MORPHTARGETS":"",d.sa?"#define USE_MORPHNORMALS":"",d.nh?"#define PHONG_PER_PIXEL":"",d.yd?"#define WRAP_AROUND":"",d.Se?"#define DOUBLE_SIDED":"",d.Nm?"#define FLIP_SIDED":"",d.hg?"#define USE_SHADOWMAP":
"",d.hg?"#define "+D:"",d.Vk?"#define SHADOWMAP_DEBUG":"",d.Uk?"#define SHADOWMAP_CASCADE":"",d.ec?"#define USE_SIZEATTENUATION":"","uniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\nattribute vec2 uv2;\n#ifdef USE_COLOR\nattribute vec3 color;\n#endif\n#ifdef USE_MORPHTARGETS\nattribute vec3 morphTarget0;\nattribute vec3 morphTarget1;\nattribute vec3 morphTarget2;\nattribute vec3 morphTarget3;\n#ifdef USE_MORPHNORMALS\nattribute vec3 morphNormal0;\nattribute vec3 morphNormal1;\nattribute vec3 morphNormal2;\nattribute vec3 morphNormal3;\n#else\nattribute vec3 morphTarget4;\nattribute vec3 morphTarget5;\nattribute vec3 morphTarget6;\nattribute vec3 morphTarget7;\n#endif\n#endif\n#ifdef USE_SKINNING\nattribute vec4 skinIndex;\nattribute vec4 skinWeight;\n#endif\n"].join("\n")+
H);v=Y("fragment",v+u);n.attachShader(s,D);n.attachShader(s,v);n.linkProgram(s);n.getProgramParameter(s,n.LINK_STATUS)||console.error("Could not initialise shader\nVALIDATE_STATUS: "+n.getProgramParameter(s,n.VALIDATE_STATUS)+", gl error ["+n.getError()+"]");n.deleteShader(v);n.deleteShader(D);s.N={};s.attributes={};var t;v="viewMatrix modelViewMatrix projectionMatrix normalMatrix modelMatrix cameraPosition morphTargetInfluences".split(" ");d.te?v.push("boneTexture"):v.push("boneGlobalMatrices");
for(t in r)v.push(t);t=v;v=0;for(D=t.length;D>v;v++)xa=t[v],s.N[xa]=n.getUniformLocation(s,xa);v="position normal uv uv2 tangent color skinIndex skinWeight lineDistance".split(" ");for(t=0;t<d.zi;t++)v.push("morphTarget"+t);for(t=0;t<d.Dk;t++)v.push("morphNormal"+t);for(E in e)v.push(E);E=v;t=0;for(v=E.length;v>t;t++)e=E[t],s.attributes[e]=n.getAttribLocation(s,e);E=(s.id=ra++,Ga.push({Ob:s,code:q,mo:1}),T.info.memory.lr=Ga.length,s)}a.Ob=E;t=a.Ob.attributes;if(a.B)for(a.Ei=0,v="morphTarget",E=0;E<
this.zi;E++)s=v+E,0<=t[s]&&a.Ei++;if(a.sa)for(a.dr=0,v="morphNormal",E=0;E<this.Dk;E++)s=v+E,0<=t[s]&&a.dr++;a.vs=[];for(m in a.N)a.vs.push([a.N[m],m])};this.Cr=function(a,c){a===b.Ts?n.disable(n.CULL_FACE):(c===b.Zs?n.frontFace(n.CW):n.frontFace(n.CCW),a===b.Ss?n.cullFace(n.BACK):a===b.lj?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK),n.enable(n.CULL_FACE))};this.Pn=function(a){var c=a.Kc===b.dd;a=a.Kc===b.rf;Pa!==c&&(c?n.disable(n.CULL_FACE):n.enable(n.CULL_FACE),Pa=c);Ka!==a&&(a?n.frontFace(n.CW):
n.frontFace(n.CCW),Ka=a)};this.fg=function(a){$!==a&&(a?n.enable(n.DEPTH_TEST):n.disable(n.DEPTH_TEST),$=a)};this.Mi=function(a){Ha!==a&&(n.depthMask(a),Ha=a)};this.rh=function(a,c,e,d){a!==ya&&(a===b.Bl?n.disable(n.BLEND):a===b.yb?(n.enable(n.BLEND),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.SRC_ALPHA,n.ONE)):a===b.$o?(n.enable(n.BLEND),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ZERO,n.ONE_MINUS_SRC_COLOR)):a===b.jt?(n.enable(n.BLEND),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ZERO,n.SRC_COLOR)):a===
b.so?n.enable(n.BLEND):(n.enable(n.BLEND),n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD),n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA)),ya=a);a===b.so?(c!==ia&&(n.blendEquation(ma(c)),ia=c),(e!==sa||d!==La)&&(n.blendFunc(ma(e),ma(d)),sa=e,La=d)):(ia=null,sa=null,La=null)};this.Oi=function(a,c){if(a.ea){a.ge||(a.ge=!0,a.addEventListener("dispose",f),a.Bc=n.createTexture(),T.info.memory.ka++);n.activeTexture(n.TEXTURE0+c);n.bindTexture(n.TEXTURE_2D,a.Bc);n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,
a.Nf);n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.Gn);n.pixelStorei(n.UNPACK_ALIGNMENT,a.jo);var e=a.R,d=C(e.width)&&C(e.height),g=ma(a.ma),h=ma(a.type);y(n.TEXTURE_2D,a,d);var k=a.dc;if(a instanceof b.uf)if(0<k.length&&d){for(var l=0,m=k.length;m>l;l++)e=k[l],n.texImage2D(n.TEXTURE_2D,l,g,e.width,e.height,0,g,h,e.data);a.Eb=!1}else n.texImage2D(n.TEXTURE_2D,0,g,e.width,e.height,0,g,h,e.data);else if(a instanceof b.tf)for(l=0,m=k.length;m>l;l++)e=k[l],n.compressedTexImage2D(n.TEXTURE_2D,l,g,
e.width,e.height,0,e.data);else if(0<k.length&&d){l=0;for(m=k.length;m>l;l++)e=k[l],n.texImage2D(n.TEXTURE_2D,l,g,g,h,e);a.Eb=!1}else n.texImage2D(n.TEXTURE_2D,0,g,g,h,a.R);a.Eb&&d&&n.generateMipmap(n.TEXTURE_2D);a.ea=!1;a.Ik&&a.Ik()}else n.activeTexture(n.TEXTURE0+c),n.bindTexture(n.TEXTURE_2D,a.Bc)};this.Rk=function(a){var c=a instanceof b.Ff;if(a&&!a.fe){void 0===a.Jd&&(a.Jd=!0);void 0===a.ud&&(a.ud=!0);a.addEventListener("dispose",d);a.Bc=n.createTexture();T.info.memory.ka++;var e=C(a.width)&&
C(a.height),f=ma(a.ma),g=ma(a.type);if(c){a.fe=[];a.ie=[];n.bindTexture(n.TEXTURE_CUBE_MAP,a.Bc);y(n.TEXTURE_CUBE_MAP,a,e);for(var h=0;6>h;h++){a.fe[h]=n.createFramebuffer();a.ie[h]=n.createRenderbuffer();n.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+h,0,f,a.width,a.height,0,f,g,null);var k=a,l=n.TEXTURE_CUBE_MAP_POSITIVE_X+h;n.bindFramebuffer(n.FRAMEBUFFER,a.fe[h]);n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,l,k.Bc,0);D(a.ie[h],a)}e&&n.generateMipmap(n.TEXTURE_CUBE_MAP)}else a.fe=n.createFramebuffer(),
a.ie=a.$i?a.$i.ie:n.createRenderbuffer(),n.bindTexture(n.TEXTURE_2D,a.Bc),y(n.TEXTURE_2D,a,e),n.texImage2D(n.TEXTURE_2D,0,f,a.width,a.height,0,f,g,null),f=n.TEXTURE_2D,n.bindFramebuffer(n.FRAMEBUFFER,a.fe),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,f,a.Bc,0),a.$i?a.Jd&&!a.ud?n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,a.ie):a.Jd&&a.ud&&n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,a.ie):D(a.ie,a),e&&n.generateMipmap(n.TEXTURE_2D);
c?n.bindTexture(n.TEXTURE_CUBE_MAP,null):n.bindTexture(n.TEXTURE_2D,null);n.bindRenderbuffer(n.RENDERBUFFER,null);n.bindFramebuffer(n.FRAMEBUFFER,null)}var m,E,p,q,r;a?(m=c?a.fe[a.Gf]:a.fe,E=a.width,p=a.height,q=0,r=0):(m=null,E=X,p=za,q=xa,r=H);m!==bb&&(n.bindFramebuffer(n.FRAMEBUFFER,m),n.viewport(q,r,E,p),bb=m);ab=E;lb=p};this.Qr=new b.Hl;this.Fu(this.Qr);this.Cp(new b.zt);this.Cp(new b.dt)};b.Ge=function(a,e,c){this.width=a;this.height=e;c=c||{};this.pc=void 0!==c.pc?c.pc:b.sf;this.qc=void 0!==
c.qc?c.qc:b.sf;this.Gb=void 0!==c.Gb?c.Gb:b.ae;this.nb=void 0!==c.nb?c.nb:b.yl;this.ic=void 0!==c.ic?c.ic:1;this.offset=new b.i(0,0);this.repeat=new b.i(1,1);this.ma=void 0!==c.ma?c.ma:b.Bf;this.type=void 0!==c.type?c.type:b.Ll;this.Jd=void 0!==c.Jd?c.Jd:!0;this.ud=void 0!==c.ud?c.ud:!0;this.Eb=!0;this.$i=null};b.Ge.prototype={constructor:b.Ge,addEventListener:b.P.prototype.addEventListener,eb:b.P.prototype.eb,removeEventListener:b.P.prototype.removeEventListener,dispatchEvent:b.P.prototype.dispatchEvent,
d:function(){var a=new b.Ge(this.width,this.height);return a.pc=this.pc,a.qc=this.qc,a.Gb=this.Gb,a.nb=this.nb,a.ic=this.ic,a.offset.copy(this.offset),a.repeat.copy(this.repeat),a.ma=this.ma,a.type=this.type,a.Jd=this.Jd,a.ud=this.ud,a.Eb=this.Eb,a.$i=this.$i,a}};b.Ff=function(a,e,c){b.Ge.call(this,a,e,c);this.Gf=0};b.Ff.prototype=Object.create(b.Ge.prototype);b.vc=function(){this.nd=new b.a;this.e=new b.Rc;this.visible=!0};b.vc.prototype.copy=function(a){this.nd.copy(a.nd);this.e.copy(a.e)};b.To=
function(){this.ca=new b.vc;this.ga=new b.vc;this.Qb=new b.vc;this.Rh=new b.a;this.Wf=new b.a;this.Gk=new b.a;this.ml=0;this.ue=[new b.a,new b.a,new b.a];this.bd=[new b.a,new b.a,new b.a];this.n=this.color=null;this.pg=[[]];this.z=null};b.Uo=function(){this.ca=new b.vc;this.ga=new b.vc;this.Qb=new b.vc;this.no=new b.vc;this.Rh=new b.a;this.Wf=new b.a;this.Gk=new b.a;this.ml=0;this.ue=[new b.a,new b.a,new b.a,new b.a];this.bd=[new b.a,new b.a,new b.a,new b.a];this.n=this.color=null;this.pg=[[]];this.z=
null};b.tt=function(){this.z=this.object=null};b.Wo=function(){this.rotation=this.z=this.y=this.x=this.object=null;this.scale=new b.i;this.n=null};b.Vo=function(){this.z=null;this.ca=new b.vc;this.ga=new b.vc;this.m=[new b.k,new b.k];this.n=null};b.Ma={Uf:function(a,e,c){var d,f,g=a.c.length,h=(a.C[0].length,e instanceof b.J?e.l:e),k=a.c,l=h.c,m=a.j,q=h.j;a=a.C[0];h=h.C[0];void 0===c&&(c=0);e instanceof b.J&&(e.Va&&e.Nc(),d=e.ba,f=(new b.Ad).We(d));e=0;for(var p=l.length;p>e;e++){var r=l[e].d();d&&
r.Z(d);k.push(r)}e=0;for(p=q.length;p>e;e++){var v,w,r=q[e],u=r.G,s=r.m;r instanceof b.S?v=new b.S(r.r+g,r.h+g,r.t+g):r instanceof b.qa&&(v=new b.qa(r.r+g,r.h+g,r.t+g,r.oa+g));v.s.copy(r.s);f&&v.s.Fd(f).normalize();k=0;for(l=u.length;l>k;k++)w=u[k].d(),f&&w.Fd(f).normalize(),v.G.push(w);v.color.copy(r.color);k=0;for(l=s.length;l>k;k++)w=s[k],v.m.push(w.d());v.Ca=r.Ca+c;v.ya.copy(r.ya);d&&v.ya.Z(d);m.push(v)}e=0;for(p=h.length;p>e;e++){c=h[e];d=[];k=0;for(l=c.length;l>k;k++)d.push(new b.i(c[k].x,c[k].y));
a.push(d)}},jG:function(a,b){for(var c={},d=0,f=b.length;f>d;d++)c[b[d]]=!0;for(var g,h=[],d=0,f=a.j.length;f>d;d++)g=a.j[d],g.Ca in c||h.push(g);a.j=h},In:function(a,e,c){var d,f,g,h=new b.a,k=b.Ma.Bj;return d=b.Ma.random(),f=b.Ma.random(),1<d+f&&(d=1-d,f=1-f),g=1-d-f,h.copy(a),h.p(d),k.copy(e),k.p(f),h.add(k),k.copy(c),k.p(g),h.add(k),h},Gy:function(a,e,c){var d,f,g;if(a instanceof b.S)return d=e.c[a.r],f=e.c[a.h],g=e.c[a.t],b.Ma.In(d,f,g);if(a instanceof b.qa){d=e.c[a.r];f=e.c[a.h];g=e.c[a.t];
e=e.c[a.oa];var h,k;c?a.Kj&&a.Lj?(h=a.Kj,k=a.Lj):(h=b.Ma.mg(d,f,e),k=b.Ma.mg(f,g,e),a.Kj=h,a.Lj=k):(h=b.Ma.mg(d,f,e),k=b.Ma.mg(f,g,e));a=b.Ma.random()*(h+k);return h>a?b.Ma.In(d,f,e):b.Ma.In(f,g,e)}},fG:function(a,e){function c(a){function b(c,e){if(c>e)return c;var d=c+Math.floor((e-c)/2);return v[d]>a?b(c,d-1):v[d]<a?b(d+1,e):d}return b(0,v.length-1)}var d,f,g,h,k,l,m=a.j,q=a.c,p=m.length,r=0,v=[];for(f=0;p>f;f++)d=m[f],d instanceof b.S?(g=q[d.r],h=q[d.h],k=q[d.t],d.up=b.Ma.mg(g,h,k)):d instanceof
b.qa&&(g=q[d.r],h=q[d.h],k=q[d.t],l=q[d.oa],d.Kj=b.Ma.mg(g,h,l),d.Lj=b.Ma.mg(h,k,l),d.up=d.Kj+d.Lj),r+=d.up,v[f]=r;d=[];g={};for(f=0;e>f;f++)h=b.Ma.random()*r,h=c(h),d[f]=b.Ma.Gy(m[h],a,!0),g[h]?g[h]+=1:g[h]=1;return d},mg:function(a,e,c){var d=b.Ma.Bj,f=b.Ma.Ol;return d.X(e,a),f.X(c,a),d.Id(f),0.5*d.length()},bb:function(a){a.Zh();var e=a.Fc,c=new b.a;return c.fd(e.min,e.max),c.p(-0.5),a.ke((new b.K).Ck(c.x,c.y,c.z)),a.Zh(),c},pF:function(a){a=a.C[0];for(var b=0,c=a.length;c>b;b++)for(var d=a[b],
f=0,g=d.length;g>f;f++)1!==d[f].x&&(d[f].x-=Math.floor(d[f].x)),1!==d[f].y&&(d[f].y-=Math.floor(d[f].y))},yH:function(a){var e,c,d,f,g=[],h=[],k=[];e=0;for(c=a.jd.length;c>e;e++)h[e]=[];e=0;for(c=a.C.length;c>e;e++)k[e]=[];e=0;for(c=a.j.length;c>e;e++)if(d=a.j[e],d instanceof b.qa){f=d.r;var l=d.h,m=d.t,q=d.oa,p=new b.S,r=new b.S;p.color.copy(d.color);r.color.copy(d.color);p.Ca=d.Ca;r.Ca=d.Ca;p.r=f;p.h=l;p.t=q;r.r=l;r.h=m;r.t=q;4===d.m.length&&(p.m[0]=d.m[0].d(),p.m[1]=d.m[1].d(),p.m[2]=d.m[3].d(),
r.m[0]=d.m[1].d(),r.m[1]=d.m[2].d(),r.m[2]=d.m[3].d());g.push(p,r);d=0;for(f=a.C.length;f>d;d++)a.C[d].length&&(p=a.C[d][e],l=p[1],m=p[2],q=p[3],p=[p[0].d(),l.d(),q.d()],l=[l.d(),m.d(),q.d()],k[d].push(p,l));d=0;for(f=a.jd.length;f>d;d++)a.jd[d].length&&(l=a.jd[d][e],h[d].push(l,l))}else{g.push(d);d=0;for(f=a.jd.length;f>d;d++)h[d].push(a.jd[d][e]);d=0;for(f=a.C.length;f>d;d++)k[d].push(a.C[d][e])}a.j=g;a.jd=h;a.C=k;a.tb();a.Yb();a.ne();a.eh&&a.Wj()},EG:function(a,b,c,d){a=a.j;d=d||a.length-1;for(c=
c||0;d>=c;c++)a[c].Ca=b}};b.Ma.random=b.be.Fy;b.Ma.Bj=new b.a;b.Ma.Ol=new b.a;b.zd={crossOrigin:"anonymous",gn:function(a,e,c,d){var f=new Image,g=new b.Vb(f,e);e=new b.tl;return e.addEventListener("load",function(a){g.R=a.content;g.ea=!0;c&&c(g)}),e.addEventListener("error",function(a){d&&d(a.message)}),e.crossOrigin=this.crossOrigin,e.load(a,f),g.rz=a,g},Mq:function(a,e,c,d){var f=new b.tf;f.Nb=e;var g=new XMLHttpRequest;return g.onload=function(){var a=b.zd.yn(g.response,!0);f.ma=a.ma;f.dc=a.dc;
f.R.width=a.width;f.R.height=a.height;f.Eb=!1;f.ea=!0;c&&c(f)},g.onerror=d,g.open("GET",a,!0),g.responseType="arraybuffer",g.send(null),f},mx:function(a,e,c,d){var f=[];f.Tf=0;var g=new b.Vb;g.R=f;void 0!==e&&(g.Nb=e);g.Nf=!1;e=0;for(var h=a.length;h>e;++e){var k=new Image;f[e]=k;k.onload=function(){f.Tf+=1;6===f.Tf&&(g.ea=!0,c&&c(g))};k.onerror=d;k.crossOrigin=this.crossOrigin;k.src=a[e]}return g},hx:function(a,e,c,d){function f(a,e){return function(){var d=b.zd.yn(a.response,!0);e.ma=d.ma;e.dc=
d.dc;e.width=d.width;e.height=d.height;g.Tf+=1;6===g.Tf&&(h.ma=d.ma,h.ea=!0,c&&c(h))}}var g=[];g.Tf=0;var h=new b.tf;h.R=g;void 0!==e&&(h.Nb=e);h.Nf=!1;h.Eb=!1;if(a instanceof Array){e=0;for(var k=a.length;k>e;++e){var l={};g[e]=l;var m=new XMLHttpRequest;m.onload=f(m,l);m.onerror=d;l=a[e];m.open("GET",l,!0);m.responseType="arraybuffer";m.send(null)}}else m=new XMLHttpRequest,m.onload=function(){var a=b.zd.yn(m.response,!0);if(a.Eq){for(var e=a.dc.length/a.hh,d=0;e>d;d++){g[d]={dc:[]};for(var f=0;f<
a.hh;f++)g[d].dc.push(a.dc[d*a.hh+f]),g[d].ma=a.ma,g[d].width=a.width,g[d].height=a.height}h.ma=a.ma;h.ea=!0;c&&c(h)}},m.onerror=d,m.open("GET",a,!0),m.responseType="arraybuffer",m.send(null);return h},yn:function(a,e){function c(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}var d={dc:[],width:0,height:0,ma:null,hh:1},f=c("DXT1"),g=c("DXT3"),h=c("DXT5"),k=new Int32Array(a,0,31);if(542327876!==k[0])return console.error("ImageUtils.parseDDS(): Invalid magic number in DDS header"),
d;if(!k[20]&4)return console.error("ImageUtils.parseDDS(): Unsupported format, must contain a FourCC code"),d;var l=k[21];switch(l){case f:f=8;d.ma=b.Po;break;case g:f=16;d.ma=b.No;break;case h:f=16;d.ma=b.Oo;break;default:return console.error("ImageUtils.parseDDS(): Unsupported FourCC code: ",String.fromCharCode(255&l,255&l>>8,255&l>>16,255&l>>24)),d}d.hh=1;k[2]&131072&&!1!==e&&(d.hh=Math.max(1,k[7]));d.Eq=k[28]&512?!0:!1;d.width=k[4];d.height=k[3];for(var k=k[1]+4,g=d.width,h=d.height,l=d.Eq?6:
1,m=0;l>m;m++){for(var q=0;q<d.hh;q++){var p=Math.max(4,g)/4*Math.max(4,h)/4*f,r={data:new Uint8Array(a,k,p),width:g,height:h};d.dc.push(r);k+=p;g=Math.max(0.5*g,1);h=Math.max(0.5*h,1)}g=d.width;h=d.height}return d},WC:function(a,b){b|=1;var c=a.width,d=a.height,f=document.createElement("canvas");f.width=c;f.height=d;var g=f.getContext("2d");g.drawImage(a,0,0);for(var h=g.getImageData(0,0,c,d).data,k=g.createImageData(c,d),l=k.data,m=0;c>m;m++)for(var q=0;d>q;q++){var p=0>q-1?0:q-1,r=q+1>d-1?d-1:
q+1,v=0>m-1?0:m-1,w=m+1>c-1?c-1:m+1,u=[],s=[0,0,h[4*(q*c+m)]/255*b];u.push([-1,0,h[4*(q*c+v)]/255*b]);u.push([-1,-1,h[4*(p*c+v)]/255*b]);u.push([0,-1,h[4*(p*c+m)]/255*b]);u.push([1,-1,h[4*(p*c+w)]/255*b]);u.push([1,0,h[4*(q*c+w)]/255*b]);u.push([1,1,h[4*(r*c+w)]/255*b]);u.push([0,1,h[4*(r*c+m)]/255*b]);u.push([-1,1,h[4*(r*c+v)]/255*b]);p=[];v=u.length;for(r=0;v>r;r++){var w=u[r],t=u[(r+1)%v],w=[w[0]-s[0],w[1]-s[1],w[2]-s[2]],t=[t[0]-s[0],t[1]-s[1],t[2]-s[2]],w=[w[1]*t[2]-w[2]*t[1],w[2]*t[0]-w[0]*
t[2],w[0]*t[1]-w[1]*t[0]],t=Math.sqrt(w[0]*w[0]+w[1]*w[1]+w[2]*w[2]);p.push([w[0]/t,w[1]/t,w[2]/t])}u=[0,0,0];for(r=0;r<p.length;r++)u[0]+=p[r][0],u[1]+=p[r][1],u[2]+=p[r][2];u[0]/=p.length;u[1]/=p.length;u[2]/=p.length;s=4*(q*c+m);l[s]=0|255*((u[0]+1)/2);l[s+1]=0|255*((u[1]+1)/2);l[s+2]=0|255*u[2];l[s+3]=255}return g.putImageData(k,0,0),f},TC:function(a,e,c){var d=a*e,f=new Uint8Array(3*d),g=Math.floor(255*c.q),h=Math.floor(255*c.o);c=Math.floor(255*c.h);for(var k=0;d>k;k++)f[3*k]=g,f[3*k+1]=h,f[3*
k+2]=c;a=new b.uf(f,a,e,b.Fl);return a.ea=!0,a}};b.EA={PB:function(a,e){for(var c=new b.w,d=0,f=e.length;f>d;d++)c.add(new b.J(a,e[d]));return c},detach:function(a,b,c){a.ke(b.A);b.remove(a);c.add(a)},gB:function(a,e,c){var d=new b.K;d.Ld(c.A);a.ke(d);e.remove(a);c.add(a)}};b.zb={j:{},face:"helvetiker",xe:"normal",style:"normal",size:150,Em:10,iw:function(){return this.j[this.face][this.xe][this.style]},Nq:function(a){var b=a.HC.toLowerCase();return this.j[b]=this.j[b]||{},this.j[b][a.um]=this.j[b][a.um]||
{},this.j[b][a.um][a.wv]=a,this.j[b][a.um][a.wv]=a,a},Gv:function(a){var e=this.iw(),c=this.size/e.mG,d=0,f=String(a).split(""),g=f.length,h=[];for(a=0;g>a;a++){var k=new b.Ab,k=this.Rv(f[a],e,c,d,k),d=d+k.offset;h.push(k.path)}return{oy:h,offset:d/2}},Rv:function(a,b,c,d,f){var g,h,k,l,m,q,p,r,v,w=[],u=b.rw[a]||b.rw["?"];if(u){if(u.Wx)for(b=u.bu||(u.bu=u.Wx.split(" ")),k=b.length,a=0;k>a;)switch(b[a++]){case "m":g=b[a++]*c+d;h=b[a++]*c;f.moveTo(g,h);break;case "l":g=b[a++]*c+d;h=b[a++]*c;f.lineTo(g,
h);break;case "q":if(l=b[a++]*c+d,m=b[a++]*c,q=b[a++]*c+d,p=b[a++]*c,f.quadraticCurveTo(q,p,l,m),w[w.length-1])for(g=1,h=this.Em;h>=g;g++);break;case "b":if(l=b[a++]*c+d,m=b[a++]*c,q=b[a++]*c+d,p=b[a++]*-c,r=b[a++]*c+d,v=b[a++]*-c,f.bezierCurveTo(l,m,q,p,r,v),w[w.length-1])for(g=1,h=this.Em;h>=g;g++);}return{offset:u.gD*c,path:f}}}};b.zb.ew=function(a,e){e=e||{};var c=void 0!==e.di?e.di:4,d=void 0!==e.font?e.font:"helvetiker",f=void 0!==e.xe?e.xe:"normal",g=void 0!==e.style?e.style:"normal";b.zb.size=
void 0!==e.size?e.size:100;b.zb.Em=c;b.zb.face=d;b.zb.xe=f;b.zb.style=g;c=b.zb.Gv(a).oy;d=[];f=0;for(g=c.length;g>f;f++)Array.prototype.push.apply(d,c[f].Nz());return d};(function(a){function b(a){for(var e=a.length,f=0,g=e-1,h=0;e>h;g=h++)f+=a[g].x*a[h].y-a[h].x*a[g].y;return 0.5*f}return a.Ef=function(a,d){var f=a.length;if(3>f)return null;var g,h,k,l=[],m=[],q=[];if(0<b(a))for(h=0;f>h;h++)m[h]=h;else for(h=0;f>h;h++)m[h]=f-1-h;var p=2*f;for(h=f-1;2<f;){if(0>=p--)return console.log("Warning, unable to triangulate polygon!"),
d?q:l;g=h;g>=f&&(g=0);h=g+1;h>=f&&(h=0);k=h+1;k>=f&&(k=0);var r;a:{var v=r=void 0,w=void 0,u=void 0,s=void 0,t=void 0,A=void 0,Q=void 0,O=void 0;if(v=a[m[g]].x,w=a[m[g]].y,u=a[m[h]].x,s=a[m[h]].y,t=a[m[k]].x,A=a[m[k]].y,1E-10>(u-v)*(A-w)-(s-w)*(t-v))r=!1;else{var P=void 0,I=void 0,F=void 0,L=void 0,K=void 0,N=void 0,B=void 0,W=void 0,M=void 0,J=void 0,R=void 0,U=void 0,Y=void 0,C=void 0,y=void 0,P=t-u,I=A-s,F=v-t,L=w-A,K=u-v,N=s-w;for(r=0;f>r;r++)if(r!==g&&r!==h&&r!==k&&(Q=a[m[r]].x,O=a[m[r]].y,B=
Q-v,W=O-w,M=Q-u,J=O-s,R=Q-t,U=O-A,y=P*J-I*M,Y=K*W-N*B,C=F*U-L*R,0<=y&&0<=C&&0<=Y)){r=!1;break a}r=!0}}if(r){l.push([a[m[g]],a[m[h]],a[m[k]]]);q.push([m[g],m[h],m[k]]);g=h;for(k=h+1;f>k;g++,k++)m[g]=m[k];f--;p=2*f}}return d?q:l},a.Ef.Hg=b,a})(b.zb);self.tu={j:b.zb.j,Nq:b.zb.Nq};b.AH=self.tu;b.$=Ia();b.$.prototype.Pa=function(){return console.log("Warning, getPoint() not implemented!"),null};b.$.prototype.pi=function(a){a=this.Um(a);return this.Pa(a)};b.$.prototype.bh=function(a){a||(a=5);var b,c=[];
for(b=0;a>=b;b++)c.push(this.Pa(b/a));return c};b.$.prototype.pk=function(a){a||(a=5);var b,c=[];for(b=0;a>=b;b++)c.push(this.pi(b/a));return c};b.$.prototype.Pf=function(){var a=this.rq();return a[a.length-1]};b.$.prototype.rq=function(){var a;if(a||(a=this.Ot?this.Ot:200),this.om&&this.om.length==a+1&&!this.ea)return this.om;this.ea=!1;var b,c,d=[],f=this.Pa(0),g=0;d.push(0);for(c=1;a>=c;c++)b=this.Pa(c/a),g+=b.gd(f),d.push(g),f=b;return this.om=d,d};b.$.prototype.Um=function(a,b){var c,d=this.rq(),
f=0,g=d.length;c=b?b:a*d[g-1];for(var h,k=0,l=g-1;l>=k;)if(f=Math.floor(k+(l-k)/2),h=d[f]-c,0>h)k=f+1;else{if(!(0<h)){l=f;break}l=f-1}if(f=l,d[f]==c)return f/(g-1);h=d[f];return c=(f+(c-h)/(d[f+1]-h))/(g-1)};b.$.prototype.qk=function(a){var b=a-1E-4;a+=1E-4;0>b&&(b=0);1<a&&(a=1);b=this.Pa(b);return this.Pa(a).d().sub(b).normalize()};b.$.prototype.pw=function(a){a=this.Um(a);return this.qk(a)};b.xg=function(a,b){this.ca=a;this.ga=b};b.xg.prototype=Object.create(b.$.prototype);b.xg.prototype.Pa=function(a){var b=
this.ga.d().sub(this.ca);return b.p(a).add(this.ca),b};b.xg.prototype.pi=function(a){return this.Pa(a)};b.xg.prototype.qk=function(){return this.ga.d().sub(this.ca).normalize()};b.uj=function(a,b,c){this.Hb=a;this.ca=b;this.ga=c};b.uj.prototype=Object.create(b.$.prototype);b.uj.prototype.Pa=function(a){var e,c;return e=b.aa.W.Hf(a,this.Hb.x,this.ca.x,this.ga.x),c=b.aa.W.Hf(a,this.Hb.y,this.ca.y,this.ga.y),new b.i(e,c)};b.uj.prototype.qk=function(a){a=new b.i(b.$.W.fs(a,this.Hb.x,this.ca.x,this.ga.x),
b.$.W.fs(a,this.Hb.y,this.ca.y,this.ga.y));return a.normalize(),a};b.kj=function(a,b,c,d){this.Hb=a;this.ca=b;this.ga=c;this.Qb=d};b.kj.prototype=Object.create(b.$.prototype);b.kj.prototype.Pa=function(a){var e,c;return e=b.aa.W.If(a,this.Hb.x,this.ca.x,this.ga.x,this.Qb.x),c=b.aa.W.If(a,this.Hb.y,this.ca.y,this.ga.y,this.Qb.y),new b.i(e,c)};b.kj.prototype.qk=function(a){a=new b.i(b.$.W.es(a,this.Hb.x,this.ca.x,this.ga.x,this.Qb.x),b.$.W.es(a,this.Hb.y,this.ca.y,this.ga.y,this.Qb.y));return a.normalize(),
a};b.Jl=function(a){this.M=void 0==a?[]:a};b.Jl.prototype=Object.create(b.$.prototype);b.Jl.prototype.Pa=function(a){var e,c,d,f=new b.i,g=[],h=this.M;return e=(h.length-1)*a,c=Math.floor(e),d=e-c,g[0]=0==c?c:c-1,g[1]=c,g[2]=c>h.length-2?h.length-1:c+1,g[3]=c>h.length-3?h.length-1:c+2,f.x=b.$.W.Fb(h[g[0]].x,h[g[1]].x,h[g[2]].x,h[g[3]].x,d),f.y=b.$.W.Fb(h[g[0]].y,h[g[1]].y,h[g[2]].y,h[g[3]].y,d),f};b.Ah=function(a,b,c,d,f,g,h){this.wu=a;this.xu=b;this.fA=c;this.gA=d;this.zp=f;this.vu=g;this.uu=h};
b.Ah.prototype=Object.create(b.$.prototype);b.Ah.prototype.Pa=function(a){var e=this.vu-this.zp;this.uu||(a=1-a);a=this.zp+a*e;return new b.i(this.wu+this.fA*Math.cos(a),this.xu+this.gA*Math.sin(a))};b.Hs=function(a,e,c,d,f,g){b.Ah.call(this,a,e,c,c,d,f,g)};b.Hs.prototype=Object.create(b.Ah.prototype);b.$.W={fs:function(a,b,c,d){return 2*(1-a)*(c-b)+2*a*(d-c)},es:function(a,b,c,d,f){return-3*b*(1-a)*(1-a)+3*c*(1-a)*(1-a)-6*a*c*(1-a)+6*a*d*(1-a)-3*a*a*d+3*a*a*f},iH:function(a){return 6*a*a-6*a+(3*
a*a-4*a+1)+(-6*a*a+6*a)+(3*a*a-2*a)},Fb:function(a,b,c,d,f){a=0.5*(c-a);d=0.5*(d-b);var g=f*f;return(2*b-2*c+a+d)*f*g+(-3*b+3*c-2*a-d)*g+a*f+b}};b.$.create=function(a,e){return a.prototype=Object.create(b.$.prototype),a.prototype.Pa=e,a};b.yA=b.$.create(function(a,b){this.ca=a;this.ga=b},function(a){var e=new b.a;return e.X(this.ga,this.ca),e.p(a),e.add(this.ca),e});b.CA=b.$.create(function(a,b,c){this.Hb=a;this.ca=b;this.ga=c},function(a){var e,c,d;return e=b.aa.W.Hf(a,this.Hb.x,this.ca.x,this.ga.x),
c=b.aa.W.Hf(a,this.Hb.y,this.ca.y,this.ga.y),d=b.aa.W.Hf(a,this.Hb.z,this.ca.z,this.ga.z),new b.a(e,c,d)});b.rA=b.$.create(function(a,b,c,d){this.Hb=a;this.ca=b;this.ga=c;this.Qb=d},function(a){var e,c,d;return e=b.aa.W.If(a,this.Hb.x,this.ca.x,this.ga.x,this.Qb.x),c=b.aa.W.If(a,this.Hb.y,this.ca.y,this.ga.y,this.Qb.y),d=b.aa.W.If(a,this.Hb.z,this.ca.z,this.ga.z,this.Qb.z),new b.a(e,c,d)});b.IA=b.$.create(function(a){this.M=void 0==a?[]:a},function(a){var e,c=new b.a,d=[],f=this.M;a*=f.length-1;e=
Math.floor(a);a-=e;d[0]=0==e?e:e-1;d[1]=e;d[2]=e>f.length-2?f.length-1:e+1;d[3]=e>f.length-3?f.length-1:e+2;e=f[d[0]];var g=f[d[1]],h=f[d[2]],d=f[d[3]];return c.x=b.$.W.Fb(e.x,g.x,h.x,d.x,a),c.y=b.$.W.Fb(e.y,g.y,h.y,d.y,a),c.z=b.$.W.Fb(e.z,g.z,h.z,d.z,a),c});b.oA=b.$.create(function(a){this.M=void 0==a?[]:a},function(a){var e,c,d,f=new b.a,g=[],h=this.M;return e=(h.length-0)*a,c=Math.floor(e),d=e-c,c+=0<c?0:(Math.floor(Math.abs(c)/h.length)+1)*h.length,g[0]=(c-1)%h.length,g[1]=c%h.length,g[2]=(c+
1)%h.length,g[3]=(c+2)%h.length,f.x=b.$.W.Fb(h[g[0]].x,h[g[1]].x,h[g[2]].x,h[g[3]].x,d),f.y=b.$.W.Fb(h[g[0]].y,h[g[1]].y,h[g[2]].y,h[g[3]].y,d),f.z=b.$.W.Fb(h[g[0]].z,h[g[1]].z,h[g[2]].z,h[g[3]].z,d),f});b.Oc=function(){this.kb=[];this.Tj=[];this.hB=!1};b.Oc.prototype=Object.create(b.$.prototype);b.Oc.prototype.add=function(a){this.kb.push(a)};b.Oc.prototype.closePath=function(){var a=this.kb[0].Pa(0),e=this.kb[this.kb.length-1].Pa(1);a.va(e)||this.kb.push(new b.xg(e,a))};b.Oc.prototype.Pa=function(a){var b;
b=a*this.Pf();var c=this.pq();for(a=0;a<c.length;){if(c[a]>=b)return b=c[a]-b,a=this.kb[a],b=1-b/a.Pf(),a.pi(b);a++}return null};b.Oc.prototype.Pf=function(){var a=this.pq();return a[a.length-1]};b.Oc.prototype.pq=function(){if(this.pm&&this.pm.length==this.kb.length)return this.pm;var a,b=[],c=0,d=this.kb.length;for(a=0;d>a;a++)c+=this.kb[a].Pf(),b.push(c);return this.pm=b,b};b.Oc.prototype.lk=function(){var a,e,c,d,f,g,h=this.bh();a=e=Number.NEGATIVE_INFINITY;d=f=Number.POSITIVE_INFINITY;var k,
l,m,q,p=h[0]instanceof b.a;q=p?new b.a:new b.i;l=0;for(m=h.length;m>l;l++)k=h[l],k.x>a?a=k.x:k.x<d&&(d=k.x),k.y>e?e=k.y:k.y<f&&(f=k.y),p&&(k.z>c?c=k.z:k.z<g&&(g=k.z)),q.add(k);a={QE:d,RE:f,Hx:a,CE:e,ya:q.oe(m)};return p&&(a.DE=c,a.SE=g),a};b.Oc.prototype.uq=function(a,b){var c,d,f=this.bh(a);b||(b=this.Tj);c=0;for(d=b.length;d>c;c++)f=this.wq(f,b[c]);return f};b.Oc.prototype.vq=function(a,b){var c,d,f=this.pk(a);b||(b=this.Tj);c=0;for(d=b.length;d>c;c++)f=this.wq(f,b[c]);return f};b.Oc.prototype.wq=
function(a,b){var c,d,f,g,h,k,l=this.lk();c=0;for(d=a.length;d>c;c++)f=a[c],g=f.x,h=f.y,k=g/l.Hx,k=b.Um(k,g),g=b.Pa(k),h=b.XC(k).p(h),f.x=g.x+h.x,f.y=g.y+h.y;return a};b.$d=function(){b.w.call(this)};b.$d.prototype=Object.create(b.w.prototype);b.$d.prototype.fc=function(a){this.Va&&this.Nc();(this.vb||a)&&(this.parent?(this.A.Da(this.parent.A,this.ba),this.A.xm(this.ms,this.Qy,this.zr),this.ba.xm(this.Pz,this.yr,this.Ry),this.A.Bk(this.ms,this.yr,this.zr)):this.A.copy(this.ba),this.vb=!1,a=!0);for(var b=
0,c=this.children.length;c>b;b++)this.children[b].fc(a)};b.$d.prototype.ms=new b.a;b.$d.prototype.Pz=new b.a;b.$d.prototype.Qy=new b.Bb;b.$d.prototype.yr=new b.Bb;b.$d.prototype.zr=new b.a;b.$d.prototype.Ry=new b.a;b.Ab=function(a){b.Oc.call(this);this.ra=[];a&&this.cw(a)};b.Ab.prototype=Object.create(b.Oc.prototype);b.tc={zl:"moveTo",Co:"lineTo",Mo:"quadraticCurveTo",qo:"bezierCurveTo",Ls:"splineThru",Fs:"arc",uo:"ellipse"};b.Ab.prototype.cw=function(a){this.moveTo(a[0].x,a[0].y);for(var b=1,c=a.length;c>
b;b++)this.lineTo(a[b].x,a[b].y)};b.Ab.prototype.moveTo=function(){var a=Array.prototype.slice.call(arguments);this.ra.push({action:b.tc.zl,Ec:a})};b.Ab.prototype.lineTo=function(a,e){var c=Array.prototype.slice.call(arguments),d=this.ra[this.ra.length-1].Ec;this.kb.push(new b.xg(new b.i(d[d.length-2],d[d.length-1]),new b.i(a,e)));this.ra.push({action:b.tc.Co,Ec:c})};b.Ab.prototype.quadraticCurveTo=function(a,e,c,d){var f=Array.prototype.slice.call(arguments),g=this.ra[this.ra.length-1].Ec;this.kb.push(new b.uj(new b.i(g[g.length-
2],g[g.length-1]),new b.i(a,e),new b.i(c,d)));this.ra.push({action:b.tc.Mo,Ec:f})};b.Ab.prototype.bezierCurveTo=function(a,e,c,d,f,g){var h=Array.prototype.slice.call(arguments),k=this.ra[this.ra.length-1].Ec;this.kb.push(new b.kj(new b.i(k[k.length-2],k[k.length-1]),new b.i(a,e),new b.i(c,d),new b.i(f,g)));this.ra.push({action:b.tc.qo,Ec:h})};b.Ab.prototype.arc=function(a,b,c,d,f,g){var h=this.ra[this.ra.length-1].Ec;this.yu(a+h[h.length-2],b+h[h.length-1],c,d,f,g)};b.Ab.prototype.yu=function(a,
b,c,d,f,g){this.zu(a,b,c,c,d,f,g)};b.Ab.prototype.zu=function(a,e,c,d,f,g,h){var k=Array.prototype.slice.call(arguments),l=new b.Ah(a,e,c,d,f,g,h);this.kb.push(l);l=l.Pa(h?1:0);k.push(l.x);k.push(l.y);this.ra.push({action:b.tc.uo,Ec:k})};b.Ab.prototype.pk=function(a){a||(a=40);for(var b=[],c=0;a>c;c++)b.push(this.Pa(c/a));return b};b.Ab.prototype.bh=function(a,e){if(this.Xz)return console.log("tata"),this.pk(a,e);a=a||12;var c,d,f,g,h,k,l,m,q,p,r,v,w,u,s,t,A=[];c=0;for(d=this.ra.length;d>c;c++)switch(f=
this.ra[c],g=f.action,h=f.Ec,g){case b.tc.zl:A.push(new b.i(h[0],h[1]));break;case b.tc.Co:A.push(new b.i(h[0],h[1]));break;case b.tc.Mo:k=h[2];l=h[3];p=h[0];r=h[1];0<A.length?(u=A[A.length-1],v=u.x,w=u.y):(u=this.ra[c-1].Ec,v=u[u.length-2],w=u[u.length-1]);for(h=1;a>=h;h++)s=h/a,t=b.aa.W.Hf(s,v,p,k),s=b.aa.W.Hf(s,w,r,l),A.push(new b.i(t,s));break;case b.tc.qo:k=h[4];l=h[5];p=h[0];r=h[1];m=h[2];q=h[3];0<A.length?(u=A[A.length-1],v=u.x,w=u.y):(u=this.ra[c-1].Ec,v=u[u.length-2],w=u[u.length-1]);for(h=
1;a>=h;h++)s=h/a,t=b.aa.W.If(s,v,p,m,k),s=b.aa.W.If(s,w,r,q,l),A.push(new b.i(t,s));break;case b.tc.Ls:u=this.ra[c-1].Ec;s=[new b.i(u[u.length-2],u[u.length-1])];t=a*h[0].length;s=s.concat(h[0]);s=new b.Jl(s);for(h=1;t>=h;h++)A.push(s.pi(h/t));break;case b.tc.Fs:k=h[0];l=h[1];r=h[2];m=h[3];t=h[4];p=!!h[5];var Q=t-m,O=2*a;for(h=1;O>=h;h++)s=h/O,p||(s=1-s),s=m+s*Q,t=k+r*Math.cos(s),s=l+r*Math.sin(s),A.push(new b.i(t,s));break;case b.tc.uo:for(k=h[0],l=h[1],r=h[2],q=h[3],m=h[4],t=h[5],p=!!h[6],Q=t-m,
O=2*a,h=1;O>=h;h++)s=h/O,p||(s=1-s),s=m+s*Q,t=k+r*Math.cos(s),s=l+q*Math.sin(s),A.push(new b.i(t,s))}c=A[A.length-1];return 1E-10>Math.abs(c.x-A[0].x)&&1E-10>Math.abs(c.y-A[0].y)&&A.splice(A.length-1,1),e&&A.push(A[0]),A};b.Ab.prototype.Nz=function(){var a,e,c,d,f=[],g=new b.Ab;a=0;for(e=this.ra.length;e>a;a++)c=this.ra[a],d=c.Ec,c=c.action,c==b.tc.zl&&0!=g.ra.length&&(f.push(g),g=new b.Ab),g[c].apply(g,d);if(0!=g.ra.length&&f.push(g),0==f.length)return[];var h,k;d=[];a=!b.aa.W.Rf(f[0].bh());if(1==
f.length)return h=f[0],k=new b.aa,k.ra=h.ra,k.kb=h.kb,d.push(k),d;if(a)for(k=new b.aa,a=0,e=f.length;e>a;a++)h=f[a],b.aa.W.Rf(h.bh())?(k.ra=h.ra,k.kb=h.kb,d.push(k),k=new b.aa):k.Nd.push(h);else{a=0;for(e=f.length;e>a;a++)h=f[a],b.aa.W.Rf(h.bh())?(k&&d.push(k),k=new b.aa,k.ra=h.ra,k.kb=h.kb):k.Nd.push(h);d.push(k)}return d};b.aa=function(){b.Ab.apply(this,arguments);this.Nd=[]};b.aa.prototype=Object.create(b.Ab.prototype);b.aa.prototype.lw=function(a){var b,c=this.Nd.length,d=[];for(b=0;c>b;b++)d[b]=
this.Nd[b].uq(a,this.Tj);return d};b.aa.prototype.nw=function(a){var b,c=this.Nd.length,d=[];for(b=0;c>b;b++)d[b]=this.Nd[b].vq(a,this.Tj);return d};b.aa.prototype.Pv=function(a){return{shape:this.uq(a),Nd:this.lw(a)}};b.aa.prototype.dq=function(a){return this.Xz?this.Qv(a):this.Pv(a)};b.aa.prototype.Qv=function(a){return{shape:this.vq(a),Nd:this.nw(a)}};b.aa.W={Jy:function(a,e){var c,d,f,g,h,k,l,m,q,p,r=a.concat(),v=r.concat(),w=[];for(h=0;h<e.length;h++){k=e[h];Array.prototype.push.apply(v,k);d=
Number.POSITIVE_INFINITY;for(c=0;c<k.length;c++)for(q=k[c],p=[],m=0;m<r.length;m++)l=r[m],l=q.Ug(l),p.push(l),d>l&&(d=l,f=c,g=m);c=0<=g-1?g-1:r.length-1;d=0<=f-1?f-1:k.length-1;var u=[k[f],r[g],r[c]];m=b.zb.Ef.Hg(u);var s=[k[f],k[d],r[g]];q=b.zb.Ef.Hg(s);p=g;l=f;g+=1;f+=-1;0>g&&(g+=r.length);g%=r.length;0>f&&(f+=k.length);f%=k.length;c=0<=g-1?g-1:r.length-1;d=0<=f-1?f-1:k.length-1;u=[k[f],r[g],r[c]];u=b.zb.Ef.Hg(u);s=[k[f],k[d],r[g]];s=b.zb.Ef.Hg(s);m+q>u+s&&(g=p,f=l,0>g&&(g+=r.length),g%=r.length,
0>f&&(f+=k.length),f%=k.length,c=0<=g-1?g-1:r.length-1,d=0<=f-1?f-1:k.length-1);m=r.slice(0,g);q=r.slice(g);p=k.slice(f);l=k.slice(0,f);d=[k[f],k[d],r[g]];w.push([k[f],r[g],r[c]]);w.push(d);r=m.concat(p).concat(l).concat(q)}return{shape:r,Pw:w,Iu:v}},os:function(a,e){var c,d,f,g,h;c=b.aa.W.Jy(a,e);f=c.Iu;var k=c.Pw,l=b.zb.Ef(c.shape,!1),m={};c=0;for(d=f.length;d>c;c++)h=f[c].x+":"+f[c].y,void 0!==m[h]&&console.log("Duplicate point",h),m[h]=c;c=0;for(d=l.length;d>c;c++)for(g=l[c],f=0;3>f;f++)h=g[f].x+
":"+g[f].y,h=m[h],void 0!==h&&(g[f]=h);c=0;for(d=k.length;d>c;c++)for(g=k[c],f=0;3>f;f++)h=g[f].x+":"+g[f].y,h=m[h],void 0!==h&&(g[f]=h);return l.concat(k)},Rf:function(a){return 0>b.zb.Ef.Hg(a)},Wu:function(a,b){var c=1-a;return c*c*b},Xu:function(a,b){return 2*(1-a)*a*b},Yu:function(a,b){return a*a*b},Hf:function(a,b,c,d){return this.Wu(a,b)+this.Xu(a,c)+this.Yu(a,d)},Zu:function(a,b){var c=1-a;return c*c*c*b},$u:function(a,b){var c=1-a;return 3*c*c*a*b},av:function(a,b){return 3*(1-a)*a*a*b},bv:function(a,
b){return a*a*a*b},If:function(a,b,c,d,f){return this.Zu(a,b)+this.$u(a,c)+this.av(a,d)+this.bv(a,f)}};b.Sb=function(){function a(b,c){c.push(b);for(var d=0;d<b.children.length;d++)a(b.children[d],c)}var e=[],c={},d={update:function(a){for(var b=0;b<e.length;b++)e[b].update(a)},XA:function(a){-1===e.indexOf(a)&&e.push(a)},qr:function(a){a=e.indexOf(a);-1!==a&&e.splice(a,1)},add:function(a){void 0!==c[a.name]&&console.log("THREE.AnimationHandler.add: Warning! "+a.name+" already exists in library. Overwriting.");
c[a.name]=a;if(!0!==a.Hw){for(var d=0;d<a.u.length;d++){for(var e=0;e<a.u[d].keys.length;e++)if(0>a.u[d].keys[e].time&&(a.u[d].keys[e].time=0),void 0!==a.u[d].keys[e].Nn&&!(a.u[d].keys[e].Nn instanceof b.Bb)){var k=a.u[d].keys[e].Nn;a.u[d].keys[e].Nn=new b.Bb(k[0],k[1],k[2],k[3])}if(a.u[d].keys.length&&void 0!==a.u[d].keys[0].B){k={};for(e=0;e<a.u[d].keys.length;e++)for(var l=0;l<a.u[d].keys[e].B.length;l++){var m=a.u[d].keys[e].B[l];k[m]=-1}a.u[d].JH=k;for(e=0;e<a.u[d].keys.length;e++){var q={};
for(m in k){for(l=0;l<a.u[d].keys[e].B.length;l++)if(a.u[d].keys[e].B[l]===m){q[m]=a.u[d].keys[e].Px[l];break}l===a.u[d].keys[e].B.length&&(q[m]=0)}a.u[d].keys[e].Px=q}}for(e=1;e<a.u[d].keys.length;e++)a.u[d].keys[e].time===a.u[d].keys[e-1].time&&(a.u[d].keys.splice(e,1),e--);for(e=0;e<a.u[d].keys.length;e++)a.u[d].keys[e].index=e}e=parseInt(a.length*a.Zg,10);a.oj={};a.oj.u=[];for(d=0;d<a.u.length;d++)a.oj.u.push(Array(e));a.Hw=!0}},get:function(a){return"string"==typeof a?c[a]?c[a]:(console.log("THREE.AnimationHandler.get: Couldn't find animation "+
a),null):void 0},parse:function(c){var d=[];if(c instanceof b.Ub)for(var e=0;e<c.ab.length;e++)d.push(c.ab[e]);else a(c,d);return d}};return d.LINEAR=0,d.ol=1,d.jj=2,d}();b.sg=function(a,e,c){this.root=a;this.data=b.Sb.get(e);this.u=b.Sb.parse(a);this.currentTime=0;this.bo=1;this.ui=!1;this.loop=this.Zm=!0;this.Ye=void 0!==c?c:b.Sb.LINEAR;this.M=[];this.target=new b.a};b.sg.prototype.stop=function(){this.Zm=this.ui=!1;b.Sb.qr(this)};b.sg.prototype.update=function(a){if(!1!==this.ui){var e,c,d,f,g,
h,k,l,m=["pos","rot","scl"];this.data.oj.u;var q,p,r,v,w;p=this.currentTime+=a*this.bo;q=this.currentTime%=this.data.length;Math.min(q*this.data.Zg,this.data.length*this.data.Zg);for(var u=0,s=this.u.length;s>u;u++){k=this.u[u];l=k.Pj;for(var t=0;3>t;t++){if(e=m[t],g=l.Hn[e],h=l.un[e],h.time<=p){if(p>q){if(!this.loop)return this.stop(),void 0;g=this.data.u[u].keys[0];for(h=this.ah(e,u,1);h.time<q;)g=h,h=this.ah(e,u,h.index+1)}else{do g=h,h=this.ah(e,u,h.index+1);while(h.time<q)}l.Hn[e]=g;l.un[e]=
h}k.Va=!0;k.vb=!0;a=(q-g.time)/(h.time-g.time);d=g[e];f=h[e];(0>a||1<a)&&(console.log("THREE.Animation.update: Warning! Scale out of bounds:"+a+" on bone "+u),a=0>a?0:1);"pos"===e?(c=k.position,this.Ye===b.Sb.LINEAR?(c.x=d[0]+(f[0]-d[0])*a,c.y=d[1]+(f[1]-d[1])*a,c.z=d[2]+(f[2]-d[2])*a):(this.Ye===b.Sb.ol||this.Ye===b.Sb.jj)&&(this.M[0]=this.Sm("pos",u,g.index-1).kr,this.M[1]=d,this.M[2]=f,this.M[3]=this.ah("pos",u,h.index+1).kr,a=0.33*a+0.33,r=this.Bq(this.M,a),c.x=r[0],c.y=r[1],c.z=r[2],this.Ye===
b.Sb.jj&&(v=this.Bq(this.M,1.01*a),this.target.set(v[0],v[1],v[2]),this.target.sub(c),this.target.y=0,this.target.normalize(),w=Math.atan2(this.target.x,this.target.z),k.rotation.set(0,w,0)))):"rot"===e?b.Bb.Zk(d,f,k.fa,a):"scl"===e&&(c=k.scale,c.x=d[0]+(f[0]-d[0])*a,c.y=d[1]+(f[1]-d[1])*a,c.z=d[2]+(f[2]-d[2])*a)}}}};b.sg.prototype.Bq=function(a,b){var c,d,f,g,h,k,l,m,q,p=[],r=[];return c=(a.length-1)*b,d=Math.floor(c),f=c-d,p[0]=0===d?d:d-1,p[1]=d,p[2]=d>a.length-2?d:d+1,p[3]=d>a.length-3?d:d+2,
k=a[p[0]],l=a[p[1]],m=a[p[2]],q=a[p[3]],g=f*f,h=f*g,r[0]=this.Fb(k[0],l[0],m[0],q[0],f,g,h),r[1]=this.Fb(k[1],l[1],m[1],q[1],f,g,h),r[2]=this.Fb(k[2],l[2],m[2],q[2],f,g,h),r};b.sg.prototype.Fb=function(a,b,c,d,f,g,h){a=0.5*(c-a);d=0.5*(d-b);return(2*(b-c)+a+d)*h+(-3*(b-c)-2*a-d)*g+a*f+b};b.sg.prototype.ah=function(a,e,c){var d=this.data.u[e].keys;for(this.Ye===b.Sb.ol||this.Ye===b.Sb.jj?c=c<d.length-1?c:d.length-1:c%=d.length;c<d.length;c++)if(void 0!==d[c][a])return d[c];return this.data.u[e].keys[0]};
b.sg.prototype.Sm=function(a,e,c){var d=this.data.u[e].keys;for(c=this.Ye===b.Sb.ol||this.Ye===b.Sb.jj?0<c?c:0:0<=c?c:c+d.length;0<=c;c--)if(void 0!==d[c][a])return d[c];return this.data.u[e].keys[d.length-1]};b.pj=function(a,e,c){this.root=a;this.data=b.Sb.get(e);this.u=b.Sb.parse(a);this.currentTime=0;this.bo=0.0010;this.ui=!1;this.loop=this.Zm=!0;this.vl=void 0!==c?c:!0;a=0;for(e=this.u.length;e>a;a++){c=this.data.u[a].uh;var d=this.u[a];if(this.data.u[a].keys.length&&c){for(var f=0;f<c.length;f++){var g=
c[f],h=this.ah(g,a,0);h&&h.apply(g)}d.Va=!1;this.data.u[a].Fk.Nc();d.vb=!0}}};b.pj.prototype.stop=function(){this.Zm=this.ui=!1;b.Sb.qr(this);for(var a=0;a<this.data.u.length;a++){var e=this.u[a],c=this.data.u[a];if(void 0!==c.Pj){var d=c.Pj.hr;e instanceof b.Zd?(d.copy(e.Wd),e.Wd=d):(d.copy(e.ba),e.ba=d);delete c.Pj}}};b.pj.prototype.update=function(a){if(this.ui){var e,c,d,f,g,h,k,l,m=this.data.oj.u;if(this.currentTime+=a*this.bo,k=this.currentTime,h=this.currentTime%=this.data.length,h<this.Cz&&
(h=this.currentTime=this.Cz+h),g=parseInt(Math.min(h*this.data.Zg,this.data.length*this.data.Zg),10),l=k>h,l&&!this.loop){a=0;for(var q=this.u.length;q>a;a++){var p=this.data.u[a].keys;e=this.data.u[a].uh;c=p.length-1;h=this.u[a];if(p.length){for(p=0;p<e.length;p++)k=e[p],(l=this.Sm(k,a,c))&&l.apply(k);this.data.u[a].Fk.Nc();h.vb=!0}}return this.stop(),void 0}if(!(h<this.startTime)){a=0;for(q=this.u.length;q>a;a++)if(d=this.u[a],f=this.data.u[a],p=f.keys,f=f.Pj,this.vl&&void 0!==m[a][g])d instanceof
b.Zd?(d.Wd=m[a][g],d.vb=!1):(d.ba=m[a][g],d.vb=!0);else if(p.length){if(this.vl&&f&&(d instanceof b.Zd?d.Wd=f.hr:d.ba=f.hr),e=f.Hn,c=f.un,e&&c){if(c.time<=k){if(l&&this.loop)for(e=p[0],c=p[1];c.time<h;)e=c,c=p[e.index+1];else if(!l)for(var r=p.length-1;c.time<h&&c.index!==r;)e=c,c=p[e.index+1];f.Hn=e;f.un=c}c.time>=h?e.Fb(c,h):e.Fb(c,c.time)}this.data.u[a].Fk.Nc();d.vb=!0}if(this.vl&&void 0===m[0][g])for(this.u[0].fc(!0),a=0;a<this.u.length;a++)m[a][g]=this.u[a]instanceof b.Zd?this.u[a].Wd.d():this.u[a].ba.d()}}};
b.pj.prototype.ah=function(a,b,c){b=this.data.u[b].keys;for(c%=b.length;c<b.length;c++)if(b[c].ri(a))return b[c];return b[0]};b.pj.prototype.Sm=function(a,b,c){b=this.data.u[b].keys;for(c=0<=c?c:c+b.length;0<=c;c--)if(b[c].ri(a))return b[c];return b[b.length-1]};b.Qs=function(a,e,c){b.w.call(this);var d=new b.uc(90,1,a,e);d.vd.set(0,-1,0);d.ub(new b.a(1,0,0));this.add(d);var f=new b.uc(90,1,a,e);f.vd.set(0,-1,0);f.ub(new b.a(-1,0,0));this.add(f);var g=new b.uc(90,1,a,e);g.vd.set(0,0,1);g.ub(new b.a(0,
1,0));this.add(g);var h=new b.uc(90,1,a,e);h.vd.set(0,0,-1);h.ub(new b.a(0,-1,0));this.add(h);var k=new b.uc(90,1,a,e);k.vd.set(0,-1,0);k.ub(new b.a(0,0,1));this.add(k);var l=new b.uc(90,1,a,e);l.vd.set(0,-1,0);l.ub(new b.a(0,0,-1));this.add(l);this.Ki=new b.Ff(c,c,{ma:b.Fl,Gb:b.ae,nb:b.ae});this.FH=function(a,b){var c=this.Ki,e=c.Eb;c.Eb=!1;c.Gf=0;a.v(b,d,c);c.Gf=1;a.v(b,f,c);c.Gf=2;a.v(b,g,c);c.Gf=3;a.v(b,h,c);c.Gf=4;a.v(b,k,c);c.Eb=e;c.Gf=5;a.v(b,l,c)}};b.Qs.prototype=Object.create(b.w.prototype);
b.zh=function(a,e,c,d,f,g,h){b.sc.call(this);this.kd=c;this.left=-a/2;this.right=a/2;this.top=e/2;this.bottom=-e/2;this.Oe=new b.Hh(a/-2,a/2,e/2,e/-2,g,h);this.me=new b.uc(c,a/e,d,f);this.zoom=1;this.co()};b.zh.prototype=Object.create(b.sc.prototype);b.zh.prototype.co=function(){this.Ja=this.me.Ja;this.Ia=this.me.Ia;this.me.kd=this.kd/this.zoom;this.me.og();this.wa=this.me.wa;this.zq=!0;this.Dw=!1};b.zh.prototype.Mz=function(){var a=this.me.Ig,b=(this.me.Ja+this.me.Ia)/2,b=Math.tan(this.kd/2)*b,a=
2*b*a/2,b=b/this.zoom,a=a/this.zoom;this.Oe.left=-a;this.Oe.right=a;this.Oe.top=b;this.Oe.bottom=-b;this.Oe.og();this.Ja=this.Oe.Ja;this.Ia=this.Oe.Ia;this.wa=this.Oe.wa;this.zq=!1;this.Dw=!0};b.zh.prototype.Qn=function(a,b){this.me.Ig=a/b;this.left=-a/2;this.right=a/2;this.top=b/2;this.bottom=-b/2};b.zh.prototype.og=function(){this.zq?this.co():(this.co(),this.Mz())};b.Ms=function(a,e,c,d){b.H.call(this);a=a||50;c=void 0!==c?c:0;d=void 0!==d?d:2*Math.PI;e=void 0!==e?Math.max(3,e):8;var f,g=[],h=
new b.i(0.5,0.5);this.c.push(new b.a);g.push(h);for(f=0;e>=f;f++){var k=new b.a,l=c+f/e*d;k.x=a*Math.cos(l);k.y=a*Math.sin(l);this.c.push(k);g.push(new b.i((k.x/a+1)/2,(k.y/a+1)/2))}c=new b.a(0,0,1);for(f=1;e>=f;f++)this.j.push(new b.S(f,f+1,0,[c,c,c])),this.C[0].push([g[f],g[f+1],h]);this.tb();this.Yb();this.Kb=new b.ee(new b.a,a)};b.Ms.prototype=Object.create(b.H.prototype);b.rl=function(a,e,c,d,f,g){function h(a,c,d,e,f,g,h,u){var s,t=k.pf,A=k.Md,Q=f/2,O=g/2,P=k.c.length;"x"===a&&"y"===c||"y"===
a&&"x"===c?s="z":"x"===a&&"z"===c||"z"===a&&"x"===c?(s="y",A=k.Bm):("z"===a&&"y"===c||"y"===a&&"z"===c)&&(s="x",t=k.Bm);var I=t+1,F=A+1,L=f/t,K=g/A,N=new b.a;N[s]=0<h?1:-1;for(f=0;F>f;f++)for(g=0;I>g;g++){var B=new b.a;B[a]=(g*L-Q)*d;B[c]=(f*K-O)*e;B[s]=h;k.c.push(B)}for(f=0;A>f;f++)for(g=0;t>g;g++)a=new b.qa(g+I*f+P,g+I*(f+1)+P,g+1+I*(f+1)+P,g+1+I*f+P),a.s.copy(N),a.G.push(N.d(),N.d(),N.d(),N.d()),a.Ca=u,k.j.push(a),k.C[0].push([new b.i(g/t,1-f/A),new b.i(g/t,1-(f+1)/A),new b.i((g+1)/t,1-(f+1)/A),
new b.i((g+1)/t,1-f/A)])}b.H.call(this);var k=this;this.width=a;this.height=e;this.depth=c;this.pf=d||1;this.Md=f||1;this.Bm=g||1;a=this.width/2;e=this.height/2;c=this.depth/2;h("z","y",-1,-1,this.depth,this.height,a,0);h("z","y",1,-1,this.depth,this.height,-a,1);h("x","z",1,1,this.width,this.depth,e,2);h("x","z",1,-1,this.width,this.depth,-e,3);h("x","y",1,-1,this.width,this.height,c,4);h("x","y",-1,-1,this.width,this.height,-c,5);this.tb();this.on()};b.rl.prototype=Object.create(b.H.prototype);
b.mj=function(a,e,c,d,f,g){b.H.call(this);this.Ey=a=void 0!==a?a:20;this.Dy=e=void 0!==e?e:20;this.height=c=void 0!==c?c:100;this.Ud=d=d||8;this.Md=f=f||1;this.fy=g=void 0!==g?g:!1;var h,k,l=c/2,m=[],q=[];for(k=0;f>=k;k++){var p=[],r=[],v=k/f,w=v*(e-a)+a;for(h=0;d>=h;h++){var u=h/d,s=new b.a;s.x=w*Math.sin(2*u*Math.PI);s.y=-v*c+l;s.z=w*Math.cos(2*u*Math.PI);this.c.push(s);p.push(this.c.length-1);r.push(new b.i(u,1-v))}m.push(p);q.push(r)}var t,A;c=(e-a)/c;for(h=0;d>h;h++)for(0!==a?(t=this.c[m[0][h]].d(),
A=this.c[m[0][h+1]].d()):(t=this.c[m[1][h]].d(),A=this.c[m[1][h+1]].d()),t.Pi(Math.sqrt(t.x*t.x+t.z*t.z)*c).normalize(),A.Pi(Math.sqrt(A.x*A.x+A.z*A.z)*c).normalize(),k=0;f>k;k++){var p=m[k][h],r=m[k+1][h],v=m[k+1][h+1],w=m[k][h+1],u=t.d(),s=t.d(),Q=A.d(),O=A.d(),P=q[k][h].d(),I=q[k+1][h].d(),F=q[k+1][h+1].d(),L=q[k][h+1].d();this.j.push(new b.qa(p,r,v,w,[u,s,Q,O]));this.C[0].push([P,I,F,L])}if(!1===g&&0<a)for(this.c.push(new b.a(0,l,0)),h=0;d>h;h++)p=m[0][h],r=m[0][h+1],v=this.c.length-1,u=new b.a(0,
1,0),s=new b.a(0,1,0),Q=new b.a(0,1,0),P=q[0][h].d(),I=q[0][h+1].d(),F=new b.i(I.Rz,0),this.j.push(new b.S(p,r,v,[u,s,Q])),this.C[0].push([P,I,F]);if(!1===g&&0<e)for(this.c.push(new b.a(0,-l,0)),h=0;d>h;h++)p=m[k][h+1],r=m[k][h],v=this.c.length-1,u=new b.a(0,-1,0),s=new b.a(0,-1,0),Q=new b.a(0,-1,0),P=q[k][h+1].d(),I=q[k][h].d(),F=new b.i(I.Rz,1),this.j.push(new b.S(p,r,v,[u,s,Q])),this.C[0].push([P,I,F]);this.tb();this.Yb()};b.mj.prototype=Object.create(b.H.prototype);b.Ya=function(a,e){return"undefined"==
typeof a?void 0:(b.H.call(this),a=a instanceof Array?a:[a],this.Xn=a[a.length-1].lk(),this.gm(a,e),this.tb(),this.Yb(),void 0)};b.Ya.prototype=Object.create(b.H.prototype);b.Ya.prototype.gm=function(a,b){for(var c=a.length,d=0;c>d;d++)this.fm(a[d],b)};b.Ya.prototype.fm=function(a,e){function c(a,b,c){return b||console.log("die"),b.d().p(c).add(a)}function d(a,c,d){var e,f,g,h,k;e=b.Ya.Bj;f=b.Ya.Ol;g=b.Ya.Wt;h=b.Ya.Xt;var l=b.Ya.Yt,m=b.Ya.Zt;e.set(a.x-c.x,a.y-c.y);f.set(a.x-d.x,a.y-d.y);e=e.normalize();
f=f.normalize();g.set(-e.y,e.x);h.set(f.y,-f.x);l.copy(a).add(g);m.copy(a).add(h);l.va(m)?a=h.d():(l.copy(c).add(g),m.copy(d).add(h),g=e.za(h),h=m.sub(l).za(h),0===g&&(console.log("Either infinite or no solutions!"),0===h?console.log("Its finite solutions."):console.log("Too bad, no solutions.")),h/=g,0>h?(k=Math.atan2(c.y-a.y,c.x-a.x),a=Math.atan2(d.y-a.y,d.x-a.x),k>a&&(a+=2*Math.PI),a=(k+a)/2,a=new b.i(-Math.cos(a),-Math.sin(a))):a=(k=e.p(h).add(l),k.sub(a).d()));return a}function f(c,d){var f,
g;for(G=c.length;0<=--G;){f=G;g=G-1;0>g&&(g=c.length-1);for(var h=0,k=w+2*p,h=0;k>h;h++){var l=ma*h,m=ma*(h+1),y=d+f+l,l=d+g+l,q=d+g+m,m=d+f+m,r=c,D=h,u=k,s=f,t=g,y=y+W,l=l+W,q=q+W,m=m+W;B.j.push(new b.qa(y,l,q,m,null,null,A));B.C[0].push(Q.fw(B,a,r,e,y,l,q,m,D,u,s,t))}}}function g(a,c,d){B.c.push(new b.a(a,c,d))}function h(c,d,f,g){c+=W;d+=W;f+=W;B.j.push(new b.S(c,d,f,null,null,t));B.C[0].push(g?Q.lq(B,a,e,c,d,f):Q.mq(B,a,e,c,d,f))}var k,l=void 0!==e.Fp?e.Fp:100,m=void 0!==e.mm?e.mm:6,q=void 0!==
e.lm?e.lm:m-2,p=void 0!==e.cv?e.cv:3,r=void 0!==e.km?e.km:!0,v=void 0!==e.di?e.di:12,w=void 0!==e.Dz?e.Dz:1,u=e.GC,s=!1,t=e.n,A=e.FC,Q=void 0!==e.Kl?e.Kl:b.Ya.dp;this.Xn;var O,P,I,F;u&&(k=u.pk(w),s=!0,r=!1,O=void 0!==e.frames?e.frames:new b.xj.wo(u,w,!1),P=new b.a,I=new b.a,F=new b.a);r||(p=0,m=0,q=0);var L,K,N,B=this,W=this.c.length,u=a.dq(v),v=u.shape,M=u.Nd;if(u=!b.aa.W.Rf(v)){v=v.reverse();K=0;for(N=M.length;N>K;K++)L=M[K],b.aa.W.Rf(L)&&(M[K]=L.reverse());u=!1}var J=b.aa.W.os(v,M),R=v;K=0;for(N=
M.length;N>K;K++)L=M[K],v=v.concat(L);var U,Y,C,y,D,Z,ma=v.length,S=J.length;R.length;180/Math.PI;var u=[],G=0;C=R.length;U=C-1;for(Y=G+1;C>G;G++,U++,Y++)U===C&&(U=0),Y===C&&(Y=0),R[G],R[U],R[Y],u[G]=d(R[G],R[U],R[Y]);var na,Ba=[],wa=u.concat();K=0;for(N=M.length;N>K;K++){L=M[K];na=[];G=0;C=L.length;U=C-1;for(Y=G+1;C>G;G++,U++,Y++)U===C&&(U=0),Y===C&&(Y=0),na[G]=d(L[G],L[U],L[Y]);Ba.push(na);wa=wa.concat(na)}for(U=0;p>U;U++){C=U/p;y=m*(1-C);Y=q*Math.sin(C*Math.PI/2);G=0;for(C=R.length;C>G;G++)D=c(R[G],
u[G],Y),g(D.x,D.y,-y);K=0;for(N=M.length;N>K;K++)for(L=M[K],na=Ba[K],G=0,C=L.length;C>G;G++)D=c(L[G],na[G],Y),g(D.x,D.y,-y)}Y=q;for(G=0;ma>G;G++)D=r?c(v[G],wa[G],Y):v[G],s?(I.copy(O.Xf[0]).p(D.x),P.copy(O.Uj[0]).p(D.y),F.copy(k[0]).add(I).add(P),g(F.x,F.y,F.z)):g(D.x,D.y,0);for(C=1;w>=C;C++)for(G=0;ma>G;G++)D=r?c(v[G],wa[G],Y):v[G],s?(I.copy(O.Xf[C]).p(D.x),P.copy(O.Uj[C]).p(D.y),F.copy(k[C]).add(I).add(P),g(F.x,F.y,F.z)):g(D.x,D.y,l/w*C);for(U=p-1;0<=U;U--){C=U/p;y=m*(1-C);Y=q*Math.sin(C*Math.PI/
2);G=0;for(C=R.length;C>G;G++)D=c(R[G],u[G],Y),g(D.x,D.y,l+y);K=0;for(N=M.length;N>K;K++)for(L=M[K],na=Ba[K],G=0,C=L.length;C>G;G++)D=c(L[G],na[G],Y),s?g(D.x,D.y+k[w-1].y,k[w-1].x+y):g(D.x,D.y,l+y)}(function(){if(r){var a;a=0*ma;for(G=0;S>G;G++)Z=J[G],h(Z[2]+a,Z[1]+a,Z[0]+a,!0);a=w+2*p;a*=ma;for(G=0;S>G;G++)Z=J[G],h(Z[0]+a,Z[1]+a,Z[2]+a,!1)}else{for(G=0;S>G;G++)Z=J[G],h(Z[2],Z[1],Z[0],!0);for(G=0;S>G;G++)Z=J[G],h(Z[0]+ma*w,Z[1]+ma*w,Z[2]+ma*w,!1)}})();(function(){var a=0;f(R,a);a+=R.length;K=0;for(N=
M.length;N>K;K++)L=M[K],f(L,a),a+=L.length})()};b.Ya.dp={mq:function(a,e,c,d,f,g){return[new b.i(a.c[d].x,a.c[d].y),new b.i(a.c[f].x,a.c[f].y),new b.i(a.c[g].x,a.c[g].y)]},lq:function(a,b,c,d,f,g){return this.mq(a,b,c,d,f,g)},fw:function(a,e,c,d,f,g,h,k){e=a.c[f].x;c=a.c[f].y;f=a.c[f].z;d=a.c[g].x;var l=a.c[g].y;g=a.c[g].z;var m=a.c[h].x,q=a.c[h].y;h=a.c[h].z;var p=a.c[k].x,r=a.c[k].y;a=a.c[k].z;return 0.01>Math.abs(c-l)?[new b.i(e,1-f),new b.i(d,1-g),new b.i(m,1-h),new b.i(p,1-a)]:[new b.i(c,1-f),
new b.i(l,1-g),new b.i(q,1-h),new b.i(r,1-a)]}};b.Ya.Bj=new b.i;b.Ya.Ol=new b.i;b.Ya.Wt=new b.i;b.Ya.Xt=new b.i;b.Ya.Yt=new b.i;b.Ya.Zt=new b.i;b.Il=function(a,e){b.H.call(this);!1==a instanceof Array&&(a=[a]);this.Xn=a[a.length-1].lk();this.gm(a,e);this.tb();this.Yb()};b.Il.prototype=Object.create(b.H.prototype);b.Il.prototype.gm=function(a,b){for(var c=0,d=a.length;d>c;c++)this.fm(a[c],b);return this};b.Il.prototype.fm=function(a,e){void 0===e&&(e={});var c=void 0!==e.di?e.di:12,d=e.n,f=void 0===
e.Kl?b.Ya.dp:e.Kl;this.Xn;var g,h,k=this.c.length,c=a.dq(c),l=c.shape,m=c.Nd;if(!b.aa.W.Rf(l))for(l=l.reverse(),c=0,g=m.length;g>c;c++)h=m[c],b.aa.W.Rf(h)&&(m[c]=h.reverse());var q=b.aa.W.os(l,m),p=l,c=0;for(g=m.length;g>c;c++)h=m[c],l=l.concat(h);h=l.length;g=q.length;p.length;for(c=0;h>c;c++)p=l[c],this.c.push(new b.a(p.x,p.y,0));for(c=0;g>c;c++)h=q[c],l=h[0]+k,p=h[1]+k,h=h[2]+k,this.j.push(new b.S(l,p,h,null,null,d)),this.C[0].push(f.lq(this,a,e,l,p,h))};b.ct=function(a,e,c,d){b.H.call(this);e=
e||12;c=c||0;d=d||2*Math.PI;for(var f=1/(a.length-1),g=1/e,h=0,k=e;k>=h;h++)for(var l=c+h*g*d,m=Math.cos(l),q=Math.sin(l),l=0,p=a.length;p>l;l++){var r=a[l],v=new b.a;v.x=m*r.x-q*r.y;v.y=q*r.x+m*r.y;v.z=r.z;this.c.push(v)}c=a.length;h=0;for(k=e;k>h;h++)for(l=0,p=a.length-1;p>l;l++)d=e=l+c*h,q=e+c,m=e+1+c,this.j.push(new b.qa(d,q,m,e+1)),m=h*g,e=l*f,d=m+g,q=e+f,this.C[0].push([new b.i(m,e),new b.i(d,e),new b.i(d,q),new b.i(m,q)]);this.on();this.tb();this.Yb();this.ne()};b.ct.prototype=Object.create(b.H.prototype);
b.Cl=function(a,e,c,d){b.H.call(this);this.width=a;this.height=e;this.pf=c||1;this.Md=d||1;c=a/2;var f=e/2;d=this.pf;var g=this.Md,h=d+1,k=g+1,l=this.width/d,m=this.height/g,q=new b.a(0,0,1);for(a=0;k>a;a++)for(e=0;h>e;e++)this.c.push(new b.a(e*l-c,-(a*m-f),0));for(a=0;g>a;a++)for(e=0;d>e;e++)c=new b.qa(e+h*a,e+h*(a+1),e+1+h*(a+1),e+1+h*a),c.s.copy(q),c.G.push(q.d(),q.d(),q.d(),q.d()),this.j.push(c),this.C[0].push([new b.i(e/d,1-a/g),new b.i(e/d,1-(a+1)/g),new b.i((e+1)/d,1-(a+1)/g),new b.i((e+1)/
d,1-a/g)]);this.tb()};b.Cl.prototype=Object.create(b.H.prototype);b.vt=function(a,e,c,d,f,g){b.H.call(this);a=a||0;e=e||50;f=void 0!==f?f:0;g=void 0!==g?g:2*Math.PI;c=void 0!==c?Math.max(3,c):8;d=void 0!==d?Math.max(3,d):8;var h=[],k=a,l=(e-a)/d;for(a=0;d>=a;a++){for(e=0;c>=e;e++){var m=new b.a,q=f+e/c*g;m.x=k*Math.cos(q);m.y=k*Math.sin(q);this.c.push(m);h.push(new b.i((m.x/k+1)/2,-(m.y/k+1)/2+1))}k+=l}f=new b.a(0,0,1);for(a=0;d>a;a++)for(g=a*c,e=0;c>=e;e++){var q=e+g,l=q+a,m=q+c+a,p=q+c+1+a;this.j.push(new b.S(l,
m,p,[f,f,f]));this.C[0].push([h[l],h[m],h[p]]);l=q+a;m=q+c+1+a;p=q+1+a;this.j.push(new b.S(l,m,p,[f,f,f]));this.C[0].push([h[l],h[m],h[p]])}this.tb();this.Yb();this.Kb=new b.ee(new b.a,k)};b.vt.prototype=Object.create(b.H.prototype);b.Qc=function(a,e,c,d,f,g,h){b.H.call(this);this.Q=a=a||50;this.pf=e=Math.max(3,Math.floor(e)||8);this.Md=c=Math.max(2,Math.floor(c)||6);this.OF=d=void 0!==d?d:0;this.NF=f=void 0!==f?f:2*Math.PI;this.oH=g=void 0!==g?g:0;this.nH=h=void 0!==h?h:Math.PI;var k,l,m=[],q=[];
for(l=0;c>=l;l++){var p=[],r=[];for(k=0;e>=k;k++){var v=k/e,w=l/c,u=new b.a;u.x=-a*Math.cos(d+v*f)*Math.sin(g+w*h);u.y=a*Math.cos(g+w*h);u.z=a*Math.sin(d+v*f)*Math.sin(g+w*h);this.c.push(u);p.push(this.c.length-1);r.push(new b.i(v,1-w))}m.push(p);q.push(r)}for(l=0;l<this.Md;l++)for(k=0;k<this.pf;k++){e=m[l][k+1];c=m[l][k];d=m[l+1][k];f=m[l+1][k+1];g=this.c[e].d().normalize();h=this.c[c].d().normalize();var p=this.c[d].d().normalize(),r=this.c[f].d().normalize(),v=q[l][k+1].d(),w=q[l][k].d(),u=q[l+
1][k].d(),s=q[l+1][k+1].d();Math.abs(this.c[e].y)===this.Q?(this.j.push(new b.S(e,d,f,[g,p,r])),this.C[0].push([v,u,s])):Math.abs(this.c[d].y)===this.Q?(this.j.push(new b.S(e,c,d,[g,h,p])),this.C[0].push([v,w,u])):(this.j.push(new b.qa(e,c,d,f,[g,h,p,r])),this.C[0].push([v,w,u,s]))}this.tb();this.Yb();this.Kb=new b.ee(new b.a,a)};b.Qc.prototype=Object.create(b.H.prototype);b.Et=function(a,e){e=e||{};var c=b.zb.ew(a,e);e.Fp=void 0!==e.height?e.height:50;void 0===e.mm&&(e.mm=10);void 0===e.lm&&(e.lm=
8);void 0===e.km&&(e.km=!1);b.Ya.call(this,c,e)};b.Et.prototype=Object.create(b.Ya.prototype);b.bp=function(a,e,c,d,f){b.H.call(this);this.Q=a||100;this.ng=e||40;this.lc=c||8;this.xb=d||6;this.arc=f||2*Math.PI;f=new b.a;a=[];e=[];for(c=0;c<=this.lc;c++)for(d=0;d<=this.xb;d++){var g=d/this.xb*this.arc,h=2*c/this.lc*Math.PI;f.x=this.Q*Math.cos(g);f.y=this.Q*Math.sin(g);var k=new b.a;k.x=(this.Q+this.ng*Math.cos(h))*Math.cos(g);k.y=(this.Q+this.ng*Math.cos(h))*Math.sin(g);k.z=this.ng*Math.sin(h);this.c.push(k);
a.push(new b.i(d/this.xb,c/this.lc));e.push(k.d().sub(f).normalize())}for(c=1;c<=this.lc;c++)for(d=1;d<=this.xb;d++){f=(this.xb+1)*c+d-1;var g=(this.xb+1)*(c-1)+d-1,h=(this.xb+1)*(c-1)+d,k=(this.xb+1)*c+d,l=new b.qa(f,g,h,k,[e[f],e[g],e[h],e[k]]);l.s.add(e[f]);l.s.add(e[g]);l.s.add(e[h]);l.s.add(e[k]);l.s.normalize();this.j.push(l);this.C[0].push([a[f].d(),a[g].d(),a[h].d(),a[k].d()])}this.tb()};b.bp.prototype=Object.create(b.H.prototype);b.Gt=function(a,e,c,d,f,g,h){function k(a,c,d,e,f){c=c/d*a;
d=Math.cos(c);return new b.a(0.5*e*(2+d)*Math.cos(a),0.5*e*(2+d)*Math.sin(a),0.5*f*e*Math.sin(c))}b.H.call(this);this.Q=a||100;this.ng=e||40;this.lc=c||64;this.xb=d||8;this.mh=f||2;this.pr=g||3;this.yq=h||1;this.Hc=Array(this.lc);c=new b.a;d=new b.a;f=new b.a;for(a=0;a<this.lc;++a)for(this.Hc[a]=Array(this.xb),e=0;e<this.xb;++e){var l;l=2*(a/this.lc)*this.mh*Math.PI;h=2*(e/this.xb)*Math.PI;g=k(l,this.pr,this.mh,this.Q,this.yq);l=k(l+0.01,this.pr,this.mh,this.Q,this.yq);c.X(l,g);d.fd(l,g);f.$b(c,d);
d.$b(f,c);f.normalize();d.normalize();l=-this.ng*Math.cos(h);h=this.ng*Math.sin(h);g.x+=l*d.x+h*f.x;g.y+=l*d.y+h*f.y;g.z+=l*d.z+h*f.z;this.Hc[a][e]=this.c.push(new b.a(g.x,g.y,g.z))-1}for(a=0;a<this.lc;++a)for(e=0;e<this.xb;++e)c=(a+1)%this.lc,d=(e+1)%this.xb,f=new b.i(a/this.lc,e/this.xb),g=new b.i((a+1)/this.lc,e/this.xb),h=new b.i((a+1)/this.lc,(e+1)/this.xb),l=new b.i(a/this.lc,(e+1)/this.xb),this.j.push(new b.qa(this.Hc[a][e],this.Hc[c][e],this.Hc[c][d],this.Hc[a][d])),this.C[0].push([f,g,h,
l]);this.tb();this.Yb();this.ne()};b.Gt.prototype=Object.create(b.H.prototype);b.xj=function(a,e,c,d,f,g){b.H.call(this);this.path=a;this.hf=e||64;this.Q=c||1;this.Ud=d||8;this.closed=f||!1;g&&(this.debug=new b.w);this.Hc=[];var h,k,l,m,q,p,r,v;f=this.hf+1;g=new b.a;e=new b.xj.wo(this.path,this.hf,this.closed);p=e.gs;r=e.Xf;v=e.Uj;this.gs=p;this.Xf=r;this.Uj=v;for(e=0;f>e;e++)for(this.Hc[e]=[],d=e/(f-1),q=a.pi(d),d=p[e],h=r[e],k=v[e],this.debug&&(this.debug.add(new b.tg(d,q,c,255)),this.debug.add(new b.tg(h,
q,c,16711680)),this.debug.add(new b.tg(k,q,c,65280))),d=0;d<this.Ud;d++)l=2*(d/this.Ud)*Math.PI,m=-this.Q*Math.cos(l),l=this.Q*Math.sin(l),g.copy(q),g.x+=m*h.x+l*k.x,g.y+=m*h.y+l*k.y,g.z+=m*h.z+l*k.z,this.Hc[e][d]=this.c.push(new b.a(g.x,g.y,g.z))-1;for(e=0;e<this.hf;e++)for(d=0;d<this.Ud;d++)f=this.closed?(e+1)%this.hf:e+1,g=(d+1)%this.Ud,a=this.Hc[e][d],c=this.Hc[f][d],f=this.Hc[f][g],g=this.Hc[e][g],p=new b.i(e/this.hf,d/this.Ud),r=new b.i((e+1)/this.hf,d/this.Ud),v=new b.i((e+1)/this.hf,(d+1)/
this.Ud),h=new b.i(e/this.hf,(d+1)/this.Ud),this.j.push(new b.qa(a,c,f,g)),this.C[0].push([p,r,v,h]);this.tb();this.Yb();this.ne()};b.xj.prototype=Object.create(b.H.prototype);b.xj.wo=function(a,e,c){var d,f,g,h,k=new b.a,l=[],m=[],q=[],p=new b.a,r=new b.K;e+=1;this.gs=l;this.Xf=m;this.Uj=q;for(f=0;e>f;f++)g=f/(e-1),l[f]=a.pw(g),l[f].normalize();m[0]=new b.a;q[0]=new b.a;a=Number.MAX_VALUE;f=Math.abs(l[0].x);g=Math.abs(l[0].y);h=Math.abs(l[0].z);a>=f&&(a=f,k.set(1,0,0));a>=g&&(a=g,k.set(0,1,0));a>=
h&&k.set(0,0,1);p.$b(l[0],k).normalize();m[0].$b(l[0],p);q[0].$b(l[0],m[0]);for(f=1;e>f;f++)m[f]=m[f-1].d(),q[f]=q[f-1].d(),p.$b(l[f-1],l[f]),1E-4<p.length()&&(p.normalize(),d=Math.acos(l[f-1].za(l[f])),m[f].Z(r.hn(p,d))),q[f].$b(l[f],m[f]);if(c)for(d=Math.acos(m[0].za(m[e-1])),d/=e-1,0<l[0].za(p.$b(m[0],m[e-1]))&&(d=-d),f=1;e>f;f++)m[f].Z(r.hn(l[f],d*f)),q[f].$b(l[f],m[f])};b.tj=function(a,e,c,d){function f(a){var c=a.normalize().d();c.index=l.c.push(c)-1;return c.Pb=new b.i(Math.atan2(a.z,-a.x)/
2/Math.PI+0.5,1-(Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))/Math.PI+0.5)),c}function g(a,c,d){var e=new b.S(a.index,c.index,d.index,[a.d(),c.d(),d.d()]);e.ya.add(a).add(c).add(d).oe(3);e.s.copy(e.ya).normalize();l.j.push(e);e=Math.atan2(e.ya.z,-e.ya.x);l.C[0].push([k(a.Pb,a,e),k(c.Pb,c,e),k(d.Pb,d,e)])}function h(a,b){for(var c=Math.pow(2,b),d=f(l.c[a.r]),e=f(l.c[a.h]),h=f(l.c[a.t]),k=[],m=0;c>=m;m++){k[m]=[];for(var p=f(d.d().$e(h,m/c)),q=f(e.d().$e(h,m/c)),r=c-m,v=0;r>=v;v++)k[m][v]=0==v&&m==c?
p:f(p.d().$e(q,v/r))}for(m=0;c>m;m++)for(v=0;2*(c-m)-1>v;v++)d=Math.floor(v/2),0==v%2?g(k[m][d+1],k[m+1][d],k[m][d]):g(k[m][d+1],k[m+1][d+1],k[m+1][d])}function k(a,c,d){return 0>d&&1===a.x&&(a=new b.i(a.x-1,a.y)),0===c.x&&0===c.z&&(a=new b.i(d/2/Math.PI+0.5,a.y)),a.d()}b.H.call(this);c=c||1;d=d||0;for(var l=this,m=0,q=a.length;q>m;m++)f(new b.a(a[m][0],a[m][1],a[m][2]));a=this.c;for(var p=[],m=0,q=e.length;q>m;m++){var r=a[e[m][0]],v=a[e[m][1]],w=a[e[m][2]];p[m]=new b.S(r.index,v.index,w.index,[r.d(),
v.d(),w.d()])}m=0;for(q=p.length;q>m;m++)h(p[m],d);m=0;for(q=this.C[0].length;q>m;m++)e=this.C[0][m],d=e[0].x,a=e[1].x,p=e[2].x,r=Math.max(d,Math.max(a,p)),v=Math.min(d,Math.min(a,p)),0.9<r&&0.1>v&&(0.2>d&&(e[0].x+=1),0.2>a&&(e[1].x+=1),0.2>p&&(e[2].x+=1));this.on();m=0;for(q=this.c.length;q>m;m++)this.c[m].p(c);this.tb();this.Kb=new b.ee(new b.a,c)};b.tj.prototype=Object.create(b.H.prototype);b.Ao=function(a,e){this.Q=a;this.detail=e;var c=(1+Math.sqrt(5))/2;b.tj.call(this,[[-1,c,0],[1,c,0],[-1,
-c,0],[1,-c,0],[0,-1,c],[0,1,c],[0,-1,-c],[0,1,-c],[c,0,-1],[c,0,1],[-c,0,-1],[-c,0,1]],[[0,11,5],[0,5,1],[0,1,7],[0,7,10],[0,10,11],[1,5,9],[5,11,4],[11,10,2],[10,7,6],[7,1,8],[3,9,4],[3,4,2],[3,2,6],[3,6,8],[3,8,9],[4,9,5],[2,4,11],[6,2,10],[8,6,7],[9,8,1]],a,e)};b.Ao.prototype=Object.create(b.H.prototype);b.lt=function(a,e){b.tj.call(this,[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],[[0,2,4],[0,4,3],[0,3,5],[0,5,2],[1,2,5],[1,5,3],[1,3,4],[1,4,2]],a,e)};b.lt.prototype=Object.create(b.H.prototype);
b.Dt=function(a,e){b.tj.call(this,[[1,1,1],[-1,-1,1],[-1,1,-1],[1,-1,-1]],[[2,1,0],[0,3,2],[1,3,0],[2,3,1]],a,e)};b.Dt.prototype=Object.create(b.H.prototype);b.rt=function(a,e,c,d){b.H.call(this);var f=this.c,g=this.j,h=this.C[0];d=void 0===d?!1:d;var k,l,m,q,p=e+1;for(k=0;c>=k;k++)for(q=k/c,l=0;e>=l;l++)m=l/e,m=a(m,q),f.push(m);var r,v,w,u;for(k=0;c>k;k++)for(l=0;e>l;l++)a=k*p+l,f=k*p+l+1,q=(k+1)*p+l,m=(k+1)*p+l+1,r=new b.i(l/e,k/c),v=new b.i((l+1)/e,k/c),w=new b.i(l/e,(k+1)/c),u=new b.i((l+1)/e,
(k+1)/c),d?(g.push(new b.S(a,f,q)),g.push(new b.S(f,m,q)),h.push([r,v,w]),h.push([v,u,w])):(g.push(new b.qa(a,f,m,q)),h.push([r,v,u,w]));this.tb();this.Yb();this.ne()};b.rt.prototype=Object.create(b.H.prototype);b.Ps=function(a){function e(c){var e=a[c].d(),f=e.length();e.x+=f*2E-6*(Math.random()-0.5);e.y+=f*2E-6*(Math.random()-0.5);e.z+=f*2E-6*(Math.random()-0.5);for(var f=[],g=0;g<d.length;){var h=d[g],k=e,l=a[h[0]],s;s=l;var t=a[h[1]],A=new b.a,Q=new b.a;s=(A.X(a[h[2]],t),Q.X(s,t),A.Id(Q),A.normalize(),
A);if(s.za(k)>=s.za(l)){for(k=0;3>k;k++){l=[h[k],h[(k+1)%3]];s=!0;for(t=0;t<f.length;t++)if(f[t][0]===l[1]&&f[t][1]===l[0]){f[t]=f[f.length-1];f.pop();s=!1;break}s&&f.push(l)}d[g]=d[d.length-1];d.pop()}else g++}for(t=0;t<f.length;t++)d.push([f[t][0],f[t][1],c])}function c(a){var c=a.length();return new b.i(a.x/c,a.y/c)}b.H.call(this);for(var d=[[0,1,2],[0,2,1]],f=3;f<a.length;f++)e(f);for(var g=0,h=Array(a.length),f=0;f<d.length;f++)for(var k=d[f],l=0;3>l;l++)void 0===h[k[l]]&&(h[k[l]]=g++,this.c.push(a[k[l]])),
k[l]=h[k[l]];for(f=0;f<d.length;f++)this.j.push(new b.S(d[f][0],d[f][1],d[f][2]));for(f=0;f<this.j.length;f++)k=this.j[f],this.C[0].push([c(this.c[k.r]),c(this.c[k.h]),c(this.c[k.t])]);this.tb();this.Yb();this.ne()};b.Ps.prototype=Object.create(b.H.prototype);b.Js=function(a){a=a||1;var e=new b.H;e.c.push(new b.a,new b.a(a,0,0),new b.a,new b.a(0,a,0),new b.a,new b.a(0,0,a));e.Oa.push(new b.k(16711680),new b.k(16755200),new b.k(65280),new b.k(11206400),new b.k(255),new b.k(43775));a=new b.Pc({m:b.Fe});
b.Na.call(this,e,a,b.Dh)};b.Js.prototype=Object.create(b.Na.prototype);b.tg=function(a,e,c,d){b.w.call(this);void 0===d&&(d=16776960);void 0===c&&(c=1);this.position=e;this.jb=!0;e=new b.H;e.c.push(new b.a(0,0,0));e.c.push(new b.a(0,1,0));this.Jq=new b.Na(e,new b.Pc({color:d}));this.Jq.Va=!1;this.add(this.Jq);e=new b.mj(0,0.05,0.25,5,1);e.ke((new b.K).Ck(0,0.875,0));this.Qp=new b.J(e,new b.Za({color:d}));this.Qp.Va=!1;this.add(this.Qp);this.Xy(a);this.Qk(c)};b.tg.prototype=Object.create(b.w.prototype);
b.tg.prototype.Xy=function(){var a,e=new b.a;return function(b){0.999<b.y?this.fa.set(0,0,0,1):-0.999>b.y?this.fa.set(1,0,0,0):(e.set(b.z,0,-b.x).normalize(),a=Math.acos(b.y),this.fa.Er(e,a))}}();b.tg.prototype.Qk=function(a){this.scale.set(a,a,a)};b.ro=function(a){a=a||1;var e=new b.H;a=[new b.a(a,a,a),new b.a(-a,a,a),new b.a(-a,-a,a),new b.a(a,-a,a),new b.a(a,a,-a),new b.a(-a,a,-a),new b.a(-a,-a,-a),new b.a(a,-a,-a)];e.c.push(a[0],a[1],a[1],a[2],a[2],a[3],a[3],a[0],a[4],a[5],a[5],a[6],a[6],a[7],
a[7],a[4],a[0],a[4],a[1],a[5],a[2],a[6],a[3],a[7]);this.c=a;b.Na.call(this,e,new b.Pc,b.Dh)};b.ro.prototype=Object.create(b.Na.prototype);b.ro.prototype.update=function(a){var b=a.l;null===b.Fc&&b.Zh();var c=b.Fc.min,b=b.Fc.max,d=this.c;d[0].set(b.x,b.y,b.z);d[1].set(c.x,b.y,b.z);d[2].set(c.x,c.y,b.z);d[3].set(b.x,c.y,b.z);d[4].set(b.x,b.y,c.z);d[5].set(c.x,b.y,c.z);d[6].set(c.x,c.y,c.z);d[7].set(b.x,c.y,c.z);this.l.$h();this.l.Xa=!0;this.Va=!1;this.A=a.A};b.pl=function(a){function e(a,b,d){c(a,d);
c(b,d)}function c(a,c){d.c.push(new b.a);d.Oa.push(new b.k(c));void 0===g[a]&&(g[a]=[]);g[a].push(d.c.length-1)}b.Na.call(this);var d=new b.H,f=new b.Pc({color:16777215,m:b.vf}),g={};e("n1","n2",16755200);e("n2","n4",16755200);e("n4","n3",16755200);e("n3","n1",16755200);e("f1","f2",16755200);e("f2","f4",16755200);e("f4","f3",16755200);e("f3","f1",16755200);e("n1","f1",16755200);e("n2","f2",16755200);e("n3","f3",16755200);e("n4","f4",16755200);e("p","n1",16711680);e("p","n2",16711680);e("p","n3",16711680);
e("p","n4",16711680);e("u1","u2",43775);e("u2","u3",43775);e("u3","u1",43775);e("c","t",16777215);e("p","c",3355443);e("cn1","cn2",3355443);e("cn3","cn4",3355443);e("cf1","cf2",3355443);e("cf3","cf4",3355443);b.Na.call(this,d,f,b.Dh);this.Cb=a;this.A=a.A;this.Va=!1;this.uy=g;this.update()};b.pl.prototype=Object.create(b.Na.prototype);b.pl.prototype.update=function(){var a=new b.a,e=new b.sc,c=new b.Dl;return function(){function b(d,h,k,l){a.set(h,k,l);c.il(a,e);d=f.uy[d];if(void 0!==d)for(h=0,k=d.length;k>
h;h++)f.l.c[d[h]].copy(a)}var f=this;e.wa.copy(this.Cb.wa);b("c",0,0,-1);b("t",0,0,1);b("n1",-1,-1,-1);b("n2",1,-1,-1);b("n3",-1,1,-1);b("n4",1,1,-1);b("f1",-1,-1,1);b("f2",1,-1,1);b("f3",-1,1,1);b("f4",1,1,1);b("u1",0.7,1.1,-1);b("u2",-0.7,1.1,-1);b("u3",0,2,-1);b("cf1",-1,0,1);b("cf2",1,0,1);b("cf3",0,-1,1);b("cf4",0,1,1);b("cn1",-1,0,-1);b("cn2",1,0,-1);b("cn3",0,-1,-1);b("cn4",0,1,-1);this.l.Xa=!0}}();b.to=function(a,e){b.w.call(this);this.Va=!1;this.V=a;var c=new b.Qc(e,4,2),d=new b.Za({D:!1,
I:!0});d.color.copy(this.V.color).p(this.V.ia);this.Ua=new b.J(c,d);this.Ua.A=this.V.A;this.Ua.Va=!1;this.add(this.Ua);c=new b.H;c.c.push(this.V.position);c.c.push(this.V.target.position);c.Pp();d=new b.zf({Qe:4,ni:4,opacity:0.75,U:!0,D:!1});d.color.copy(this.V.color).p(this.V.ia);this.el=new b.Na(c,d);this.add(this.el)};b.to.prototype=Object.create(b.w.prototype);b.to.prototype.update=function(){this.Ua.n.color.copy(this.V.color).p(this.V.ia);this.el.l.Pp();this.el.l.Xa=!0;this.el.n.color.copy(this.V.color).p(this.V.ia)};
b.$s=function(a,e){for(var c=new b.H,d=new b.Pc({m:b.Fe}),f=new b.k(4473924),g=new b.k(8947848),h=-a;a>=h;h+=e){c.c.push(new b.a(-a,0,h));c.c.push(new b.a(a,0,h));c.c.push(new b.a(h,0,-a));c.c.push(new b.a(h,0,a));var k=0===h?f:g;c.Oa.push(k,k,k,k)}b.Na.call(this,c,d,b.Dh)};b.$s.prototype=Object.create(b.Na.prototype);b.zo=function(a,e){b.w.call(this);this.V=a;var c=new b.Qc(e,4,2);c.ke((new b.K).Qq(-Math.PI/2));for(var d=0;8>d;d++)c.j[d].Ca=4>d?0:1;d=new b.Za({D:!1,I:!0});d.color.copy(a.color).p(a.ia);
var f=new b.Za({D:!1,I:!0});f.color.copy(a.qi).p(a.ia);this.Ua=new b.J(c,new b.gc([d,f]));this.Ua.position=a.position;this.Ua.ub(new b.a);this.add(this.Ua)};b.zo.prototype=Object.create(b.w.prototype);b.zo.prototype.update=function(){this.Ua.ub(new b.a);this.Ua.n.ja[0].color.copy(this.V.color).p(this.V.ia);this.Ua.n.ja[1].color.copy(this.V.qi).p(this.V.ia)};b.Lo=function(a,e){b.w.call(this);this.Va=!1;this.V=a;var c=new b.Qc(e,4,2),d=new b.Za({D:!1,I:!0});d.color.copy(this.V.color).p(this.V.ia);this.Ua=
new b.J(c,d);this.Ua.A=this.V.A;this.Ua.Va=!1;this.add(this.Ua)};b.Lo.prototype=Object.create(b.w.prototype);b.Lo.prototype.update=function(){this.Ua.n.color.copy(this.V.color).p(this.V.ia)};b.Yo=function(a,e){b.w.call(this);this.Va=!1;this.V=a;var c=new b.Qc(e,4,2),d=new b.Za({D:!1,I:!0});d.color.copy(this.V.color).p(this.V.ia);this.Ua=new b.J(c,d);this.Ua.A=this.V.A;this.Ua.Va=!1;this.add(this.Ua);c=new b.mj(1E-4,1,1,8,1,!0);c.ke((new b.K).Ck(0,-0.5,0));c.ke((new b.K).Qq(-Math.PI/2));d=new b.Za({D:!1,
I:!0,opacity:0.3,U:!0});d.color.copy(this.V.color).p(this.V.ia);this.Sf=new b.J(c,d);this.Sf.position=this.V.position;c=a.ha?a.ha:1E4;d=c*Math.tan(a.je);this.Sf.scale.set(d,d,c);this.Sf.ub(this.V.target.position);this.add(this.Sf)};b.Yo.prototype=Object.create(b.w.prototype);b.Yo.prototype.update=function(){var a=this.V.ha?this.V.ha:1E4,b=a*Math.tan(this.V.je);this.Sf.scale.set(b,b,a);this.Sf.ub(this.V.target.position);this.Ua.n.color.copy(this.V.color).p(this.V.ia);this.Sf.n.color.copy(this.V.color).p(this.V.ia)};
b.ul=function(){b.w.call(this);this.v=Ia()};b.ul.prototype=Object.create(b.w.prototype);b.wg=function(a,e,c,d,f){b.w.call(this);this.Qd=[];this.e=new b.a;this.vm=void 0;void 0!==a&&this.add(a,e,c,d,f)};b.wg.prototype=Object.create(b.w.prototype);b.wg.prototype.add=function(a,e,c,d,f,g){void 0===e&&(e=-1);void 0===c&&(c=0);void 0===g&&(g=1);void 0===f&&(f=new b.k(16777215));void 0===d&&(d=b.Gh);c=Math.min(c,Math.max(0,c));this.Qd.push({La:a,size:e,ha:c,x:0,y:0,z:0,scale:1,rotation:1,opacity:g,color:f,
Ha:d})};b.wg.prototype.Vz=function(){var a,b,c=this.Qd.length,d=2*-this.e.x,f=2*-this.e.y;for(a=0;c>a;a++)b=this.Qd[a],b.x=this.e.x+d*b.ha,b.y=this.e.y+f*b.ha,b.$z=0.25*b.x*Math.PI,b.rotation+=0.25*(b.$z-b.rotation)};b.qj=function(a,e){b.J.call(this,a,e);this.Hp={};this.im=[];var c=this.l.B.length;this.tv(c-1,c/1);this.Vy()};b.qj.prototype=Object.create(b.J.prototype);b.qj.prototype.tv=function(a,b){var c={Az:0,CC:a,length:a-0+1,Zg:b,duration:(a-0)/b,an:0,ci:0,Au:!1,time:0,direction:1,xe:1,Sg:!1,
bf:!1};this.Hp.__default=c;this.im.push(c)};b.qj.prototype.Vy=function(){var a=this.Hp.__default;a&&(a.xe=1)};b.qj.prototype.update=function(a){for(var e=0,c=this.im.length;c>e;e++){var d=this.im[e];if(d.Au){var f=d.duration/d.length;d.time+=d.direction*a;d.bf?(d.time>d.duration||0>d.time)&&(d.direction*=-1,d.time>d.duration&&(d.time=d.duration,d.Sg=!0),0>d.time&&(d.time=0,d.Sg=!1)):(d.time%=d.duration,0>d.time&&(d.time+=d.duration));var g=d.Az+b.be.Ng(Math.floor(d.time/f),0,d.length-1),h=d.xe;g!==
d.ci&&(this.md[d.an]=0,this.md[d.ci]=1*h,this.md[g]=0,d.an=d.ci,d.ci=g);f=d.time%f/f;d.Sg&&(f=1-f);this.md[d.ci]=f*h;this.md[d.an]=(1-f)*h}}};b.dt=function(){function a(a,b){var c=e.createProgram(),d=e.createShader(e.FRAGMENT_SHADER),f=e.createShader(e.VERTEX_SHADER),g="precision "+b+" float;\n";return e.shaderSource(d,g+a.L),e.shaderSource(f,g+a.O),e.compileShader(d),e.compileShader(f),e.attachShader(c,d),e.attachShader(c,f),e.linkProgram(c),c}var e,c,d,f,g,h,k,l,m,q,p,r,v;this.si=function(w){e=
w.Mf;c=w;d=w.tq();f=new Float32Array(16);g=new Uint16Array(6);w=0;f[w++]=-1;f[w++]=-1;f[w++]=0;f[w++]=0;f[w++]=1;f[w++]=-1;f[w++]=1;f[w++]=0;f[w++]=1;f[w++]=1;f[w++]=1;f[w++]=1;f[w++]=-1;f[w++]=1;f[w++]=0;f[w++]=1;w=0;g[w++]=0;g[w++]=1;g[w++]=2;g[w++]=0;g[w++]=2;g[w++]=3;h=e.createBuffer();k=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,h);e.bufferData(e.ARRAY_BUFFER,f,e.STATIC_DRAW);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,k);e.bufferData(e.ELEMENT_ARRAY_BUFFER,g,e.STATIC_DRAW);l=e.createTexture();m=e.createTexture();
e.bindTexture(e.TEXTURE_2D,l);e.texImage2D(e.TEXTURE_2D,0,e.RGB,16,16,0,e.RGB,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST);e.bindTexture(e.TEXTURE_2D,m);e.texImage2D(e.TEXTURE_2D,0,e.RGBA,16,16,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE);
e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST);0>=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS)?(q=!1,p=a(b.Xo.Yw,d)):(q=!0,p=a(b.Xo.Zw,d));r={};v={};r.ll=e.getAttribLocation(p,"position");r.Pb=e.getAttribLocation(p,"uv");v.Mn=e.getUniformLocation(p,"renderType");v.map=e.getUniformLocation(p,"map");v.Xx=e.getUniformLocation(p,"occlusionMap");v.opacity=e.getUniformLocation(p,
"opacity");v.color=e.getUniformLocation(p,"color");v.scale=e.getUniformLocation(p,"scale");v.rotation=e.getUniformLocation(p,"rotation");v.Nk=e.getUniformLocation(p,"screenPosition")};this.v=function(a,d,f,g){a=a.Rl;var A=a.length;if(A){var Q=new b.a,O=g/f,P=0.5*f,I=0.5*g,F=16/g,L=new b.i(F*O,F),K=new b.a(1,1,0),N=new b.i(1,1),B=v,W=r;e.useProgram(p);e.enableVertexAttribArray(r.ll);e.enableVertexAttribArray(r.Pb);e.uniform1i(B.Xx,0);e.uniform1i(B.map,1);e.bindBuffer(e.ARRAY_BUFFER,h);e.vertexAttribPointer(W.ll,
2,e.FLOAT,!1,16,0);e.vertexAttribPointer(W.Pb,2,e.FLOAT,!1,16,8);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,k);e.disable(e.CULL_FACE);e.depthMask(!1);for(var M,J,R,U,W=0;A>W;W++)if(F=16/g,L.set(F*O,F),R=a[W],Q.set(R.A.elements[12],R.A.elements[13],R.A.elements[14]),Q.Z(d.gb),Q.Gd(d.wa),K.copy(Q),N.x=K.x*P+P,N.y=K.y*I+I,q||0<N.x&&N.x<f&&0<N.y&&N.y<g)for(e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,l),e.copyTexImage2D(e.TEXTURE_2D,0,e.RGB,N.x-8,N.y-8,16,16,0),e.uniform1i(B.Mn,0),e.uniform2f(B.scale,
L.x,L.y),e.uniform3f(B.Nk,K.x,K.y,K.z),e.disable(e.BLEND),e.enable(e.DEPTH_TEST),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,m),e.copyTexImage2D(e.TEXTURE_2D,0,e.RGBA,N.x-8,N.y-8,16,16,0),e.uniform1i(B.Mn,1),e.disable(e.DEPTH_TEST),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,l),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0),R.e.copy(K),R.vm?R.vm(R):R.Vz(),e.uniform1i(B.Mn,2),e.enable(e.BLEND),M=0,J=R.Qd.length;J>M;M++)U=R.Qd[M],
0.0010<U.opacity&&0.0010<U.scale&&(K.x=U.x,K.y=U.y,K.z=U.z,F=U.size*U.scale/g,L.x=F*O,L.y=F,e.uniform3f(B.Nk,K.x,K.y,K.z),e.uniform2f(B.scale,L.x,L.y),e.uniform1f(B.rotation,U.rotation),e.uniform1f(B.opacity,U.opacity),e.uniform3f(B.color,U.color.q,U.color.o,U.color.h),c.rh(U.Ha,U.blendEquation,U.Kf,U.Jf),c.Oi(U.La,1),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0));e.enable(e.CULL_FACE);e.enable(e.DEPTH_TEST);e.depthMask(!0)}}};b.Hl=function(){var a,e,c,d,f,g,h=new b.yf,k=new b.K,l=new b.a,m=new b.a,
q=new b.a;this.si=function(h){a=h.Mf;e=h;h=b.yg.Am;var k=b.xc.d(h.N);c=new b.Ra({L:h.L,O:h.O,N:k});d=new b.Ra({L:h.L,O:h.O,N:k,B:!0});f=new b.Ra({L:h.L,O:h.O,N:k,Ka:!0});g=new b.Ra({L:h.L,O:h.O,N:k,B:!0,Ka:!0});c.Ke=!0;d.Ke=!0;f.Ke=!0;g.Ke=!0};this.v=function(a,b){e.hg&&e.lz&&this.update(a,b)};this.update=function(p,r){var v,w,u,s,t,A,Q,O,P,I,F,L=[];u=0;a.clearColor(1,1,1,1);a.disable(a.BLEND);a.enable(a.CULL_FACE);a.frontFace(a.CCW);e.Pr===b.lj?a.cullFace(a.FRONT):a.cullFace(a.BACK);e.fg(!0);v=0;
for(w=p.yc.length;w>v;v++)if(I=p.yc[v],I.Lb)if(I instanceof b.Ib&&I.Wn)for(t=0;t<I.hz;t++){var K;if(I.Tk[t])K=I.Tk[t];else{O=I;F=t;K=new b.Ib;K.Ow=!0;K.ff=!0;K.Lb=!0;K.Ri=O.Ri;K.Qi=O.Qi;K.Tn=O.Tn;K.Un=O.Un;K.Sn=O.Sn;K.Vn=O.Vn;K.kf=O.kf;K.lf=O.lf;K.th=O.Mr[F];K.Vi=O.kz[F];K.Si=O.iz[F];K.jr=[];K.Dn=[];var N=K.jr;s=K.Dn;for(var B=0;8>B;B++)N[B]=new b.a,s[B]=new b.a;N=O.Or[F];O=O.Nr[F];K=(s[0].set(-1,-1,N),s[1].set(1,-1,N),s[2].set(-1,1,N),s[3].set(1,1,N),s[4].set(-1,-1,O),s[5].set(1,-1,O),s[6].set(-1,
1,O),s[7].set(1,1,O),K);K.gy=r;s=new b.$d;s.position=I.jz;s.add(K);s.add(K.target);r.add(s);I.Tk[t]=K;console.log("Created virtualLight",K)}F=I;N=t;O=F.Tk[N];O.position.copy(F.position);O.target.position.copy(F.target.position);O.ub(O.target);O.kf=F.kf;O.lf=F.lf;O.th=F.Mr[N];s=F.Or[N];F=F.Nr[N];O=O.Dn;O[0].z=s;O[1].z=s;O[2].z=s;O[3].z=s;O[4].z=F;O[5].z=F;O[6].z=F;O[7].z=F;L[u]=K;u++}else L[u]=I,u++;v=0;for(w=L.length;w>v;v++){(I=L[v],I.gg)||(t=b.ae,e.Ui===b.Ko&&(t=b.Be),I.gg=new b.Ge(I.Vi,I.Si,{nb:t,
Gb:t,ma:b.Bf}),I.Ti=new b.i(I.Vi,I.Si),I.ig=new b.K);if(!I.se){if(I instanceof b.Ee)I.se=new b.uc(I.gz,I.Vi/I.Si,I.Ri,I.Qi);else{if(!(I instanceof b.Ib)){console.error("Unsupported light type for shadow");continue}I.se=new b.Hh(I.Tn,I.Un,I.Vn,I.Sn,I.Ri,I.Qi)}p.add(I.se);!0===p.Rj&&p.fc()}I.kf&&!I.Qh&&(I.Qh=new b.pl(I.se),I.se.add(I.Qh));if(I.Ow&&K.gy==r){t=r;u=I.se;s=I.Dn;O=I.jr;l.set(1/0,1/0,1/0);m.set(-1/0,-1/0,-1/0);for(F=0;8>F;F++)N=O[F],N.copy(s[F]),b.Hl.St.il(N,t),N.Z(u.gb),N.x<l.x&&(l.x=N.x),
N.x>m.x&&(m.x=N.x),N.y<l.y&&(l.y=N.y),N.y>m.y&&(m.y=N.y),N.z<l.z&&(l.z=N.z),N.z>m.z&&(m.z=N.z);u.left=l.x;u.right=m.x;u.top=m.y;u.bottom=l.y;u.og()}u=I.gg;s=I.ig;t=I.se;t.position.lb(I.A);q.lb(I.target.A);t.ub(q);t.fc();t.gb.Ld(t.A);I.Qh&&(I.Qh.visible=I.kf);I.kf&&I.Qh.update();s.set(0.5,0,0,0.5,0,0.5,0,0.5,0,0,0.5,0.5,0,0,0,1);s.multiply(t.wa);s.multiply(t.gb);k.Da(t.wa,t.gb);h.Pk(k);e.Rk(u);e.clear();F=p.Ac;u=0;for(s=F.length;s>u;u++)O=F[u],P=O.object,O.v=!1,P.visible&&P.Lb&&((P instanceof b.J||
P instanceof b.Tb)&&P.Of&&!h.rk(P)||(P.Tc.Da(t.gb,P.A),O.v=!0));var W,M,J;u=0;for(s=F.length;s>u;u++)O=F[u],O.v&&(P=O.object,A=O.buffer,W=P.n instanceof b.gc?P.n.ja[0]:P.n,M=0<P.l.B.length&&W.B,J=P instanceof b.Ub&&W.Ka,Q=P.Zj?P.Zj:J?M?g:f:M?d:c,A instanceof b.ze?e.Kn(t,p.yc,null,Q,A,P):e.Jn(t,p.yc,null,Q,A,P));F=p.Je;u=0;for(s=F.length;s>u;u++)O=F[u],P=O.object,P.visible&&P.Lb&&(P.Tc.Da(t.gb,P.A),e.Ln(t,p.yc,null,c,P))}v=e.oq();a.clearColor(v.q,v.o,v.h,e.nq());a.enable(a.BLEND);e.Pr===b.lj&&a.cullFace(a.BACK)}};
b.Hl.St=new b.Dl;b.zt=function(){function a(a,b){return a.z!==b.z?b.z-a.z:b.id-a.id}var e,c,d,f,g,h,k,l,m,q;this.si=function(a){e=a.Mf;c=a;d=a.tq();f=new Float32Array(16);g=new Uint16Array(6);a=0;f[a++]=-1;f[a++]=-1;f[a++]=0;f[a++]=0;f[a++]=1;f[a++]=-1;f[a++]=1;f[a++]=0;f[a++]=1;f[a++]=1;f[a++]=1;f[a++]=1;f[a++]=-1;f[a++]=1;f[a++]=0;f[a++]=1;a=0;g[a++]=0;g[a++]=1;g[a++]=2;g[a++]=0;g[a++]=2;g[a++]=3;h=e.createBuffer();k=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,h);e.bufferData(e.ARRAY_BUFFER,f,
e.STATIC_DRAW);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,k);e.bufferData(e.ELEMENT_ARRAY_BUFFER,g,e.STATIC_DRAW);a=b.wt.zz;var r=e.createProgram(),v=e.createShader(e.FRAGMENT_SHADER),w=e.createShader(e.VERTEX_SHADER),u="precision "+d+" float;\n";l=(e.shaderSource(v,u+a.L),e.shaderSource(w,u+a.O),e.compileShader(v),e.compileShader(w),e.attachShader(r,v),e.attachShader(r,w),e.linkProgram(r),r);m={};q={};m.position=e.getAttribLocation(l,"position");m.Pb=e.getAttribLocation(l,"uv");q.xh=e.getUniformLocation(l,
"uvOffset");q.yh=e.getUniformLocation(l,"uvScale");q.rotation=e.getUniformLocation(l,"rotation");q.scale=e.getUniformLocation(l,"scale");q.Gg=e.getUniformLocation(l,"alignment");q.color=e.getUniformLocation(l,"color");q.map=e.getUniformLocation(l,"map");q.opacity=e.getUniformLocation(l,"opacity");q.wd=e.getUniformLocation(l,"useScreenCoordinates");q.ec=e.getUniformLocation(l,"sizeAttenuation");q.Nk=e.getUniformLocation(l,"screenPosition");q.$q=e.getUniformLocation(l,"modelViewMatrix");q.wa=e.getUniformLocation(l,
"projectionMatrix");q.jk=e.getUniformLocation(l,"fogType");q.gk=e.getUniformLocation(l,"fogDensity");q.ik=e.getUniformLocation(l,"fogNear");q.hk=e.getUniformLocation(l,"fogFar");q.fk=e.getUniformLocation(l,"fogColor");q.Dc=e.getUniformLocation(l,"alphaTest")};this.v=function(d,f,g,w){var u=d.Ul,s=u.length;if(s){var t=m,A=q,Q=w/g;g*=0.5;var O=0.5*w;e.useProgram(l);e.enableVertexAttribArray(t.position);e.enableVertexAttribArray(t.Pb);e.disable(e.CULL_FACE);e.enable(e.BLEND);e.bindBuffer(e.ARRAY_BUFFER,
h);e.vertexAttribPointer(t.position,2,e.FLOAT,!1,16,0);e.vertexAttribPointer(t.Pb,2,e.FLOAT,!1,16,8);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,k);e.uniformMatrix4fv(A.wa,!1,f.wa.elements);e.activeTexture(e.TEXTURE0);e.uniform1i(A.map,0);var P=t=0,I=d.D;I?(e.uniform3f(A.fk,I.color.q,I.color.o,I.color.h),I instanceof b.Bh?(e.uniform1f(A.ik,I.Ja),e.uniform1f(A.hk,I.Ia),e.uniform1i(A.jk,1),t=1,P=1):I instanceof b.xf&&(e.uniform1f(A.gk,I.$j),e.uniform1i(A.jk,2),t=2,P=2)):(e.uniform1i(A.jk,0),t=0,P=0);for(var F,
L,K,N,B=[],I=0;s>I;I++)F=u[I],L=F.n,F.visible&&0!==L.opacity&&(L.wd?F.z=-F.position.z:(F.Tc.Da(f.gb,F.A),F.z=-F.Tc.elements[14]));u.sort(a);for(I=0;s>I;I++)F=u[I],L=F.n,F.visible&&0!==L.opacity&&L.map&&L.map.R&&L.map.R.width&&(e.uniform1f(A.Dc,L.Dc),!0===L.wd?(e.uniform1i(A.wd,1),e.uniform3f(A.Nk,(F.position.x*c.devicePixelRatio-g)/g,(O-F.position.y*c.devicePixelRatio)/O,Math.max(0,Math.min(1,F.position.z))),B[0]=c.devicePixelRatio,B[1]=c.devicePixelRatio):(e.uniform1i(A.wd,0),e.uniform1i(A.ec,L.ec?
1:0),e.uniformMatrix4fv(A.$q,!1,F.Tc.elements),B[0]=1,B[1]=1),N=d.D&&L.D?P:0,t!==N&&(e.uniform1i(A.jk,N),t=N),K=1/(L.Li?w:1),B[0]*=K*Q*F.scale.x,B[1]*=K*F.scale.y,e.uniform2f(A.yh,L.yh.x,L.yh.y),e.uniform2f(A.xh,L.xh.x,L.xh.y),e.uniform2f(A.Gg,L.Gg.x,L.Gg.y),e.uniform1f(A.opacity,L.opacity),e.uniform3f(A.color,L.color.q,L.color.o,L.color.h),e.uniform1f(A.rotation,F.rotation),e.uniform2fv(A.scale,B),c.rh(L.Ha,L.blendEquation,L.Kf,L.Jf),c.fg(L.Db),c.Mi(L.Gc),c.Oi(L.map,0),e.drawElements(e.TRIANGLES,
6,e.UNSIGNED_SHORT,0));e.enable(e.CULL_FACE)}}};b.uA=function(){this.enabled=!1;this.Ki=null;var a,e,c,d,f,g,h=new b.yf,k=new b.K;this.si=function(h){a=h.Mf;e=h;h=b.yg.Am;var k=b.xc.d(h.N);c=new b.Ra({L:h.L,O:h.O,N:k});d=new b.Ra({L:h.L,O:h.O,N:k,B:!0});f=new b.Ra({L:h.L,O:h.O,N:k,Ka:!0});g=new b.Ra({L:h.L,O:h.O,N:k,B:!0,Ka:!0});c.Ke=!0;d.Ke=!0;f.Ke=!0;g.Ke=!0};this.v=function(a,b){this.enabled&&this.update(a,b)};this.update=function(l,m){var q,p,r,v,w,u,s;a.clearColor(1,1,1,1);a.disable(a.BLEND);
e.fg(!0);!0===l.Rj&&l.fc();m.gb.Ld(m.A);k.Da(m.wa,m.gb);h.Pk(k);e.Rk(this.Ki);e.clear();s=l.Ac;q=0;for(p=s.length;p>q;q++)w=s[q],u=w.object,w.v=!1,u.visible&&((u instanceof b.J||u instanceof b.Tb)&&u.Of&&!h.rk(u)||(u.Tc.Da(m.gb,u.A),w.v=!0));var t;q=0;for(p=s.length;p>q;q++)(w=s[q],!w.v)||(u=w.object,r=w.buffer,u instanceof b.Tb&&!u.Zj)||((t=u.n instanceof b.gc?u.n.ja[0]:u.n)&&e.Pn(u.n),v=0<u.l.B.length&&t.B,t=u instanceof b.Ub&&t.Ka,v=u.Zj?u.Zj:t?v?g:f:v?d:c,r instanceof b.ze?e.Kn(m,l.yc,null,v,
r,u):e.Jn(m,l.yc,null,v,r,u));s=l.Je;q=0;for(p=s.length;p>q;q++)w=s[q],u=w.object,u.visible&&(u.Tc.Da(m.gb,u.A),e.Ln(m,l.yc,null,c,u));q=e.oq();a.clearColor(q.q,q.o,q.h,e.nq());a.enable(a.BLEND)}};b.Xo={Zw:{O:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform sampler2D occlusionMap;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\nvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) ) +\ntexture2D( occlusionMap, vec2( 0.5, 0.1 ) ) +\ntexture2D( occlusionMap, vec2( 0.9, 0.1 ) ) +\ntexture2D( occlusionMap, vec2( 0.9, 0.5 ) ) +\ntexture2D( occlusionMap, vec2( 0.9, 0.9 ) ) +\ntexture2D( occlusionMap, vec2( 0.5, 0.9 ) ) +\ntexture2D( occlusionMap, vec2( 0.1, 0.9 ) ) +\ntexture2D( occlusionMap, vec2( 0.1, 0.5 ) ) +\ntexture2D( occlusionMap, vec2( 0.5, 0.5 ) );\nvVisibility = (       visibility.r / 9.0 ) *\n( 1.0 - visibility.g / 9.0 ) *\n(       visibility.b / 9.0 ) *\n( 1.0 - visibility.a / 9.0 );\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",
L:"uniform lowp int renderType;\nuniform sampler2D map;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * vVisibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"},Yw:{O:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",
L:"precision mediump float;\nuniform lowp int renderType;\nuniform sampler2D map;\nuniform sampler2D occlusionMap;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nfloat visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a +\ntexture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a +\ntexture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a +\ntexture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;\nvisibility = ( 1.0 - visibility / 4.0 );\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * visibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"}};
b.wt={zz:{O:"uniform int useScreenCoordinates;\nuniform int sizeAttenuation;\nuniform vec3 screenPosition;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 alignment;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uvOffset + uv * uvScale;\nvec2 alignedPosition = position + alignment;\nvec2 rotatedPosition;\nrotatedPosition.x = ( cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y ) * scale.x;\nrotatedPosition.y = ( sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y ) * scale.y;\nvec4 finalPosition;\nif( useScreenCoordinates != 0 ) {\nfinalPosition = vec4( screenPosition.xy + rotatedPosition, screenPosition.z, 1.0 );\n} else {\nfinalPosition = projectionMatrix * modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\nfinalPosition.xy += rotatedPosition * ( sizeAttenuation == 1 ? 1.0 : finalPosition.z );\n}\ngl_Position = finalPosition;\n}",
L:"uniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvoid main() {\nvec4 texture = texture2D( map, vUV );\nif ( texture.a < alphaTest ) discard;\ngl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\nif ( fogType > 0 ) {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat fogFactor = 0.0;\nif ( fogType == 1 ) {\nfogFactor = smoothstep( fogNear, fogFar, depth );\n} else {\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n}\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}\n}"}};
b.Ns=function(){function a(a,d,f){if(ea=a,d=d||$a,void 0!==f)a=f.split("/"),a.pop(),T=(1>a.length?".":a.join("/"))+"/";if((a=ea.evaluate("//dae:asset",ea,G,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null).iterateNext())&&a.childNodes)for(f=0;f<a.childNodes.length;f++){var l=a.childNodes[f];switch(l.nodeName){case "unit":(l=l.getAttribute("meter"))&&(Ha=parseFloat(l));break;case "up_axis":ta=l.textContent.charAt(0)}}if($.Xj&&ta!==$.gj)switch(ta){case "X":Da="Y"===$.gj?"XtoY":"XtoZ";break;case "Y":Da="X"===
$.gj?"YtoX":"YtoZ";break;case "Z":Da="X"===$.gj?"ZtoX":"ZtoY"}else Da=null;va=e("//dae:library_images/dae:image",h,"image");Ka=e("//dae:library_materials/dae:material",K,"material");ya=e("//dae:library_effects/dae:effect",J,"effect");Pa=e("//dae:library_geometries/dae:geometry",s,"geometry");ia=e(".//dae:library_cameras/dae:camera",D,"camera");sa=e(".//dae:library_lights/dae:light",ma,"light");ka=e("//dae:library_controllers/dae:controller",k,"controller");Oa=e("//dae:library_animations/dae:animation",
U,"animation");V=e(".//dae:library_visual_scenes/dae:visual_scene",q,"visual_scene");Ga=[];ra=[];(a=ea.evaluate(".//dae:scene/dae:instance_visual_scene",ea,G,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null).iterateNext())?(a=a.getAttribute("url").replace(/^#/,""),fb=V[0<a.length?a:"visual_scene0"]):fb=null;bb=new b.w;for(a=0;a<fb.hb.length;a++)bb.add(g(fb.hb[a]));bb.scale.p(Ha);Ca=[];c(bb);a={Ea:bb,WE:Ga,mz:ra,Lu:Ca,wm:{images:va,ja:Ka,Pe:ia,fb:sa,zC:ya,na:Pa,controllers:ka,Lu:Oa,MH:V,Ea:fb}};return d&&
d(a),a}function e(a,b,c){a=ea.evaluate(a,ea,G,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null);for(var d={},e=a.iterateNext(),f=0;e;)e=(new b).parse(e),e.id&&0!=e.id.length||(e.id=c+f++),d[e.id]=e,e=a.iterateNext();return d}function c(a){var b=fb.oi(a.name,!0),d=null;if(b&&b.keys){d={Zg:60,u:[{Fk:b,keys:b.keys,uh:b.uh}],Fk:a,name:"animation_"+a.name,length:0};Ca.push(d);for(var e=0,f=b.keys.length;f>e;e++)d.length=Math.max(d.length,b.keys[e].time)}else d={u:[{keys:[],uh:[]}]};e=0;for(f=a.children.length;f>
e;e++)for(var b=0,g=c(a.children[e]).u.length;g>b;b++)d.u.push({keys:[],uh:[]});return d}function d(a,c,e,f){if(a.rg=a.rg||new b.K,a.rg.copy(a.ba),a.Hd&&a.Hd.length){var g=a.Hd[0].$c.Fi[e];g instanceof b.K&&a.rg.copy(g)}f&&a.rg.Da(f,a.rg);c.push(a);for(f=0;f<a.hb.length;f++)d(a.hb[f],c,e,a.rg)}function f(a,c,e){var f,g=ka[c.url];if(!g||!g.ad)return console.log("ColladaLoader: Could not find skin controller."),void 0;if(!c.mf||!c.mf.length)return console.log("ColladaLoader: Could not find the skeleton for the skin. "),
void 0;var h,k,l,m,n;e=1E6;var p=-e,y=0;for(f in Oa){var q=Oa[f];for(h=0;h<q.$c.length;h++)k=q.$c[h],k.create(),e=Math.min(e,k.startTime),p=Math.max(p,k.Te),y=Math.max(y,k.input.length)}f=y;c=fb.oi(c.mf[0],!0)||fb.mk(c.mf[0],!0);p=new b.a;for(h=0;h<a.c.length;h++)a.c[h].Z(g.ad.Lp);for(e=0;e<f;e++){y=[];q=[];for(h=0;h<a.c.length;h++)q.push(new b.a);d(c,y,e);h=y;k=g.ad;for(m=0;m<h.length;m++)if(l=h[m],n=-1,"JOINT"==l.type){for(var r=0;r<k.sk.length;r++)if(l.pb==k.sk[r]){n=r;break}if(!(0<=n))throw"ColladaLoader: Could not find joint '"+
l.pb+"'.";r=k.Xm[n];l.rD=r;l.Tr=new b.K;l.Tr.Da(l.rg,r);l.xd=[];for(r=0;r<k.xd.length;r++)for(var D=0;D<k.xd[r].length;D++){var u=k.xd[r][D];u.Qw==n&&l.xd.push(u)}}for(h=0;h<y.length;h++)if("JOINT"==y[h].type)for(k=0;k<y[h].xd.length;k++)l=y[h].xd[k],m=l.index,l=l.xe,n=a.c[m],m=q[m],p.x=n.x,p.y=n.y,p.z=n.z,p.Z(y[h].Tr),m.x+=p.x*l,m.y+=p.y*l,m.z+=p.z*l;a.B.push({name:"target_"+e,c:q})}}function g(a){var c,d,e,h,k=new b.w;for(e=0;e<a.controllers.length;e++){var l=ka[a.controllers[e].url];switch(l.type){case "skin":if(Pa[l.ad.source]){var m=
new u;m.url=l.ad.source;m.Wc=a.controllers[e].Wc;a.na.push(m);c=a.controllers[e]}else ka[l.ad.source]&&(l=ka[l.ad.source],d=l,l.Rd&&Pa[l.Rd.source])&&(m=new u,m.url=l.Rd.source,m.Wc=a.controllers[e].Wc,a.na.push(m));break;case "morph":Pa[l.Rd.source]&&(m=new u,m.url=l.Rd.source,m.Wc=a.controllers[e].Wc,a.na.push(m),d=a.controllers[e]),console.log("ColladaLoader: Morph-controller partially supported.")}}m={};for(e=0;e<a.na.length;e++){var n;h=a.na[e];var l=h.Wc,p=Pa[h.url],y={},q=[],r=0;if(p&&p.Ba&&
p.Ba.Td){if(0==k.name.length&&(k.name=p.id),l)for(h=0;h<l.length;h++){n=l[h];var D=Ka[n.target],s=ya[D.Aq.url].Sk.n;if(p.Se){if(!(s in m)){var t=s.d();t.Kc=b.dd;m[s]=t}s=m[s]}s.opacity=s.opacity?s.opacity:1;y[n.Zr]=r;q.push(s);n=s;n.name=null==D.name||""===D.name?D.id:D.name;r++}l=n||new b.hc({color:14540253,ua:b.wf,Kc:p.Se?b.dd:b.vg});p=p.Ba.Kd;if(1<r)for(l=new b.gc(q),h=0;h<p.j.length;h++)q=p.j[h],q.Ca=y[q.xv];if(void 0!==c)f(p,c),l.B=!0,l=new b.Ub(p,l,!1),l.mf=c.mf,l.OG=ka[c.url],l.PG=c,l.name=
"skin_"+ra.length,ra.push(l);else if(void 0!==d){h=p;if((y=d instanceof v?ka[d.url]:d)&&y.Rd){y=y.Rd;for(q=0;q<y.mc.length;q++)r=Pa[y.mc[q]],r.Ba&&(r.Ba.Td&&r.Ba.Td.length)&&(r=r.Ba.Td[0].l,r.c.length===h.c.length&&h.B.push({name:"target_1",c:r.c}));h.B.push({name:"target_Z",c:h.c})}else console.log("could not find morph controller!");l.B=!0;l=new b.J(p,l);l.name="morph_"+Ga.length;Ga.push(l)}else l=new b.J(p,l);1<a.na.length?k.add(l):k=l}}for(e=0;e<a.Pe.length;e++)c=ia[a.Pe[e].url],k=new b.uc(c.kd,
c.Jp,c.Es,c.Ds);for(e=0;e<a.fb.length;e++)switch(c=sa[a.fb[e].url],c.wh){case "ambient":k=new b.qf(c.color);break;case "point":k=new b.Bd(c.color);break;case "directional":k=new b.Ib(c.color)}k.name=a.name||a.id||"";k.ba=a.ba;e=a.ba.xm();if(k.position=e[0],k.fa=e[1],k.jb=!0,k.scale=e[2],$.hv&&k.l)e=b.Ma.bb(k.l),e.multiply(k.scale),e.Qj(k.fa),k.position.sub(e);for(e=0;e<a.hb.length;e++)k.add(g(a.hb[e]));return k}function h(){this.ti=this.id=""}function k(){this.type=this.name=this.id="";this.Rd=this.ad=
null}function l(){this.xd=this.mc=this.source=this.method=null}function m(){this.source="";this.Lp=null;this.Xm=[];this.sk=[];this.xd=[]}function q(){this.name=this.id="";this.hb=[];this.Ea=new b.w}function p(){this.pb=this.name=this.id="";this.hb=[];this.controllers=[];this.lg=[];this.na=[];this.Hd=[];this.ba=new b.K}function r(){this.type=this.pb="";this.data=[];this.T=null}function v(){this.url="";this.mf=[];this.Wc=[]}function w(){this.target=this.Zr=""}function u(){this.url="";this.Wc=[]}function s(){this.id=
"";this.Ba=null}function t(a){this.l=a.id;this.Td=[];this.Kd=this.c=null}function A(){this.n="";this.count=0;this.Od=[];this.qg=null;this.mh=[];this.l=new b.H}function Q(){A.call(this);this.qg=[]}function O(){A.call(this);this.qg=3}function P(){this.source="";this.Xr=this.count=0;this.bg=[]}function I(){this.input={}}function F(){this.rd="";this.offset=0;this.source="";this.set=0}function L(a){this.id=a;this.type=null}function K(){this.name=this.id="";this.Aq=null}function N(){this.color=new b.k;
this.color.Wa(Math.random(),Math.random(),Math.random());this.color.r=1;this.Xd=this.Kz=this.La=null}function B(a,b){this.type=a;this.ki=b;this.n=null}function W(a){this.ki=a;this.ma=this.ti=null}function M(a){this.ki=a;this.Kx=this.rx=this.Jx=this.eA=this.dA=this.source=null}function J(){this.name=this.id="";this.Sk=null;this.Yr={};this.$c={}}function R(){this.url=""}function U(){this.name=this.id="";this.source={};this.$c=[];this.Mg=[]}function Y(a){this.Oj=a;this.target=this.source="";this.gh=
this.Oh=this.Ip=this.Wp=this.pb=this.kq=null}function C(a){this.id="";this.Oj=a;this.Od=[];this.Te=this.startTime=this.Iw=this.kg=this.Fi=this.input=null;this.duration=0}function y(a){this.mc=[];this.time=a}function D(){this.wh=this.name=this.id=""}function Z(){this.url=""}function ma(){this.wh=this.name=this.id=""}function S(){this.url=""}function G(a){return"dae"==a?"http://www.collada.org/2005/11/COLLADASchema":null}function na(a){a=wa(a);for(var b=[],c=0,d=a.length;d>c;c++)b.push(parseFloat(a[c]));
return b}function Ba(a){a=wa(a);for(var b=[],c=0,d=a.length;d>c;c++)b.push(parseInt(a[c],10));return b}function wa(a){return 0<a.length?a.replace(/^\s+/,"").replace(/\s+$/,"").split(/\s+/):[]}function ja(a,b,c){return a.hasAttribute(b)?parseInt(a.getAttribute(b),10):c}function ha(a,b){a.Se=!1;var c=ea.evaluate(".//dae:extra//dae:double_sided",b,G,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null);c&&(c=c.iterateNext(),c&&1===parseInt(c.textContent,10)&&(a.Se=!0))}function da(a,b){if($.Xj&&ta!==$.gj)switch(Da){case "XtoY":var c=
a[0];a[0]=b*a[1];a[1]=c;break;case "XtoZ":c=a[2];a[2]=a[1];a[1]=a[0];a[0]=c;break;case "YtoX":c=a[0];a[0]=a[1];a[1]=b*c;break;case "YtoZ":c=a[1];a[1]=b*a[2];a[2]=c;break;case "ZtoX":c=a[0];a[0]=a[1];a[1]=a[2];a[2]=c;break;case "ZtoY":c=a[1],a[1]=a[2],a[2]=b*c}}function Aa(a,c){var d=[a[c],a[c+1],a[c+2]];return da(d,-1),new b.a(d[0],d[1],d[2])}function n(a){if($.Xj){var c=[a[0],a[4],a[8]];da(c,-1);a[0]=c[0];a[4]=c[1];a[8]=c[2];c=[a[1],a[5],a[9]];da(c,-1);a[1]=c[0];a[5]=c[1];a[9]=c[2];c=[a[2],a[6],
a[10]];da(c,-1);a[2]=c[0];a[6]=c[1];a[10]=c[2];c=[a[0],a[1],a[2]];da(c,-1);a[0]=c[0];a[1]=c[1];a[2]=c[2];c=[a[4],a[5],a[6]];da(c,-1);a[4]=c[0];a[5]=c[1];a[6]=c[2];c=[a[8],a[9],a[10]];da(c,-1);a[8]=c[0];a[9]=c[1];a[10]=c[2];c=[a[3],a[7],a[11]];da(c,-1);a[3]=c[0];a[7]=c[1];a[11]=c[2]}return new b.K(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15])}function pa(a){if($.Xj)switch(a){case "X":switch(Da){case "XtoY":case "XtoZ":case "YtoX":a="Y";break;case "ZtoX":a="Z"}break;
case "Y":switch(Da){case "XtoY":case "YtoX":case "ZtoX":a="X";break;case "XtoZ":case "YtoZ":case "ZtoY":a="Z"}break;case "Z":switch(Da){case "XtoZ":a="X";break;case "YtoZ":case "ZtoX":case "ZtoY":a="Y"}}return a}var fb,Ca,V,T,Ga,ra,ea=null,bb=null,$a=null,la={},va={},Oa={},ka={},Pa={},Ka={},ya={},ia={},sa={},La=b.wc,$={hv:!1,Xj:!1,Ez:!0,gj:"Y",Tp:null},Ha=1,ta="Y",Da=null;return h.prototype.parse=function(a){this.id=a.getAttribute("id");for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];
"init_from"==c.nodeName&&(this.ti=c.textContent)}return this},k.prototype.parse=function(a){this.id=a.getAttribute("id");this.name=a.getAttribute("name");this.type="none";for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];switch(c.nodeName){case "skin":this.ad=(new m).parse(c);this.type=c.nodeName;break;case "morph":this.Rd=(new l).parse(c),this.type=c.nodeName}}return this},l.prototype.parse=function(a){var b,c={},d=[];this.method=a.getAttribute("method");this.source=a.getAttribute("source").replace(/^#/,
"");for(b=0;b<a.childNodes.length;b++){var e=a.childNodes[b];if(1==e.nodeType)switch(e.nodeName){case "source":e=(new L).parse(e);c[e.id]=e;break;case "targets":d=this.hy(e);break;default:console.log(e.nodeName)}}for(b=0;b<d.length;b++)switch(a=d[b],e=c[a.source],a.rd){case "MORPH_TARGET":this.mc=e.eg();break;case "MORPH_WEIGHT":this.xd=e.eg()}return this},l.prototype.hy=function(a){for(var b=[],c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];if(1==d.nodeType)switch(d.nodeName){case "input":b.push((new F).parse(d))}}return b},
m.prototype.parse=function(a){var b,c,d={};this.source=a.getAttribute("source").replace(/^#/,"");this.Xm=[];this.sk=[];this.xd=[];for(var e=0;e<a.childNodes.length;e++){var f=a.childNodes[e];if(1==f.nodeType)switch(f.nodeName){case "bind_shape_matrix":f=na(f.textContent);this.Lp=n(f);break;case "source":f=(new L).parse(f);d[f.id]=f;break;case "joints":b=f;break;case "vertex_weights":c=f;break;default:console.log(f.nodeName)}}return this.iy(b,d),this.my(c,d),this},m.prototype.iy=function(a,b){for(var c=
0;c<a.childNodes.length;c++){var d=a.childNodes[c];if(1==d.nodeType)switch(d.nodeName){case "input":var d=(new F).parse(d),e=b[d.source];"JOINT"==d.rd?this.sk=e.eg():"INV_BIND_MATRIX"==d.rd&&(this.Xm=e.eg())}}},m.prototype.my=function(a,b){for(var c,d,e=[],f=0;f<a.childNodes.length;f++){var g=a.childNodes[f];if(1==g.nodeType)switch(g.nodeName){case "input":e.push((new F).parse(g));break;case "v":c=Ba(g.textContent);break;case "vcount":d=Ba(g.textContent)}}for(f=g=0;f<d.length;f++){for(var h=d[f],
k=[],l=0;h>l;l++){for(var m={},n=0;n<e.length;n++){var p=e[n],y=c[g+p.offset];switch(p.rd){case "JOINT":m.Qw=y;break;case "WEIGHT":m.xe=b[p.source].data[y]}}k.push(m);g+=e.length}for(l=0;l<k.length;l++)k[l].index=f;this.xd.push(k)}},q.prototype.oi=function(a,b){for(var c=0;c<this.hb.length;c++){var d=this.hb[c].oi(a,b);if(d)return d}return null},q.prototype.mk=function(a,b){for(var c=0;c<this.hb.length;c++){var d=this.hb[c].mk(a,b);if(d)return d}return null},q.prototype.parse=function(a){this.id=
a.getAttribute("id");this.name=a.getAttribute("name");this.hb=[];for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case "node":this.hb.push((new p).parse(c))}}return this},p.prototype.UC=function(a){for(var b=0;b<this.Hd.length;b++){var c=this.Hd[b],d=c.target.split("/");d.shift();var e,f=d.shift(),g=0<=f.indexOf("."),h=0<=f.indexOf("(");if(g)d=f.split("."),f=d.shift(),d.shift();else if(h)for(e=f.split("("),f=e.shift(),d=0;d<e.length;d++)e[d]=parseInt(e[d].replace(/\)/,
""));if(f==a)return c.info={pb:f,Wp:g,Ip:h,Oh:e},c}return null},p.prototype.oi=function(a,b){if(this.id==a)return this;if(b)for(var c=0;c<this.hb.length;c++){var d=this.hb[c].oi(a,b);if(d)return d}return null},p.prototype.mk=function(a,b){if(this.pb==a)return this;if(b)for(var c=0;c<this.hb.length;c++){var d=this.hb[c].mk(a,b);if(d)return d}return null},p.prototype.qw=function(a){for(var b=0;b<this.lg.length;b++)if(this.lg[b].pb==a)return this.lg[b];return null},p.prototype.parse=function(a){var c;
this.id=a.getAttribute("id");this.pb=a.getAttribute("sid");this.name=a.getAttribute("name");this.type=a.getAttribute("type");this.type="JOINT"==this.type?this.type:"NODE";this.hb=[];this.lg=[];this.na=[];this.Pe=[];this.fb=[];this.controllers=[];this.ba=new b.K;for(var d=0;d<a.childNodes.length;d++)if(c=a.childNodes[d],1==c.nodeType)switch(c.nodeName){case "node":this.hb.push((new p).parse(c));break;case "instance_camera":this.Pe.push((new Z).parse(c));break;case "instance_light":this.fb.push((new S).parse(c));
break;case "instance_controller":this.controllers.push((new v).parse(c));break;case "instance_geometry":this.na.push((new u).parse(c));break;case "instance_node":c=c.getAttribute("url").replace(/^#/,"");(c=ea.evaluate(".//dae:library_nodes//dae:node[@id='"+c+"']",ea,G,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null).iterateNext())&&this.hb.push((new p).parse(c));break;case "rotate":case "translate":case "scale":case "matrix":case "lookat":case "skew":this.lg.push((new r).parse(c));break;case "extra":break;
default:console.log(c.nodeName)}a=[];d=1E6;c=-1E6;for(var e in Oa)for(var f=Oa[e],g=0;g<f.Mg.length;g++){var h=f.Mg[g],k=f.$c[g];e=h.target.split("/")[0];e==this.id&&(k.create(),h.$c=k,d=Math.min(d,k.startTime),c=Math.max(c,k.Te),a.push(h))}if((this.Hd=(a.length&&(this.startTime=d,this.Te=c),a))&&this.Hd.length){e=[];a=[];d=0;for(f=this.Hd.length;f>d;d++){var l=this.Hd[d],h=l.kq,k=l.$c,m=k.input,n=this.qw(l.pb);if(l.Oh){g=[];c=0;for(var q=l.Oh.length;q>c;c++){var D=l.Oh[c];-1<D&&3>D&&(D=pa(["X","Y",
"Z"][D]),D={PA:0,QA:1,RA:2}[D]);g[c]=D}}else g=pa(l.gh);if(n)for(-1===a.indexOf(h)&&a.push(h),c=0,q=m.length;q>c;c++){var D=m[c],l=k.getData(n.type,c),s;s=null;for(var t=0,w=e.length;w>t&&null==s;t++){var A=e[t];if(A.time===D)s=A;else if(A.time>D)break}if(!s){s=new y(D);t=-1;w=0;for(A=e.length;A>w&&-1==t;w++)e[w].time>=D&&(t=w);D=t;e.splice(-1==D?e.length:D,0,s)}s.Ep(h,n,g,l)}else console.log('Could not find transform "'+l.pb+'" in node '+this.id)}for(d=0;d<a.length;d++)for(f=a[d],c=0;c<e.length;c++)if(s=
e[c],!s.ri(f)){g=s;h=f;a:{k=c?c-1:0;for(k=0<=k?k:k+e.length;0<=k;k--)if(m=e[k],m.ri(h)){n=m;break a}n=null}a:{for(k=c+1;k<e.length;k++)if(m=e[k],m.ri(h)){q=m;break a}q=null}if(n&&q){k=void 0;m=(g.time-n.time)/(q.time-n.time);n=n.Tm(h);q=q.Tm(h).data;l=n.data;if("matrix"===n.type)k=l;else if(l.length)for(k=[],D=0;D<l.length;++D)k[D]=l[D]+(q[D]-l[D])*m;else k=l+(q-l)*m;g.Ep(h,n.transform,n.gh,k)}}this.keys=e;this.uh=a}return this.Nc(),this},p.prototype.Nc=function(){this.ba.Vc();for(var a=0;a<this.lg.length;a++)this.lg[a].apply(this.ba)},
r.prototype.parse=function(a){return this.pb=a.getAttribute("sid"),this.type=a.nodeName,this.data=na(a.textContent),this.rv(),this},r.prototype.rv=function(){switch(this.type){case "matrix":this.T=n(this.data);break;case "rotate":this.je=b.be.Rg(this.data[3]);case "translate":da(this.data,-1);this.T=new b.a(this.data[0],this.data[1],this.data[2]);break;case "scale":da(this.data,1);this.T=new b.a(this.data[0],this.data[1],this.data[2]);break;default:console.log("Can not convert Transform of type "+
this.type)}},r.prototype.apply=function(){var a=new b.K;return function(b){switch(this.type){case "matrix":b.multiply(this.T);break;case "translate":b.multiply(a.Ck(this.T.x,this.T.y,this.T.z));break;case "rotate":b.multiply(a.hn(this.T,this.je));break;case "scale":b.scale(this.T)}}}(),r.prototype.update=function(a,c){var d=["X","Y","Z","ANGLE"];switch(this.type){case "matrix":if(c)if(1===c.length)switch(c[0]){case 0:this.T.XE=a[0];this.T.aF=a[1];this.T.eF=a[2];this.T.iF=a[3];break;case 1:this.T.YE=
a[0];this.T.bF=a[1];this.T.fF=a[2];this.T.jF=a[3];break;case 2:this.T.ZE=a[0];this.T.cF=a[1];this.T.gF=a[2];this.T.kF=a[3];break;case 3:this.T.$E=a[0],this.T.dF=a[1],this.T.hF=a[2],this.T.lF=a[3]}else 2===c.length?this.T["n"+(c[0]+1)+(c[1]+1)]=a:console.log("Incorrect addressing of matrix in transform.");else this.T.copy(a);break;case "translate":case "scale":switch("[object Array]"===Object.prototype.toString.call(c)&&(c=d[c[0]]),c){case "X":this.T.x=a;break;case "Y":this.T.y=a;break;case "Z":this.T.z=
a;break;default:this.T.x=a[0],this.T.y=a[1],this.T.z=a[2]}break;case "rotate":switch("[object Array]"===Object.prototype.toString.call(c)&&(c=d[c[0]]),c){case "X":this.T.x=a;break;case "Y":this.T.y=a;break;case "Z":this.T.z=a;break;case "ANGLE":this.je=b.be.Rg(a);break;default:this.T.x=a[0],this.T.y=a[1],this.T.z=a[2],this.je=b.be.Rg(a[3])}}},v.prototype.parse=function(a){this.url=a.getAttribute("url").replace(/^#/,"");this.mf=[];this.Wc=[];for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];
if(1===c.nodeType)switch(c.nodeName){case "skeleton":this.mf.push(c.textContent.replace(/^#/,""));break;case "bind_material":if(c=ea.evaluate(".//dae:instance_material",c,G,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null))for(var d=c.iterateNext();d;)this.Wc.push((new w).parse(d)),d=c.iterateNext()}}return this},w.prototype.parse=function(a){return this.Zr=a.getAttribute("symbol"),this.target=a.getAttribute("target").replace(/^#/,""),this},u.prototype.parse=function(a){this.url=a.getAttribute("url").replace(/^#/,
"");this.Wc=[];for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType&&"bind_material"==c.nodeName){if(a=ea.evaluate(".//dae:instance_material",c,G,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null))for(b=a.iterateNext();b;)this.Wc.push((new w).parse(b)),b=a.iterateNext();break}}return this},s.prototype.parse=function(a){this.id=a.getAttribute("id");ha(this,a);for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];switch(c.nodeName){case "mesh":this.Ba=(new t(this)).parse(c)}}return this},
t.prototype.parse=function(a){this.Td=[];var c;for(c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];switch(d.nodeName){case "source":var e=d.getAttribute("id");void 0!=la[e]||(la[e]=(new L(e)).parse(d));break;case "vertices":this.c=(new I).parse(d);break;case "triangles":this.Td.push((new O).parse(d));break;case "polygons":this.Td.push((new A).parse(d));break;case "polylist":this.Td.push((new Q).parse(d))}}this.Kd=new b.H;a=la[this.c.input.qt.source].data;for(c=0;c<a.length;c+=3)this.Kd.c.push(Aa(a,
c).d());for(c=0;c<this.Td.length;c++)a=this.Td[c],a.ez(this.c),this.sw(a,this.Kd);return this.Kd.tb(),this.Kd.Yb(),this.Kd.Np&&(this.Kd.ne(),delete this.Kd.Np),this.Kd.Zh(),this},t.prototype.sw=function(a,c){var d,e,f,g,h,k,l,m=a.mh,n=a.Od,p=0,y=3,q=0,r=[];for(d=0;d<n.length;d++)switch(f=n[d],y=f.offset+1,q=y>q?y:q,f.rd){case "TEXCOORD":r.push(f.set)}for(var D=0;D<m.length;++D)for(var s=m[D],u=0;u<s.length;){var t=[],v=[],w=null,Z=[],y=a.qg?a.qg.length?a.qg[p++]:a.qg:s.length/q;for(d=0;y>d;d++)for(e=
0;e<n.length;e++)switch(f=n[e],k=la[f.source],g=s[u+d*q+f.offset],l=k.Dg.bg.length,h=g*l,f.rd){case "VERTEX":t.push(g);break;case "NORMAL":v.push(Aa(k.data,h));break;case "TEXCOORD":w=w||{};void 0===w[f.set]&&(w[f.set]=[]);w[f.set].push(new b.i(k.data[h],k.data[h+1]));break;case "COLOR":Z.push((new b.k).Wa(k.data[h],k.data[h+1],k.data[h+2]))}if(0==v.length)if(f=this.c.input.AA){k=la[f.source];l=k.Dg.bg.length;d=0;for(var G=t.length;G>d;d++)v.push(Aa(k.data,t[d]*l))}else c.Np=!0;if(!w&&(w={},f=this.c.input.LA))for(r.push(f.set),
k=la[f.source],l=k.Dg.bg.length,d=0,G=t.length;G>d;d++)h=t[d]*l,void 0===w[f.set]&&(w[f.set]=[]),w[f.set].push(new b.i(k.data[h],1-k.data[h+1]));if(0==Z.length&&(f=this.c.input.lA))for(k=la[f.source],l=k.Dg.bg.length,d=0,G=t.length;G>d;d++)h=t[d]*l,Z.push((new b.k).Wa(k.data[h],k.data[h+1],k.data[h+2]));e=null;h=[];if(3===y)h.push(new b.S(t[0],t[1],t[2],v,Z.length?Z:new b.k));else if(4===y)h.push(new b.qa(t[0],t[1],t[2],t[3],v,Z.length?Z:new b.k));else if(4<y&&$.Ez)for(d=Z.length?Z:new b.k,e=1;y-
1>e;)h.push(new b.S(t[0],t[e],t[e+1],[v[0],v[e++],v[e]],d));if(h.length)for(d=0,G=h.length;G>d;d++)for(e=h[d],e.xv=a.n,c.j.push(e),e=0;e<r.length;e++)t=w[r[e]],t=4<y?[t[0],t[d+1],t[d+2]]:4===y?[t[0],t[1],t[2],t[3]]:[t[0],t[1],t[2]],c.C[e]||(c.C[e]=[]),c.C[e].push(t);else console.log("dropped face with vcount "+y+" for geometry with id: "+c.id);u+=q*y}},A.prototype.ez=function(a){for(var b=0;b<this.Od.length;b++)this.Od[b].source==a.id&&(this.Od[b].source=a.input.qt.source)},A.prototype.parse=function(a){this.n=
a.getAttribute("material");this.count=ja(a,"count",0);for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];switch(c.nodeName){case "input":this.Od.push((new F).parse(a.childNodes[b]));break;case "vcount":this.qg=Ba(c.textContent);break;case "p":this.mh.push(Ba(c.textContent));break;case "ph":console.warn("polygon holes not yet supported!")}}return this},Q.prototype=Object.create(A.prototype),O.prototype=Object.create(A.prototype),P.prototype.parse=function(a){this.bg=[];this.source=a.getAttribute("source");
this.count=ja(a,"count",0);this.Xr=ja(a,"stride",0);for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if("param"==c.nodeName){var d={};d.name=c.getAttribute("name");d.type=c.getAttribute("type");this.bg.push(d)}}return this},I.prototype.parse=function(a){this.id=a.getAttribute("id");for(var b=0;b<a.childNodes.length;b++)if("input"==a.childNodes[b].nodeName){var c=(new F).parse(a.childNodes[b]);this.input[c.rd]=c}return this},F.prototype.parse=function(a){return this.rd=a.getAttribute("semantic"),
this.source=a.getAttribute("source").replace(/^#/,""),this.set=ja(a,"set",-1),this.offset=ja(a,"offset",0),"TEXCOORD"==this.rd&&0>this.set&&(this.set=0),this},L.prototype.parse=function(a){this.id=a.getAttribute("id");for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];switch(c.nodeName){case "bool_array":for(var d=wa(c.textContent),e=[],f=0,g=d.length;g>f;f++)e.push("true"==d[f]||"1"==d[f]?!0:!1);this.data=e;this.type=c.nodeName;break;case "float_array":this.data=na(c.textContent);this.type=
c.nodeName;break;case "int_array":this.data=Ba(c.textContent);this.type=c.nodeName;break;case "IDREF_array":case "Name_array":this.data=wa(c.textContent);this.type=c.nodeName;break;case "technique_common":for(d=0;d<c.childNodes.length;d++)if("accessor"==c.childNodes[d].nodeName){this.Dg=(new P).parse(c.childNodes[d]);break}}}return this},L.prototype.eg=function(){var a=[],b=this.Dg.bg[0];switch(b.type){case "IDREF":case "Name":case "name":case "float":return this.data;case "float4x4":for(b=0;b<this.data.length;b+=
16){var c=this.data.slice(b,b+16),c=n(c);a.push(c)}break;default:console.log("ColladaLoader: Source: Read dont know how to read "+b.type+".")}return a},K.prototype.parse=function(a){this.id=a.getAttribute("id");this.name=a.getAttribute("name");for(var b=0;b<a.childNodes.length;b++)if("instance_effect"==a.childNodes[b].nodeName){this.Aq=(new R).parse(a.childNodes[b]);break}return this},N.prototype.uD=function(){return null==this.La},N.prototype.isTexture=function(){return null!=this.La},N.prototype.parse=
function(a){for(var c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];if(1==d.nodeType)switch(d.nodeName){case "color":d=na(d.textContent);this.color=new b.k;this.color.Wa(d[0],d[1],d[2]);this.color.r=d[3];break;case "texture":this.La=d.getAttribute("texture"),this.Kz=d.getAttribute("texcoord"),this.Xd={Zx:0,$x:0,Ly:1,My:1,bA:1,cA:1},this.ly(d)}}return this},N.prototype.ly=function(a){if(!a.childNodes)return this;a.childNodes[1]&&"extra"===a.childNodes[1].nodeName&&(a=a.childNodes[1],a.childNodes[1]&&
"technique"===a.childNodes[1].nodeName&&(a=a.childNodes[1]));for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];switch(c.nodeName){case "offsetU":case "offsetV":case "repeatU":case "repeatV":this.Xd[c.nodeName]=parseFloat(c.textContent);break;case "wrapU":case "wrapV":this.Xd[c.nodeName]=parseInt(c.textContent);break;default:this.Xd[c.nodeName]=c.textContent}}return this},B.prototype.parse=function(a){for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case "ambient":case "emission":case "diffuse":case "specular":case "transparent":this[c.nodeName]=
(new N).parse(c);break;case "shininess":case "reflectivity":case "index_of_refraction":case "transparency":var d;d=ea.evaluate(".//dae:float",c,G,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null);for(var e=d.iterateNext(),f=[];e;)f.push(e),e=d.iterateNext();d=f;0<d.length&&(this[c.nodeName]=parseFloat(d[0].textContent))}}return this.create(),this},B.prototype.create=function(){var a={},c=void 0!==this.fo&&1>this.fo,d;for(d in this)switch(d){case "ambient":case "emission":case "diffuse":case "specular":var e=
this[d];if(e instanceof N)if(e.isTexture()){var f=this.ki.$c[e.La].source;f&&(f=va[this.ki.Yr[f].ti])&&(f=b.zd.gn(T+f.ti),f.pc=e.Xd.bA?b.ed:b.sf,f.qc=e.Xd.cA?b.ed:b.sf,f.offset.x=e.Xd.Zx,f.offset.y=e.Xd.$x,f.repeat.x=e.Xd.Ly,f.repeat.y=e.Xd.My,a.map=f,"emission"===d&&(a.Aa=16777215))}else"diffuse"!==d&&c||("emission"===d?a.Aa=e.color.nk():a[d]=e.color.nk());break;case "shininess":a[d]=this[d];break;case "reflectivity":a[d]=this[d];0<a[d]&&(a.pa=$.Tp);a.Uc=b.it;break;case "index_of_refraction":a.Zc=
this[d];1!==this[d]&&(a.pa=$.Tp);break;case "transparency":c&&(a.U=!0,a.opacity=this[d],c=!0)}switch(a.ua=La,a.Kc=this.ki.Se?b.dd:b.vg,this.type){case "constant":void 0!=a.Aa&&(a.color=a.Aa);this.n=new b.Za(a);break;case "phong":case "blinn":void 0!=a.Re&&(a.color=a.Re);this.n=new b.qb(a);break;default:void 0!=a.Re&&(a.color=a.Re),this.n=new b.hc(a)}return this.n},W.prototype.parse=function(a){for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case "init_from":this.ti=
c.textContent;break;case "format":this.ma=c.textContent;break;default:console.log("unhandled Surface prop: "+c.nodeName)}}return this},M.prototype.parse=function(a){for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case "source":this.source=c.textContent;break;case "minfilter":this.Jx=c.textContent;break;case "magfilter":this.rx=c.textContent;break;case "mipfilter":this.Kx=c.textContent;break;case "wrap_s":this.dA=c.textContent;break;case "wrap_t":this.eA=
c.textContent;break;default:console.log("unhandled Sampler2D prop: "+c.nodeName)}}return this},J.prototype.create=function(){return null==this.Sk?null:void 0},J.prototype.parse=function(a){this.id=a.getAttribute("id");this.name=a.getAttribute("name");ha(this,a);this.Sk=null;for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case "profile_COMMON":this.zn(this.ir(c))}}return this},J.prototype.jy=function(a){for(var b=a.getAttribute("sid"),c=0;c<a.childNodes.length;c++){var d=
a.childNodes[c];if(1==d.nodeType)switch(d.nodeName){case "surface":this.Yr[b]=(new W(this)).parse(d);break;case "sampler2D":this.$c[b]=(new M(this)).parse(d);break;case "extra":break;default:console.log(d.nodeName)}}},J.prototype.ir=function(a){for(var b,c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];if(1==d.nodeType)switch(d.nodeName){case "profile_COMMON":this.ir(d);break;case "technique":b=d;break;case "newparam":this.jy(d);break;case "image":d=(new h).parse(d);va[d.id]=d;break;case "extra":break;
default:console.log(d.nodeName)}}return b},J.prototype.zn=function(a){for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case "constant":case "lambert":case "blinn":case "phong":this.Sk=(new B(c.nodeName,this)).parse(c)}}},R.prototype.parse=function(a){return this.url=a.getAttribute("url").replace(/^#/,""),this},U.prototype.parse=function(a){this.id=a.getAttribute("id");this.name=a.getAttribute("name");this.source={};for(var b=0;b<a.childNodes.length;b++){var c=
a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case "animation":var c=(new U).parse(c),d;for(d in c.source)this.source[d]=c.source[d];for(var e=0;e<c.Mg.length;e++)this.Mg.push(c.Mg[e]),this.$c.push(c.$c[e]);break;case "source":d=(new L).parse(c);this.source[d.id]=d;break;case "sampler":this.$c.push((new C(this)).parse(c));break;case "channel":this.Mg.push((new Y(this)).parse(c))}}return this},Y.prototype.parse=function(a){this.source=a.getAttribute("source").replace(/^#/,"");this.target=a.getAttribute("target");
var b=this.target.split("/");b.shift();a=b.shift();var c=0<=a.indexOf("."),d=0<=a.indexOf("(");if(c)b=a.split("."),this.pb=b.shift(),this.gh=b.shift();else if(d){b=a.split("(");this.pb=b.shift();for(var e=0;e<b.length;e++)b[e]=parseInt(b[e].replace(/\)/,""));this.Oh=b}else this.pb=a;return this.kq=a,this.Wp=c,this.Ip=d,this},C.prototype.parse=function(a){this.id=a.getAttribute("id");this.Od=[];for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case "input":this.Od.push((new F).parse(c))}}return this},
C.prototype.create=function(){for(var a=0;a<this.Od.length;a++){var b=this.Od[a],c=this.Oj.source[b.source];switch(b.rd){case "INPUT":this.input=c.eg();break;case "OUTPUT":this.Fi=c.eg();this.kg=c.Dg.Xr;break;case "INTERPOLATION":this.Iw=c.eg();break;case "IN_TANGENT":break;case "OUT_TANGENT":break;default:console.log(b.rd)}}if(this.startTime=0,this.Te=0,this.duration=0,this.input.length){this.startTime=1E8;this.Te=-1E8;for(a=0;a<this.input.length;a++)this.startTime=Math.min(this.startTime,this.input[a]),
this.Te=Math.max(this.Te,this.input[a]);this.duration=this.Te-this.startTime}},C.prototype.getData=function(a,b){var c;if("matrix"===a&&16===this.kg)c=this.Fi[b];else if(1<this.kg){c=[];b*=this.kg;for(var d=0;d<this.kg;++d)c[d]=this.Fi[b+d];if(3===this.kg)switch(a){case "rotate":case "translate":da(c,-1);break;case "scale":da(c,1)}else 4===this.kg&&"matrix"===a&&da(c,-1)}else c=this.Fi[b];return c},y.prototype.Ep=function(a,b,c,d){this.mc.push({pb:a,gh:c,transform:b,data:d})},y.prototype.apply=function(a){for(var b=
0;b<this.mc.length;++b){var c=this.mc[b];a&&c.pb!==a||c.transform.update(c.data,c.gh)}},y.prototype.Tm=function(a){for(var b=0;b<this.mc.length;++b)if(this.mc[b].pb===a)return this.mc[b];return null},y.prototype.ri=function(a){for(var b=0;b<this.mc.length;++b)if(this.mc[b].pb===a)return!0;return!1},y.prototype.Fb=function(a,b){for(var c=0;c<this.mc.length;++c){var d,e=this.mc[c];d=a.Tm(e.pb);if("matrix"!==e.transform.type&&d){var f=(b-this.time)/(a.time-this.time),g=d.data,h=e.data;if((0>f||1<f)&&
(console.log("Key.interpolate: Warning! Scale out of bounds:"+f),f=0>f?0:1),h.length){d=[];for(var k=0;k<h.length;++k)d[k]=h[k]+(g[k]-h[k])*f}else d=h+(g-h)*f}else d=e.data;e.transform.update(d,e.gh)}},D.prototype.parse=function(a){this.id=a.getAttribute("id");this.name=a.getAttribute("name");for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case "optics":this.ky(c)}}return this},D.prototype.ky=function(a){for(var b=0;b<a.childNodes.length;b++)if("technique_common"==
a.childNodes[b].nodeName)for(var c=a.childNodes[b],d=0;d<c.childNodes.length;d++)if(this.wh=c.childNodes[d].nodeName,"perspective"==this.wh)for(var e=c.childNodes[d],f=0;f<e.childNodes.length;f++){var g=e.childNodes[f];switch(g.nodeName){case "yfov":this.VH=g.textContent;break;case "xfov":this.RH=g.textContent;break;case "znear":this.Es=g.textContent;break;case "zfar":this.Ds=g.textContent;break;case "aspect_ratio":this.Jp=g.textContent}}else if("orthographic"==this.wh)for(e=c.childNodes[d],f=0;f<
e.childNodes.length;f++)switch(g=e.childNodes[f],g.nodeName){case "xmag":this.SH=g.textContent;break;case "ymag":this.WH=g.textContent;break;case "znear":this.Es=g.textContent;break;case "zfar":this.Ds=g.textContent;break;case "aspect_ratio":this.Jp=g.textContent}return this},Z.prototype.parse=function(a){return this.url=a.getAttribute("url").replace(/^#/,""),this},ma.prototype.parse=function(a){this.id=a.getAttribute("id");this.name=a.getAttribute("name");for(var b=0;b<a.childNodes.length;b++){var c=
a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case "technique_common":this.zn(c)}}return this},ma.prototype.zn=function(a){for(var c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];switch(d.nodeName){case "ambient":case "point":case "directional":this.wh=d.nodeName;for(var e=0;e<d.childNodes.length;e++){var f=d.childNodes[e];switch(f.nodeName){case "color":f=(new b.a).kk(na(f.textContent)),this.color=(new b.k).Wa(f.x,f.y,f.z)}}}}},S.prototype.parse=function(a){return this.url=a.getAttribute("url").replace(/^#/,
""),this},{load:function(b,c,d){var e=0;if(document.implementation&&document.implementation.createDocument){var f=new XMLHttpRequest;f.onreadystatechange=function(){if(4==f.readyState){if(0==f.status||200==f.status)if(f.responseXML)$a=c,a(f.responseXML,void 0,b);else if(f.responseText){$a=c;var g=(new DOMParser).parseFromString(f.responseText,"application/xml");a(g,void 0,b)}else console.error("ColladaLoader: Empty or non-existing file ("+b+")")}else 3==f.readyState&&d&&(0==e&&(e=f.getResponseHeader("Content-Length")),
d({total:e,loaded:f.responseText.length}))};f.open("GET",b,!0);f.send(null)}else alert("Don't know how to parse XML!")},parse:a,GG:function(a){La=a},cB:f,na:Pa,options:$}};!function(){function a(b,c,d,e){if(b===c)return 0!==b||1/b==1/c;if(null==b||null==c)return b===c;b instanceof g&&(b=b.Cg);c instanceof g&&(c=c.Cg);var f=w.call(b);if(f!=w.call(c))return!1;switch(f){case "[object String]":return b==String(c);case "[object Number]":return b!=+b?c!=+c:0==b?1/b==1/c:b==+c;case "[object Date]":case "[object Boolean]":return+b==
+c;case "[object RegExp]":return b.source==c.source&&b.global==c.global&&b.multiline==c.multiline&&b.ignoreCase==c.ignoreCase}if("object"!=typeof b||"object"!=typeof c)return!1;for(var h=d.length;h--;)if(d[h]==b)return e[h]==c;var h=b.constructor,k=c.constructor;if(h!==k&&!(g.Ze(h)&&h instanceof h&&g.Ze(k)&&k instanceof k))return!1;d.push(b);e.push(c);h=0;k=!0;if("[object Array]"==f){if(h=b.length,k=h==c.length)for(;h--&&(k=a(b[h],c[h],d,e)););}else{for(var l in b)if(g.kc(b,l)&&(h++,!(k=g.kc(c,l)&&
a(b[l],c[l],d,e))))break;if(k){for(l in c)if(g.kc(c,l)&&!h--)break;k=!h}}return d.pop(),e.pop(),k}function b(){}function c(a,b,d){return b&&g.every(a,g.isArray)?v.apply(d,a):(B(a,function(a){g.isArray(a)||g.Dq(a)?b?p.apply(d,a):c(a,b,d):d.push(a)}),d)}function d(a,b,c,d){var e={},h=f(null==b?g.Vc:b);return B(a,function(b,f){var g=h.call(c,b,f,a);d(e,g,b)}),e}function f(a){return g.Ze(a)?a:function(b){return b[a]}}function g(a){return a instanceof g?a:this instanceof g?(this.Cg=a,void 0):new g(a)}
var h=this,k=h.Ml,l={},m=Array.prototype,q=Object.prototype,p=m.push,r=m.slice,v=m.concat,w=q.toString,u=q.hasOwnProperty,s=m.forEach,t=m.map,A=m.reduce,Q=m.reduceRight,O=m.filter,P=m.every,I=m.some,F=m.indexOf,L=m.lastIndexOf,q=Array.isArray,K=Object.keys,N=Function.prototype.bind;"undefined"!=typeof exports?("undefined"!=typeof module&&module.Ov&&(exports=module.Ov=g),exports.Ml=g):h.Ml=g;g.VERSION="1.5.1";var B=g.Hv=g.forEach=function(a,b,c){if(null!=a)if(s&&a.forEach===s)a.forEach(b,c);else if(a.length===
+a.length)for(var d=0,e=a.length;e>d&&b.call(c,a[d],d,a)!==l;d++);else for(d in a)if(g.kc(a,d)&&b.call(c,a[d],d,a)===l)break};g.map=g.IB=function(a,b,c){var d=[];return null==a?d:t&&a.map===t?a.map(b,c):(B(a,function(a,e,f){d.push(b.call(c,a,e,f))}),d)};g.reduce=g.MC=g.pD=function(a,b,c,d){var e=2<arguments.length;if(null==a&&(a=[]),A&&a.reduce===A)return d&&(b=g.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(B(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError("Reduce of empty array with no initial value");
return c};g.reduceRight=g.NC=function(a,b,c,d){var e=2<arguments.length;if(null==a&&(a=[]),Q&&a.reduceRight===Q)return d&&(b=g.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=a.length;if(f!==+f)var h=g.keys(a),f=h.length;if(B(a,function(g,k,l){k=h?h[--f]:--f;e?c=b.call(d,c,a[k],k,l):(c=a[k],e=!0)}),!e)throw new TypeError("Reduce of empty array with no initial value");return c};g.find=g.sC=function(a,b,c){var d;return W(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0}),d};g.filter=
g.select=function(a,b,c){var d=[];return null==a?d:O&&a.filter===O?a.filter(b,c):(B(a,function(a,e,f){b.call(c,a,e,f)&&d.push(a)}),d)};g.iG=function(a,b,c){return g.filter(a,function(a,d,e){return!b.call(c,a,d,e)},c)};g.every=g.all=function(a,b,c){b||(b=g.Vc);var d=!0;return null==a?d:P&&a.every===P?a.every(b,c):(B(a,function(a,e,f){return(d=d&&b.call(c,a,e,f))?void 0:l}),!!d)};var W=g.some=g.aB=function(a,b,c){b||(b=g.Vc);var d=!1;return null==a?d:I&&a.some===I?a.some(b,c):(B(a,function(a,e,f){return d||
(d=b.call(c,a,e,f))?l:void 0}),!!d)};g.contains=g.kD=function(a,b){return null==a?!1:F&&a.indexOf===F?-1!=a.indexOf(b):W(a,function(a){return a===b})};g.sD=function(a,b){var c=r.call(arguments,2),d=g.Ze(b);return g.map(a,function(a){return(d?b:a[b]).apply(a,c)})};g.Cn=function(a,b){return g.map(a,function(a){return a[b]})};g.aA=function(a,b){return g.Ym(b)?void 0:g.find(a,function(a){for(var c in b)if(b[c]!==a[c])return!1;return!0})};g.IC=function(a,b){return g.aA(a,b)};g.max=function(a,b,c){if(!b&&
g.isArray(a)&&a[0]===+a[0]&&65535>a.length)return Math.max.apply(Math,a);if(!b&&g.Ym(a))return-1/0;var d={ai:-1/0,value:-1/0};return B(a,function(a,e,f){e=b?b.call(c,a,e,f):a;e>d.ai&&(d={value:a,ai:e})}),d.value};g.min=function(a,b,c){if(!b&&g.isArray(a)&&a[0]===+a[0]&&65535>a.length)return Math.min.apply(Math,a);if(!b&&g.Ym(a))return 1/0;var d={ai:1/0,value:1/0};return B(a,function(a,e,f){e=b?b.call(c,a,e,f):a;e<d.ai&&(d={value:a,ai:e})}),d.value};g.KG=function(a){var b,c=0,d=[];return B(a,function(a){b=
g.random(c++);d[c-1]=d[b];d[b]=a}),d};g.WG=function(a,b,c){var d=f(b);return g.Cn(g.map(a,function(a,b,e){return{value:a,index:b,Rp:d.call(c,a,b,e)}}).sort(function(a,b){var c=a.Rp,d=b.Rp;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index<b.index?-1:1}),"value")};g.fD=function(a,b,c){return d(a,b,c,function(a,b,c){(g.kc(a,b)?a[b]:a[b]=[]).push(c)})};g.OB=function(a,b,c){return d(a,b,c,function(a,b){g.kc(a,b)||(a[b]=0);a[b]++})};g.qz=function(a,b){var c;c=null==c?g.Vc:
f(c);for(var d=c.call(void 0,b),e=0,h=a.length;h>e;){var k=e+h>>>1;c.call(void 0,a[k])<d?e=k+1:h=k}return e};g.fl=function(a){return a?g.isArray(a)?r.call(a):a.length===+a.length?g.map(a,g.Vc):g.Yz(a):[]};g.size=function(a){return null==a?0:a.length===+a.length?a.length:g.keys(a).length};g.KC=g.head=g.hH=function(a,b,c){return null==a?void 0:null==b||c?a[0]:r.call(a,0,b)};g.oD=function(a,b,c){return r.call(a,0,a.length-(null==b||c?1:b))};g.GD=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-
1]:r.call(a,Math.max(a.length-b,0))};g.nG=g.gH=g.yC=function(a,b,c){return r.call(a,null==b||c?1:b)};g.compact=function(a){return g.filter(a,g.Vc)};g.Yv=function(a){return c(a,!0,[])};g.QH=function(a){return g.Cv(a,r.call(arguments,1))};g.ws=g.unique=function(a,b,c,d){g.Ze(b)&&(d=c,c=b,b=!1);c=c?g.map(a,c,d):a;var e=[],f=[];return B(c,function(c,d){(b?d&&f[f.length-1]===c:g.contains(f,c))||(f.push(c),e.push(a[d]))}),e};g.io=function(){return g.ws(g.Yv(arguments))};g.qD=function(a){var b=r.call(arguments,
1);return g.filter(g.ws(a),function(a){return g.every(b,function(b){return 0<=g.indexOf(b,a)})})};g.Cv=function(a){var b=v.apply(m,r.call(arguments,1));return g.filter(a,function(a){return!g.contains(b,a)})};g.XH=function(){for(var a=g.max(g.Cn(arguments,"length").concat(0)),b=Array(a),c=0;a>c;c++)b[c]=g.Cn(arguments,""+c);return b};g.object=function(a,b){if(null==a)return{};for(var c={},d=0,e=a.length;e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c};g.indexOf=function(a,b,c){if(null==a)return-1;
var d=0,e=a.length;if(c){if("number"!=typeof c)return d=g.qz(a,b),a[d]===b?d:-1;d=0>c?Math.max(0,e+c):c}if(F&&a.indexOf===F)return a.indexOf(b,c);for(;e>d;d++)if(a[d]===b)return d;return-1};g.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=null!=c;if(L&&a.lastIndexOf===L)return d?a.lastIndexOf(b,c):a.lastIndexOf(b);for(c=d?c:a.length;c--;)if(a[c]===b)return c;return-1};g.gG=function(a,b,c){1>=arguments.length&&(b=a||0,a=0);c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=Array(d);d>
e;)f[e++]=a,a+=c;return f};g.bind=function(a,c){var d,f;if(N&&a.bind===N)return N.apply(a,r.call(arguments,1));if(!g.Ze(a))throw new TypeError;return d=r.call(arguments,2),f=function(){if(!(this instanceof f))return a.apply(c,d.concat(r.call(arguments)));b.prototype=a.prototype;var g=new b;b.prototype=null;var h=a.apply(g,d.concat(r.call(arguments)));return Object(h)===h?h:g}};g.JF=function(a){var b=r.call(arguments,1);return function(){return a.apply(this,b.concat(r.call(arguments)))}};g.mB=function(a){var b=
r.call(arguments,1);if(0===b.length)throw Error("bindAll must be passed function names");return B(b,function(b){a[b]=g.bind(a[b],a)}),a};g.NE=function(a,b){var c={};return b||(b=g.Vc),function(){var d=b.apply(this,arguments);return g.kc(c,d)?c[d]:c[d]=a.apply(this,arguments)}};g.zv=function(a,b){var c=r.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)};g.defer=function(a){return g.zv.apply(g,[a,1].concat(r.call(arguments,1)))};g.qH=function(a,b,c){function d(){k=!1===c.Xw?
0:new Date;h=null;g=a.apply(e,f)}var e,f,g,h=null,k=0;c||(c={});return function(){var l=new Date;k||!1!==c.Xw||(k=l);var m=b-(l-k);return e=this,f=arguments,0>=m?(clearTimeout(h),h=null,k=l,g=a.apply(e,f)):h||!1===c.xH||(h=setTimeout(d,m)),g}};g.pC=function(a,b,c){var d,e=null;return function(){var f=this,g=arguments,h=c&&!e;return clearTimeout(e),e=setTimeout(function(){e=null;c||(d=a.apply(f,g))},b),h&&(d=a.apply(f,g)),d}};g.gr=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,
arguments),a=null,b)}};g.ij=function(a,b){return function(){var c=[a];return p.apply(c,arguments),b.apply(this,c)}};g.pv=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;0<=c;c--)b=[a[c].apply(this,b)];return b[0]}};g.YA=function(a,b){return function(){return 1>--a?b.apply(this,arguments):void 0}};g.keys=K||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[],c;for(c in a)g.kc(a,c)&&b.push(c);return b};g.Yz=function(a){var b=[],c;for(c in a)g.kc(a,
c)&&b.push(a[c]);return b};g.DF=function(a){var b=[],c;for(c in a)g.kc(a,c)&&b.push([c,a[c]]);return b};g.Jw=function(a){var b={},c;for(c in a)g.kc(a,c)&&(b[a[c]]=c);return b};g.dw=g.OE=function(a){var b=[],c;for(c in a)g.Ze(a[c])&&b.push(c);return b.sort()};g.extend=function(a){return B(r.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a};g.QF=function(a){var b={},c=v.apply(m,r.call(arguments,1));return B(c,function(c){c in a&&(b[c]=a[c])}),b};g.uF=function(a){var b={},c=v.apply(m,
r.call(arguments,1)),d;for(d in a)g.contains(c,d)||(b[d]=a[d]);return b};g.fi=function(a){return B(r.call(arguments,1),function(b){if(b)for(var c in b)void 0===a[c]&&(a[c]=b[c])}),a};g.d=function(a){return g.Nw(a)?g.isArray(a)?a.slice():g.extend({},a):a};g.jH=function(a,b){return b(a),a};g.isEqual=function(b,c){return a(b,c,[],[])};g.Ym=function(a){if(null==a)return!0;if(g.isArray(a)||g.BD(a))return 0===a.length;for(var b in a)if(g.kc(a,b))return!1;return!0};g.vD=function(a){return!(!a||1!==a.nodeType)};
g.isArray=q||function(a){return"[object Array]"==w.call(a)};g.Nw=function(a){return a===Object(a)};B("Arguments Function String Number Date RegExp".split(" "),function(a){g["is"+a]=function(b){return w.call(b)=="[object "+a+"]"}});g.Dq(arguments)||(g.Dq=function(a){return!(!a||!g.kc(a,"callee"))});"function"!=typeof/./&&(g.Ze=function(a){return"function"==typeof a});g.wD=function(a){return isFinite(a)&&!isNaN(parseFloat(a))};g.xD=function(a){return g.zD(a)&&a!=+a};g.tD=function(a){return!0===a||!1===
a||"[object Boolean]"==w.call(a)};g.yD=function(a){return null===a};g.CD=function(a){return void 0===a};g.kc=function(a,b){return u.call(a,b)};g.oF=function(){return h.Ml=k,this};g.Vc=function(a){return a};g.rH=function(a,b,c){for(var d=Array(Math.max(0,a)),e=0;a>e;e++)d[e]=b.call(c,e);return d};g.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))};var M={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};M.unescape=g.Jw(M.escape);var J=
{escape:RegExp("["+g.keys(M.escape).join("")+"]","g"),unescape:RegExp("("+g.keys(M.unescape).join("|")+")","g")};g.Hv(["escape","unescape"],function(a){g[a]=function(b){return null==b?"":(""+b).replace(J[a],function(b){return M[a][b]})}});g.result=function(a,b){if(null!=a){var c=a[b];return g.Ze(c)?c.call(a):c}};g.Mx=function(a){B(g.dw(a),function(b){var c=g[b]=a[b];g.prototype[b]=function(){var a=[this.Cg];p.apply(a,arguments);a=c.apply(g,a);return this.Vl?g(a).Sh():a}})};var R=0;g.EH=function(a){var b=
++R+"";return a?a+b:b};g.Jz={evaluate:/<%([\s\S]+?)%>/g,Fb:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var U=/(.)^/,Y={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},C=/\\|'|\r|\n|\t|\u2028|\u2029/g;g.mH=function(a,b,c){function d(a){return e.call(this,a,g)}var e;c=g.fi({},c,g.Jz);var f=0,h="__p+='";a.replace(RegExp([(c.escape||U).source,(c.Fb||U).source,(c.evaluate||U).source].join("|")+"|$","g"),function(b,c,d,e,g){return h+=a.slice(f,g).replace(C,function(a){return"\\"+
Y[a]}),c&&(h+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'"),d&&(h+="'+\n((__t=("+d+"))==null?'':__t)+\n'"),e&&(h+="';\n"+e+"\n__p+='"),f=g+b.length,b});h+="';\n";c.As||(h="with(obj||{}){\n"+h+"}\n");h="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+h+"return __p;\n";try{e=new Function(c.As||"obj","_",h)}catch(k){throw k.source=h,k;}return b?e(b,g):(d.source="function("+(c.As||"obj")+"){\n"+h+"}",d)};g.Sh=function(a){return g(a).Sh()};g.Mx(g);B("pop push reverse shift sort splice unshift".split(" "),
function(a){var b=m[a];g.prototype[a]=function(){var c=this.Cg;return b.apply(c,arguments),"shift"!=a&&"splice"!=a||0!==c.length||delete c[0],this.Vl?g(c).Sh():c}});B(["concat","join","slice"],function(a){var b=m[a];g.prototype[a]=function(){var a=b.apply(this.Cg,arguments);return this.Vl?g(a).Sh():a}});g.extend(g.prototype,{Sh:function(){return this.Vl=!0,this},value:cc("Cg")})}.call(this);var Vb;Vb=function(a,b){function c(){this.constructor=d}var d,f=this;d=a&&_.kc(a,"constructor")?a.constructor:
function(){return f.apply(this,arguments)};_.extend(d,f,b);return c.prototype=f.prototype,d.prototype=new c,a&&_.extend(d.prototype,a),d.SA=f.prototype,d};var ha={ur:1,Gq:{fH:9},Vw:["tab"],controls:{MA:"r",tA:"f",Bo:"a",Qo:"d",Ro:"q",So:"e",vo:"w",po:"s",JA:"t",kA:"y",KA:"u"},Vu:!0,AE:10,xi:{ld:{background:{ko:!1,lo:!0},Zq:{ko:!0,lo:!0},OC:{ko:!0,lo:!0}},bn:["background","middleground","foreground"],kd:75,Ia:5E4},Nu:{Vf:["../../res/models/rocket.dae"],ka:"../../res/textures/universe_sml_darker.jpg ../../res/textures/universe.jpg ../../res/textures/universe4.jpg ../../res/textures/universe4_lrg.jpg ../../res/textures/universe4_sml.jpg ../../res/textures/booster.jpg ../../res/textures/jupiter.jpg ../../res/textures/io.jpg ../../res/textures/europa.jpg ../../res/textures/sun.jpg ../../res/textures/atmosphere1.jpg ../../res/textures/smokeparticle.png ../../res/textures/star.png ../../res/textures/plasmaBullet.png ../../res/textures/plasmaBullet.jpg ../../res/textures/lensflares/lensflare0.png ../../res/textures/lensflares/lensflare1.png ../../res/textures/lensflares/lensflare2.png ../../res/textures/lensflares/lensflare3.png".split(" "),
parent:document.body},ld:{background:{dj:{$n:2E3,width:4096,height:4096,depth:4096,color:16777215,size:20,Bi:50,La:"../../res/textures/star.png"},Bn:{position:new b.a(0,0,-600),scale:0.0050,py:"../../res/textures/jupiter.jpg",Ou:"../../res/textures/atmosphere1.jpg",nz:"../../res/textures/io.jpg",Ww:"../../res/textures/europa.jpg"},Vr:{Q:4096,Uy:32,Ty:32,La:"../../res/textures/universe_sml_darker.jpg"},cl:{position:new b.a(-2E3,0,0),Fz:"../../res/textures/sun.jpg",Uv:"../../res/textures/lensflares/lensflare0.png",
Vv:"../../res/textures/lensflares/lensflare1.png",Wv:"../../res/textures/lensflares/lensflare2.png",Xv:"../../res/textures/lensflares/lensflare3.png"}},Zq:{dj:{$n:2E5,size:50,La:"../../res/textures/star.png"}}},Ic:{Hm:{mb:3,Uh:new b.k("white"),Th:new b.k("blue"),lh:1,kh:0,La:"../../res/textures/smokeparticle.png"},qd:{mb:1,Uh:new b.k("white"),Th:new b.k("green"),lh:1,kh:0,La:"../../res/textures/smokeparticle.png"},pd:{mb:2,Uh:new b.k("red"),Th:new b.k("yellow"),lh:1,kh:0,La:"../../res/textures/smokeparticle.png",
IH:0}},Gi:{Hm:{type:"cube",cg:100,size:20,aj:10,vh:20},qd:{cg:50,dm:new b.a(20,20,20),aj:8,Cc:0},pd:{Q:1,speed:250,al:0,cg:50,size:500,aj:0,vh:200,Vg:0.1,Cc:0,type:"sphere"}},hj:{qd:{acceleration:5,Rb:1E3,nn:1500,Om:1,af:0.07,mb:10,uk:1,Ek:"../../res/models/rocket.dae"}},IG:{Ek:"../../res/models/crosswing6-recentered.dae",scale:0.1,HH:!0},DC:{La:"../../res/textures/booster.jpg",Ey:100,Dy:300,height:4E3,Ud:16,Md:1,fy:!0},qy:{qF:1E4,size:100,La:null,speed:5E3,WF:10,mb:5}};dc.prototype={ju:function(){var a=
(this.hd,document.createElement("div")),b=(document.createElement("div"),document.createElement("p")),c=document.createElement("div"),d=document.createElement("div");a.className="loaderWrapper";b.className="assetCounter";c.className="progressWrapper";d.className="progressBar";c.appendChild(d);a.appendChild(b);a.appendChild(c);this.hd.appendChild(a);this.elements={};this.elements.Kp=b;this.elements.mr=d},gx:function(){function a(){var h=d[f],k=c[f];++f;f===g?b.options.ak.hl("ASSET_LOADER:allLoaded",
b.loaded):k&&k.length?setTimeout(function(){h.call(b,a)},250):a()}var b=this,c=[this.options.Vf,this.options.images,this.options.ka,this.options.iq,this.options.Wr],d=[this.kx,this.jx,this.nx,this.ix,this.lx],f=0,g=c.length;a()},kx:function(a){function b(k){d.elements.Kp.innerHTML="<span>Loading models...</span><span>"+f+"/"+g+"</span>";++f;d.lv.load(k,function(h){var m=h.Ea;h=h.mz[0];m.Nc();d.loaded.Vf[k]={wm:m,ad:h};g>f?setTimeout(function(){b(c[f])},50):"function"==typeof a?a():"function"==typeof d.options.dy&&
d.options.ak.hl("ASSET_LOADER:modelsLoaded",d.loaded.Vf);h=null},function(a){h.style.width=100/+a.total*a.loaded+"%"})}var c=this.options.Vf,d=this,f=0,g=c.length,h=d.elements.mr;b(c[f])},jx:Ia(),nx:function(a){function e(k){d.elements.Kp.innerHTML="<span>Loading textures...</span><span>"+f+"/"+g+"</span>";++f;b.zd.gn(k,h,function(b){d.loaded.ka[k]=b;g>f?setTimeout(function(){e(c[f])},50):"function"==typeof a?a():"function"==typeof d.ey&&d.options.ak.hl("ASSET_LOADER:texturesLoaded",d.loaded.ka)})}
var c=this.options.ka,d=this,f=0,g=c.length,h=(d.elements.mr,{});e(c[f])},ix:Ia(),lx:Ia()};(function(){function a(a,b){var c,d=-1,e=a.length,m=b[0],q=b[1],p=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).Lf.call(c.bi);break;case 1:for(;++d<e;)(c=a[d]).Lf.call(c.bi,m);break;case 2:for(;++d<e;)(c=a[d]).Lf.call(c.bi,m,q);break;case 3:for(;++d<e;)(c=a[d]).Lf.call(c.bi,m,q,p);break;default:for(;++d<e;)(c=a[d]).Lf.apply(c.bi,b)}}function b(a,c,e,k){if(!e)return!0;if("object"==typeof e){for(var l in e)a[c].apply(a,
[l,e[l]].concat(k));return!1}if(d.test(e)){e=e.split(d);l=0;for(var m=e.length;m>l;l++)a[c].apply(a,[e[l]].concat(k));return!1}return!0}var c=Array.prototype.slice,d=/\s+/;window.wA={xn:function(a,c,d){if(!b(this,"on",a,[c,d])||!c)return this;this.Sc||(this.Sc={});return(this.Sc[a]||(this.Sc[a]=[])).push({Lf:c,Mf:d,bi:d||this}),this},gr:function(a,c,d){if(!b(this,"once",a,[c,d])||!c)return this;var k=this,l=_.gr(function(){k.er(a,l);c.apply(this,arguments)});return l.cu=c,this.xn(a,l,d)},er:function(a,
c,d){var k,l,m,q,p,r,v,w;if(!this.Sc||!b(this,"off",a,[c,d]))return this;if(!a&&!c&&!d)return this.Sc={},this;q=a?[a]:_.keys(this.Sc);p=0;for(r=q.length;r>p;p++)if(a=q[p],m=this.Sc[a]){if(this.Sc[a]=k=[],c||d)for(v=0,w=m.length;w>v;v++)l=m[v],(c&&c!==l.Lf&&c!==l.Lf.cu||d&&d!==l.Mf)&&k.push(l);k.length||delete this.Sc[a]}return this},hl:function(d){if(!this.Sc)return this;var g=c.call(arguments,1);if(!b(this,"trigger",d,g))return this;var h=this.Sc[d],k=this.Sc.all;return h&&a(h,g),k&&a(k,arguments),
this},$G:function(a,b,c){var d=this.Ed;if(!d)return this;var e=!b&&!c;"object"==typeof b&&(c=this);a&&((d={})[a.TA]=a);for(var m in d)d[m].er(b,c,this),e&&delete this.Ed[m];return this}}})();Mb.prototype={lu:function(){var a={};a.rc=document.createElement("div");a.rc.className="hud-primaryWeaponIndicator";a.ve=document.createElement("div");a.ve.textContent="Pulse Cannon";a.ve.className="hud-weapon hud-one active";a.we=document.createElement("div");a.we.textContent="Plasma Cannon";a.we.className="hud-weapon hud-two";
a.rc.appendChild(a.ve);a.rc.appendChild(a.we);a.hj=[a.ve,a.we];this.elements.rc.appendChild(a.rc);this.elements.Ay=a},nu:function(){var a={};a.rc=document.createElement("div");a.rc.className="hud-secondaryWeaponIndicator";a.ve=document.createElement("div");a.ve.textContent="Sidewinder";a.ve.className="hud-weapon hud-one active";a.we=document.createElement("div");a.we.textContent="Hellfire";a.we.className="hud-weapon hud-two";a.rc.appendChild(a.ve);a.rc.appendChild(a.we);a.hj=[a.ve,a.we];this.elements.rc.appendChild(a.rc);
this.elements.Sy=a},gu:function(){var a=this.elements;a.rc=document.createElement("div");a.rc.className="hud-wrapper";this.lu();this.nu()},hm:function(){document.body.appendChild(this.elements.rc)},Ar:function(a){a="primary"===a?this.elements.Ay.hj:this.elements.Sy.hj;for(var b=0;2>b;++b)a[b].classList.toggle("active")}};Nb.prototype={sp:function(){var a=this.options.xi,b;for(b in this.da)a.Eu(this.name,this.da[b]);for(b in this.jh)a.Bp(this.name,this.jh[b])},tp:function(){this.options.tr.Dp(this.ib)},
au:function(){for(var a in this.Ic)this.options.xi.Bp(this.name,this.Ic[a].Ba)}};Nb.extend=Vb;var Wc=Nb.extend({name:"background",da:{},jh:{},Xe:function(){this.ib=this.ib.bind(this);this.Zl();this.sp();this.tp()},Zl:function(){var a=this.da,e=this.jh;a.Vr=new mc(ha.ld.background.Vr);a.dj=new uc(ha.ld.background.dj);a.Bn=new kc(ha.ld.background.Bn);a.cl=new lc(ha.ld.background.cl);e.ao=new b.Ib(16776870,1);e.ao.position=ha.ld.background.cl.position},ib:function(a){this.da.Bn.ib(a)}}),Xc=Nb.extend({name:"middleground",
da:{},jh:{},Ic:{},Gi:{},Xe:function(){this.ib=this.ib.bind(this);this.ku();this.iu();this.Zl();this.sp();this.au();this.tp();var a=this;document.addEventListener("mousedown",function(){a.da.qd.fq("host",bc.Rm("middleground").Cb,a.jh.is)},!1)},ku:function(){var a=this.Ic;a.Hm=new Hb(ha.Ic.Hm);a.qd=new Hb(ha.Ic.qd);a.pd=new Hb(ha.Ic.pd)},iu:function(){var a;a=this.Gi;var b=this.Ic;a.pd=new Nc(ec,ha.Gi.pd);a=a.pd.ow();for(var c=0;c<a.length;++c)b.pd.Ap(a[c])},Zl:function(){var a=this.da,e=this.jh;a.dj=
new uc(ha.ld.Zq.dj);a.qd=new kb(_.extend({An:this.Ic.qd,EC:this.Ic.pd},ha.hj.qd));e.is=new b.J(new b.rl(100,100,100));e.is.position.set(-1E3,2E3,1E3);e.ao=new b.Ib(16776870,3);e.ao.position.copy(ha.ld.background.cl.position)},Qz:function(a,b,c,d){var f=this.Gi.pd,g=f.get();g&&(g.position.set(b,c,d),g.Cc=1,setTimeout(function(){f.Iy(g)},ha.Ic.pd.mb+100))},ib:function(a){this.da.qd.ib(a);this.Ic.qd.ib();this.Ic.pd.ib()}});ec.prototype={bm:function(a){var b=this.Fn;"cube"===this.type&&0===b.x&&0===b.y&&
0===b.z||"sphere"===this.type&&0===this.Q?a.copy(this.position):"cube"===this.type?this.xp(a,this.position,b):"sphere"===this.type&&this.qu(a,this.position,this.Q)},xp:function(a,b,c){a.copy(b);a.x+=Math.random()*c.x-c.x/2;a.y+=Math.random()*c.y-c.y/2;a.z+=Math.random()*c.z-c.z/2},qu:function(a,b,c){var d=2*Math.random()-1,f=6.2832*Math.random(),g=Math.sqrt(1-d*d),h=g*Math.cos(f)*c+b.x,f=g*Math.sin(f)*c+b.y,d=d*c+b.z;a.set(h,f,d)},ib:function(a){var b=this.attributes,c=b.Cc.value,d=b.sb.value,b=(b.Rb.value,
this.Cs),f=b+this.$f,g=this.Hy,h=this.cg,k=this.mb,l=this.sb;g.length=0;for(var m=b;f>m;++m)1===c[m]&&(d[m]+=a),d[m]>=k&&(d[m]=0,c[m]=0,g.push(m));if(!this.Cc){if(g.length)for(m=0;m<g.length;++m)this.bm(this.c[g[m]]);return this.sb=0,void 0}if("number"==typeof this.Vg&&this.sb>this.Vg)return this.Cc=0,void 0;if(l<=this.mb)for(d=b+Math.round(h*l),h=b+Math.round(h*(l+a)),h>b+this.$f&&(h=b+this.$f),m=d;h>m;m++)c[m]=1,this.bm(this.c[m]);for(m=0;m<g.length;++m)c[g[m]]=1,this.bm(this.c[g[m]]);this.sb+=
a}};Hb.prototype={du:function(){this.l=new b.H},eu:function(){this.n=new b.Ra({N:this.N,attributes:this.attributes,O:Hb.Lr.ll,L:Hb.Lr.bw,Ha:b.yb,U:this.U,Dc:this.Dc,Gc:this.Gc,Db:this.Db})},fu:function(){this.Ba=new b.Tb(this.l,this.n);this.Ba.ji=!0},am:function(a,e){var c=new b.a;return c.copy(a),c.x+=Math.random()*e.x-e.x/2,c.y+=Math.random()*e.y-e.y/2,c.z+=Math.random()*e.z-e.z/2,c},wp:function(a,b){return a+b*(Math.random()-0.5)},ou:function(a,e){var c=2*Math.random()-1,d=6.2832*Math.random(),
f=Math.sqrt(1-c*c);return(new b.a).fd(a,(new b.a(f*Math.cos(d),f*Math.sin(d),c)).p(e))},pu:function(a,e,c,d){return(new b.a).X(a,e).normalize().p(this.wp(c,d))},xp:function(a,b,c){a.set(Math.random()*b.x-c.x,Math.random()*b.y-c.y,Math.random()*b.z-c.z)},Ap:function(a){a.$f=a.duration?a.cg*(this.mb<a.Vg?this.mb:a.Vg):a.cg*this.mb;a.$f=Math.ceil(a.$f);for(var b=this.l.c,c=b.length,d=a.$f+c,f=this.attributes,g=f.acceleration.value,h=f.Rb.value,k=f.Cc.value,l=f.sb.value,m=f.size.value,f=f.vh.value,q=
c;d>q;++q)"sphere"===a.type?(b[q]=this.ou(a.position,a.Q),h[q]=this.pu(b[q],a.position,a.speed,a.al)):(b[q]=this.am(a.position,a.Fn),h[q]=this.am(a.Rb,a.Bs)),g[q]=this.am(a.acceleration,a.dm),m[q]=Math.max(0.1,this.wp(a.size,a.aj)),f[q]=a.vh,l[q]=0,k[q]=0;a.Cs=c;a.attributes=this.attributes;a.c=this.l.c;a.mb=this.mb;this.Gm.push(a)},ib:function(a){a=a||this.gq;for(var b=0;b<this.Gm.length;++b)this.Gm[b].ib(a);this.attributes.sb.ea=!0;this.attributes.Cc.ea=!0;this.l.Xa=!0}};Hb.Lr={ll:"uniform float duration;\nuniform vec3 customColor;\nuniform vec3 customColorEnd;\nuniform int hasPerspective;\nuniform float opacity;\nuniform float opacityEnd;\nattribute vec3 acceleration;\nattribute vec3 velocity;\nattribute float alive;\nattribute float age;\nattribute float size;\nattribute float sizeEnd;\nvarying vec4 vColor;\nfloat Lerp( float start, float end ) {\nreturn (start + ((end - start) * (age / duration)));\n}\nvec3 Lerp( vec3 start, vec3 end ) {\nreturn (start + ((end - start) * (age / duration)));\n}\nfloat GetSize( float newSize, vec4 mvPosition ) {\nif( hasPerspective == 1 ) {\nnewSize = newSize * (300.0 / length( mvPosition.xyz ) );\n}\nreturn newSize;\n}\nvec4 GetPos() {\nvec3 newPos = vec3( position );\nfloat positionInTime = age / duration;\nvec3 a = acceleration * positionInTime;\nvec3 v = velocity * positionInTime;\nv = v + (a * age);\nnewPos = newPos + v;\nvec4 mvPosition = modelViewMatrix * vec4( newPos, 1.0 );\ngl_PointSize = Lerp( GetSize( size, mvPosition ), sizeEnd );\nreturn mvPosition;\n}\nvoid main() {\nif( alive > 0.5 ) {\nvec3 color = vec3( customColor );\nif( customColor != customColorEnd ) {\ncolor = Lerp( customColor, customColorEnd );\n}\nif( opacity != opacityEnd ) {\nvColor = vec4( color, Lerp( opacity, opacityEnd ) );\n}\nelse {\nvColor = vec4( color, opacity );\n}\ngl_Position = projectionMatrix * GetPos();\n}\nelse {\nvColor = vec4( customColor, 0.0 );\ngl_Position = vec4(1e20, 1e20, 1e20, 0);\n}\n}",
bw:"uniform sampler2D texture;\nuniform int colorize;\nvarying vec4 vColor;\nvoid main() {\nfloat c = cos(0.0);\nfloat s = sin(0.0);\nvec2 rotatedUV = vec2(c * (gl_PointCoord.x - 0.5) + s * (gl_PointCoord.y - 0.5) + 0.5,\nc * (gl_PointCoord.y - 0.5) - s * (gl_PointCoord.x - 0.5) + 0.5);\nvec4 rotatedTexture = texture2D( texture,  rotatedUV );\nif( colorize == 1 ) {\ngl_FragColor = vColor * rotatedTexture;\n}\nelse {\ngl_FragColor = rotatedTexture;\n}\n}"};kc.prototype={ib:function(a){var b=this.Pd.position.z;
now=0.05*Date.now();this.Pd.rotation.y+=0.02*a;this.tk.rotation.y+=0.05*a;this.wi.rotation.y+=0.1*a;this.cc.rotation.y-=0.09*a;this.cc.position.z=b+Math.sin(now*this.ac.cc.gf)*this.ac.cc.ha;this.cc.position.x=Math.cos(now*this.ac.cc.gf)*this.ac.cc.ha;this.bc.rotation.y-=0.09*a;this.bc.position.z=b+Math.sin(now*this.ac.bc.gf)*this.ac.bc.ha;this.bc.position.x=Math.cos(now*this.ac.bc.gf)*this.ac.bc.ha},ok:cc("ob")};lc.prototype={Du:function(a){var e=bb.loaded.ka[a.Uv];bb.loaded.ka[a.Vv];var c=bb.loaded.ka[a.Wv];
a=bb.loaded.ka[a.Xv];var d=new b.k(16777215),e=new b.wg(e,256,0,b.yb,d);e.add(c,512,0,b.yb);e.add(c,512,0.05,b.yb);e.add(c,256,0,b.yb);e.add(a,60,0.6,b.yb);e.add(a,70,0.7,b.yb);e.add(a,120,0.9,b.yb);e.add(a,30,0.3,b.yb);e.add(a,83,0.5,b.yb);e.add(a,100,1,b.yb);e.vm=function(a){var c,d,e=a.Qd.length,l=2*-a.e.x,m=2*-a.e.y;for(c=0;e>c;c++)d=a.Qd[c],d.x=a.e.x+l*d.ha,d.y=a.e.y+m*d.ha,d.rotation=0;a.Qd[2].y+=0.025;a.Qd[3].rotation=0.5*a.e.x+b.be.Rg(45)};e.position=this.Ba.position.d();e.position.z+=20;
e.position.x+=100;this.ob.push(e)},ok:cc("ob")};kb.prototype={vp:function(){var a=Number.NEGATIVE_INFINITY,b=this.Ek.d(),c=b.xa;return b.position.set(a,a,a),b.scale.set(0.02,0.02,0.02),b.jb=!0,c.Rb=this.Rb,c.sb=0,c.af=this.af,c.hi=Number.POSITIVE_INFINITY,c.target=null,b},hu:function(){var a=new ec(ha.Gi.qd);return this.An.Ap(a),a},mu:function(){for(var a,b,c=0;40>c;++c)a=this.vp(),b=this.hu(),this.En.push(a),this.Fm.push(b)},Yl:function(){var a,b=this.En;return a=b.length?b.pop():this.vp(),this.Ba.add(a),
a},su:function(a){this.En.push(a);this.Ba.remove(a)},Xl:function(){var a,b=this.Fm;return b.length&&(a=b.pop(),a.Cc=1),a},ru:function(a){a&&(a.xa.Ny=null,a.Cc=0,this.Fm.push(a))},cm:function(a,b,c){a.position.copy(b.position);a.fa.copy(b.fa);a.fa.multiply(this.Kw);a.ks(50);c&&(c.xa.Ny=a,c.position=a.position,a.xa.Zp=c);this.yp(a)},yp:function(a){a.xa.Rb=this.Rb;a.xa.sb=0;a.xa.af=0;a.xa.hi=Number.POSITIVE_INFINITY},Wl:function(a,b){a.xa;var c=Number.NEGATIVE_INFINITY;Lb.hl("Rockets:destroyed",b,a.position.x,
a.position.y,a.position.z);a.position.set(c,c,c);this.yp(a);this.su(a);a.xa.Zp&&this.ru(a.xa.Zp)},fq:function(a,e,c){if(c&&c instanceof b.w&&!(Date.now()-this.vk[a]<this.uk)){this.vk[a]=Date.now();a=this.Yl();var d=this.Xl();this.cm(a,e,d);this.Le.push(a);a.xa.target=c}},ib:function(a){var b,c,d=this.Le,f=d.length,g=Math.min;if(f)for(var h=0;f>h;++h)b=d[h],c=b.xa,c.sb>this.mb||100>c.hi?(100>c.hi?this.Wl(b,kb.Dm.Bw):c.sb===Number.POSITIVE_INFINITY?this.Wl(b,kb.Dm.Aw):this.Wl(b,kb.Dm.Lz),d.splice(h,
1),--f):(c.Rb<this.nn&&(c.Rb+=this.acceleration),c.hi=b.position.gd(c.target.position),c.af=g(this.af,50/c.hi),c.sb>this.Om&&(this.hs.ub(c.target.position,b.position,b.vd),this.js.Ni(this.hs),b.fa.Zk(this.js,c.af)),b.ls(c.Rb*a),c.sb+=a,this.iv(b))},iv:function(a){for(var b=0;b<this.Le.length;++b)if(this.Le[b]!==a&&20>a.position.gd(this.Le[b].position)){console.log("collision");a.xa.sb=Number.POSITIVE_INFINITY;this.Le[b].xa.sb=Number.POSITIVE_INFINITY;break}},ok:cc("ob")};kb.Dm=Object.freeze({Bw:0,
Aw:1,Lz:2});kb.extend=Vb;kb.extend({fq:function(a,e,c){if(c&&c instanceof b.w&&!(Date.now()-this.vk[a]<this.uk)){this.vk[a]=Date.now();var d=this;a=d.Yl();var f=d.Xl();d.cm(a,e,f);d.Le.push(a);a.xa.target=c;a.eo(-30);setTimeout(function(){var a=d.Yl(),b=d.Xl();d.cm(a,e,b);d.Le.push(a);a.xa.target=c;a.eo(30)},0)}}});mc.prototype={ok:cc("ob")};Ob.prototype={};Ob.extend=Vb;var Yc=Ob.extend({Xe:function(){console.log("ParticleWeapon",arguments)}});Ob.extend({Xe:function(){console.log("PlasmaCannon",arguments);
Yc.prototype.Xe.apply(this,arguments);ha.qy}});var Lb=Events;Vb=new function(){var a=[],b=[],c=this;this.zy=this.yy=0;this.qm=0|window.innerWidth/2;this.rm=0|window.innerHeight/2;this.x=+this.qm;this.y=+this.rm;this.right=this.left=0;document.addEventListener("mousedown",function(b){b.preventDefault();1===b.which?c.left=1:3===b.which&&(c.right=1);for(b=0;b<a.length;++b)a[b]()},!1);document.addEventListener("mousemove",function(a){c.yy=c.x;c.zy=c.y;c.x=a.pageX;c.y=a.pageY},!1);document.addEventListener("mouseup",
function(a){a.preventDefault();1===a.which?c.left=0:3===a.which&&(c.right=0);for(a=0;a<b.length;++a)b[a]()},!1);this.yF=function(){c.qm=window.innerWidth/2;c.rm=window.innerHeight/2};this.VA=function(b){a.push(b)};this.WA=function(a){b.push(a)}};var wc=new function(){var a=[],b={},c={},d=!1,f=!1,g=!1,h=!1,k=!1;document.addEventListener("keydown",function(c){var m=String.fromCharCode(c.keyCode).toLowerCase(),q=c.keyCode,p=b[m],r;for(r in ha.Gq)if(q===ha.Gq[r]){-1<ha.Vw.indexOf(r)&&c.preventDefault();
m=r;break}if(console.log(q,m),d=c.metaKey,f=c.shiftKey,g=c.altKey,h=c.Ju,k=c.ctrlKey,a[q]=1,p)for(r=0;r<p.length;++r)p[r]()},!1);document.addEventListener("keyup",function(b){var e=String.fromCharCode(b.keyCode).toLowerCase(),q=e.charCodeAt(0),e=c[e];if(d=b.metaKey,f=b.shiftKey,g=b.altKey,h=b.Ju,k=b.ctrlKey,a[q]=0,e)for(b=0;b<e.length;++b)e[b]()},!1);this.AD=function(b){var c=!1;b=b.split("+");for(var e=0;e<b.length;++e)if(c=!1,"meta"===b[e]&&d||"shift"===b[e]&&f||"alt"===b[e]&&g||"altGraph"===b[e]&&
h||"ctrl"===b[e]&&k?c=!0:a[b[e].charCodeAt(0)]&&(c=!0),!c)return!1;return!0};this.Eg=function(a,c){b[a]||(b[a]=[]);b[a].push(c)};this.Fg=function(a,b){c[a]||(c[a]=[]);c[a].push(b)}},bc=new function(a){function e(a,d){var e={};e.Ea=new b.Cf;e.Cb=new b.uc(c.kd,c.Ig,c.Ja,c.Ia);e.Cb.jb=c.jb;e.ib=null;d&&(e.Cb.Ut=!!d.ko,e.Cb.Vt=!!d.lo);f[a]=e;g[a]=[]}var c={ld:null,bn:[],kd:75,Ig:window.innerWidth/window.innerHeight,Ja:0.1,Ia:1E5,jb:!0};if(a)for(var d in a)c[d]=a[d];d=a=null;var f={},g={},h=[];for(d in c.ld)e(d,
c.ld[d]);for(d=0;d<c.bn.length;++d)h.push(f[c.bn[d]]);this.Eu=function(a,b){for(var c=b.ob,d=g[a],e=f[a].Ea,h=0;h<c.length;++h)d.push(c[h]),e.add(c[h])};this.Bp=function(a,b){g[a].push(b);f[a].Ea.add(b)};this.UA=function(a,c,d){f[a].Ea.D=new b.xf(c,d)};this.YC=function(a){return g[a]};this.jw=function(){return h};this.Rm=function(a){return f[a]};this.ZC=function(a){return g[a]};this.BG=function(a,b,c,d,e){a=f[a].Cb;a.jb?(a.fa.x=b,a.fa.y=c,a.fa.z=d,a.fa.f=e):(a.rotation.x=b,a.rotation.y=c,a.rotation.z=
d)};this.AG=function(a,b,c,d){a=f[a].Cb;a.position.x=b;a.position.y=c;a.position.z=d};this.zG=function(a,b){f[a].Cb.ub(b)};this.gw=function(){var a=[],b;for(b in f)a.push(f[b].Cb);return a}}(ha.xi),bb=new dc(_.extend({ak:Lb},ha.Nu)),Mb=new Mb,vc=new function(a){var e={$m:null,sn:null,dl:null,xy:10,wy:0.99,xr:50,Py:0.05,Oy:0.95,Fx:1E3,BE:1E3,Gx:2};if(a)for(var c in a)e[c]=a[c];var d=0,f=0,g=0,h=0,k=!1,l=!1,m=!1,q=!1,p=!1,r=!1,v=0,w=new b.a,u=new b.Bb,s=new b.a,t=!(!e.$m||!e.sn);ha.controls;for(c=0;c<
e.dl.length;++c)e.dl[c].jb=!0;for(c in this)"function"==typeof this[c]&&(this[c]=this[c].bind(this));this.ib=function(a){if(t){var b=e.sn;e.$m;d=b.x;f=b.y;g=b.qm;h=b.rm}var b=e.Py,c=e.Oy,P=e.Gx;p?v+=b:r?v-=b:v*=c;v>P?v=P:-P>v&&(v=-P);g&&h&&(w.y=-(d-g)/g/e.xr,w.x=-(f-h)/h/e.xr);b=e.xy;c=e.wy;P=e.Fx;k?s.z-=b:l?s.z+=b:ha.Vu&&(s.z*=c);m?s.x-=b:q?s.x+=b:s.x*=c;s.z>P?s.z=P:s.z<-P&&(s.z=-P);s.x>P?s.x=P:s.x<-P&&(s.x=-P);var b=s.x*a,c=s.y*a,P=s.z*a,I=e.dl,F=I.length;u.set(w.x,w.y,v*a,1).normalize();for(a=
0;F>a;++a){var L=I[a],K=c,N=P;L.Ut&&(L.eo(b),L.ks(K),L.ls(N));L.Vt&&L.fa.multiply(u)}};this.set=Ia();this.Dr=function(a){k=a};this.Br=function(a){l=a};this.Gr=function(a){m=a};this.Ir=function(a){q=a};this.Jr=function(a){p=a};this.Kr=function(a){r=a};this.Rn=function(a){d=a};this.Pi=function(a){f=a};this.CG=function(a){g=a};this.DG=function(a){h=a}}({sn:Vb,$m:wc,dl:bc.gw()}),Gb=new function(a){function e(){if(0!==f){requestAnimationFrame(e);var a,b=h.jw(),d=0,s=b.length;c.Me||p.clear();g=r.qq();for(d;q>
d;++d)m[d](g);if(l)b[1].Ea.Kk=l.Up,p.v(b[1].Ea,b[1].Cb,l.Av,!0),b[1].Ea.Kk=null,l.Og.v(),p.clear(!1,!0,!1),p.v(b[2].Ea,b[2].Cb);else for(d=0;s>d;++d)a=b[d],p.v(a.Ea,a.Cb),c.Me||p.clear(!1,!0,!1);k&&k.update()}}var c={width:window.innerWidth,height:window.innerHeight,Yp:window.innerWidth,Xp:window.innerHeight,parent:document.body,antialias:!0,alpha:!0,precision:"highp",stencil:!0,preserveDrawingBuffer:!1,clearColor:0,sm:1,Vq:4,Tv:0,Me:!1,jc:!1,$g:!1,oh:!1};if("object"==typeof a)for(var d in a)c[d]=
a[d];d=a=null;var f=0,g=0,h=null,k=null,l=null,m=[],q=0,p=new b.Mt({antialias:c.antialias,alpha:c.alpha,precision:c.precision,stencil:c.stencil,preserveDrawingBuffer:c.preserveDrawingBuffer,Vq:c.Vq});p.Cr(c.Tv);p.Ok(c.clearColor,c.sm);p.Qn(c.width,c.height);p.hd.style.width=c.Yp+"px";p.hd.style.height=c.Xp+"px";p.Me=c.Me;p.jc=c.jc;p.$g=c.$g;p.oh=c.oh;var r=new b.ql;this.start=function(){0===f&&null!==h&&(f=1,requestAnimationFrame(e))};this.stop=function(){1===f&&(f=0)};this.bz=function(a){h=a};this.Gu=
function(a){var b=a.hd,d=b.style;d.position="absolute";d.top="0px";d.left="0px";d.zIndex="999999";c.parent.appendChild(b);k=a};this.hm=function(){c.parent.appendChild(p.hd)};this.Dp=function(a){"function"==typeof a&&(m.push(a),q=m.length)};this.AC=function(a,c){if(!l){l={};l.Cm=b.yg.Am;l.Bv=b.xc.d(l.Cm.N);l.Up=new b.Ra({L:l.Cm.L,O:l.Cm.O,N:l.Bv});l.Up.Ha=b.Bl;l.Ki=new b.Ge(window.innerWidth,window.innerHeight,{nb:b.ae,Gb:b.ae,ma:b.Bf,ud:!0});l.Og=new b.vA(p,l.Ki);l.Lk=[];for(var d=0;d<a.length;++d)a[d]=
h.Rm(a[d]),l.Lk.push(new b.DA(a[d].Ea,a[d].Cb)),0!==d&&(l.Lk[d].clear=!1);c=h.Rm(c);l.jv=new b.nA;l.kv=new b.zA(c.Ea,c.Cb);l.Av=new b.Ge(window.innerWidth,window.innerHeight,{nb:b.Be,Gb:b.Be,ma:b.Bf});var e=new b.jA(0.5),f=new b.FA(b.pA);f.kG=!0;for(d=0;d<l.Lk.length;++d)l.Og.Mj(l.Lk[d]);l.Og.Mj(l.kv);l.Og.Mj(l.jv);l.Og.Mj(e);l.Og.Mj(f);this.qB=e}}}({width:window.innerWidth/ha.ur,height:window.innerHeight/ha.ur,Yp:window.innerWidth,Xp:window.innerHeight,jc:!0,$g:!0,oh:!0});Lb.xn("ASSET_LOADER:allLoaded",
function(){bb.hd.style.display="none";Oc();new Wc({xi:bc,tr:Gb});Mc=new Xc({xi:bc,tr:Gb});Mb.hm();setInterval(function(){Mb.Ar("primary",Math.round(Math.random()));Mb.Ar("secondary",Math.round(Math.random()))},1E3);setTimeout(Gb.start,100)});Lb.xn("Rockets:destroyed",function(a,b,c,d){Mc.Qz(a,b,c,d)});var Mc;Gb.bz(bc);Gb.hm();Gb.Gu(new function(){function a(a){switch(q=a){case 0:r.style.display="block";s.style.display="none";break;case 1:r.style.display="none",s.style.display="block"}}var b=Date.now(),
c=b,d=0,f=1/0,g=0,h=0,k=1/0,l=0,m=0,q=0,p=document.createElement("div");p.id="stats";p.addEventListener("mousedown",function(b){b.preventDefault();a(++q%2)},!1);p.style.cssText="width:80px;opacity:0.9;cursor:pointer";var r=document.createElement("div");r.id="fps";r.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#002";p.appendChild(r);var v=document.createElement("div");v.id="fpsText";v.style.cssText="color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px";
v.innerHTML="FPS";r.appendChild(v);var w=document.createElement("div");w.id="fpsGraph";w.style.cssText="position:relative;width:74px;height:30px;background-color:#0ff";for(r.appendChild(w);74>w.children.length;){var u=document.createElement("span");u.style.cssText="width:1px;height:30px;float:left;background-color:#113";w.appendChild(u)}var s=document.createElement("div");s.id="ms";s.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#020;display:none";p.appendChild(s);var t=document.createElement("div");
t.id="msText";t.style.cssText="color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px";t.innerHTML="MS";s.appendChild(t);var A=document.createElement("div");A.id="msGraph";A.style.cssText="position:relative;width:74px;height:30px;background-color:#0f0";for(s.appendChild(A);74>A.children.length;)u=document.createElement("span"),u.style.cssText="width:1px;height:30px;float:left;background-color:#131",A.appendChild(u);return{El:11,hd:p,FG:a,kB:function(){b=
Date.now()},end:function(){var a=Date.now();d=a-b;f=Math.min(f,d);g=Math.max(g,d);t.textContent=d+" MS ("+f+"-"+g+")";var p=Math.min(30,30-30*(d/200));return A.appendChild(A.firstChild).style.height=p+"px",m++,a>c+1E3&&(h=Math.round(1E3*m/(a-c)),k=Math.min(k,h),l=Math.max(l,h),v.textContent=h+" FPS ("+k+"-"+l+")",p=Math.min(30,30-30*(h/100)),w.appendChild(w.firstChild).style.height=p+"px",c=a,m=0),a},update:function(){b=this.end()}}});Gb.Dp(vc.ib);bb.gx()})();
